var TXTextControl=(function(c,a){var b=c._private=c._private||{};
b.BrowserDetect={init:function(){this.userAgent=navigator.userAgent;
this.appVersion=navigator.appVersion;
this.browser=this.searchString(this.dataBrowser)||"Other";
this.version=this.searchVersion(this.userAgent)||this.searchVersion(this.appVersion)||"Unknown";
},searchString:function(d){for(var e=0;
e<d.length;
e++){this.versionSearchString=d[e].subString;
if(this.userAgent.indexOf(d[e].subString)!=-1){return d[e].identity;
}}},searchVersion:function(d){var e=d.indexOf(this.versionSearchString);
if(e==-1){return;
}return parseFloat(d.substring(e+this.versionSearchString.length+1));
},dataBrowser:[{subString:"Edge",identity:"Edge"},{subString:"Chrome",identity:"Chrome"},{subString:"Firefox",identity:"Firefox"},{subString:"Safari",identity:"Safari"},{subString:"Opera",identity:"Opera"},{subString:"MSIE",identity:"Explorer"},{subString:"rv:11.0",identity:"Explorer"},{subString:"Trident/",identity:"Explorer"},]};
b.BrowserDetect.init();
return c;
}(TXTextControl||{},j$1_10_2));
var TXTextControl=(function(g,a){var b=g._private=g._private||{};
b.UIStateFlag={CanCopy:1,CanPaste:2,CanUndo:4,CanRedo:8,ControlChars:16,Header:32,Footer:64,TableGridLines:128,DocumentTargetMarkers:256,DrawingMarkerLines:512,TextFrameMarkerLines:1024,ContextMenusEnabled:2048,TextFieldsEditable:4096,FrameAnchors:8192,SelectObjects:16384};
b.NumberFormat={None:0,ArabicNumbers:3,Letters:4,CapitalLetters:5,RomanNumbers:6,SmallRomanNumbers:7};
b.FontUnderlineStyle={DoubledWordsOnly:4288,Doubled:4672,SingleWordsOnly:16528,Single:16912,None:20992};
b.BreakType={NextLine:0,Column:1,Page:2,SectionNextPage:3,SectionContinuous:4};
b.ItemType={HypertextLink:0,DocumentLink:1,TextFrame:2,DocumentTarget:3,Link:4,PageNumber:5,FieldAdapter:6,ApplicationField:7,Chart:8,Barcode:9,Frame:10,MergeBlock:11,HeaderFooter:12,ImagePlaceholder:13,TextField:14,Shape:15,DrawingCanvas:16,DrawingFrame:17};
b.HeaderFooterType={Header:1,FirstPageHeader:2,Footer:4,FirstPageFooter:8,EvenHeader:128,EvenFooter:32768,All:32911};
b.TableAddPosition={Before:1,After:2};
b.txProperties={canEdit:true,canCharacterFormat:true,canParagraphFormat:true,canTableFormat:true,canDocumentFormat:true,canStyleFormat:true,canPrint:true};
b.controlChars=false;
b.tableGridLines=true;
b.documentTargetMarkers=true;
b.textFrameMarkerLines=true;
b.contextMenusEnabled=true;
b.textFieldsEditable=false;
b.inputPositionChangedHandler=function(h){var i=h.detail;
if(i.IsInTable&&(b.appMode==b.ApplicationMode.Normal)){a("#tabTableLayout").show();
b.adaptRibbonTabWidths();
b.processTableInfo(i.Table);
}else{if(a("#tabTableLayout").is(":visible")){a("#tabTableLayout").hide();
b.adaptRibbonTabWidths();
if(a("#"+a("#tabTableLayout").attr("rel")).is(":visible")){b.switchTabs(a("#tabDefault"));
}}}};
b.txPropertyChangedHandler=function(i){var h=i.detail;
switch(h.propertyName){case"CanEdit":b.txProperties.canEdit=h.value;
break;
case"CanPrint":b.txProperties.canPrint=h.value;
break;
case"CanStyleFormat":b.txProperties.canStyleFormat=h.value;
break;
case"CanDocumentFormat":b.txProperties.canDocumentFormat=h.value;
break;
case"CanTableFormat":b.txProperties.canTableFormat=h.value;
break;
case"CanCharacterFormat":b.txProperties.canCharacterFormat=h.value;
break;
case"CanParagraphFormat":b.txProperties.canParagraphFormat=h.value;
break;
}};
b.uiFlagsUpdatedHandler=function(i){var j=i.detail;
if(j&b.UIStateFlag.CanCopy){a("#btnCut").removeClass("txui-state-disabled");
a("#btnCopy").removeClass("txui-state-disabled");
}else{a("#btnCut").addClass("txui-state-disabled");
a("#btnCopy").addClass("txui-state-disabled");
}if(b.isTouchDevice){if(j&b.UIStateFlag.CanPaste){a("#mnuItemServerPaste").removeClass("txui-state-disabled");
}else{a("#mnuItemServerPaste").addClass("txui-state-disabled");
}}else{if(j&b.UIStateFlag.CanPaste){a("#btnPaste").removeClass("txui-state-disabled");
}else{a("#btnPaste").addClass("txui-state-disabled");
}}if(j&b.UIStateFlag.CanUndo){a("#btnUndo").removeClass("txui-state-disabled");
}else{a("#btnUndo").addClass("txui-state-disabled");
}if(j&b.UIStateFlag.CanRedo){a("#btnRedo").removeClass("txui-state-disabled");
}else{a("#btnRedo").addClass("txui-state-disabled");
}if(j&b.UIStateFlag.ControlChars){b.controlChars=true;
a("#tglBtnControlChars").addClass("ribbon-button-selected");
a("#tglBtnViewControlCharacters").addClass("ribbon-button-selected");
}else{b.controlChars=false;
a("#tglBtnControlChars").removeClass("ribbon-button-selected");
a("#tglBtnViewControlCharacters").removeClass("ribbon-button-selected");
}var l=document.getElementById("tglBtnViewFrameAnchors");
if(l){if(j&b.UIStateFlag.FrameAnchors){l.classList.add("ribbon-button-selected");
}else{l.classList.remove("ribbon-button-selected");
}}if(j&b.UIStateFlag.Header){a("#mnuItemRemoveHeader").removeClass("txui-state-disabled");
}else{a("#mnuItemRemoveHeader").addClass("txui-state-disabled");
}if(j&b.UIStateFlag.Footer){a("#mnuItemRemoveFooter").removeClass("txui-state-disabled");
}else{a("#mnuItemRemoveFooter").addClass("txui-state-disabled");
}if(j&b.UIStateFlag.TableGridLines){b.tableGridLines=true;
a("#tglBtnViewGridLines").addClass("ribbon-button-selected");
a("#tglBtnViewTableGridlines").addClass("ribbon-button-selected");
}else{b.tableGridLines=false;
a("#tglBtnViewGridLines").removeClass("ribbon-button-selected");
a("#tglBtnViewTableGridlines").removeClass("ribbon-button-selected");
}if(j&b.UIStateFlag.DocumentTargetMarkers){b.documentTargetMarkers=true;
a("#tglBtnShowBookmarkMarkers").addClass("ribbon-button-selected");
a("#tglBtnViewBookmarkMarkers").addClass("ribbon-button-selected");
}else{b.documentTargetMarkers=false;
a("#tglBtnShowBookmarkMarkers").removeClass("ribbon-button-selected");
a("#tglBtnViewBookmarkMarkers").removeClass("ribbon-button-selected");
}if(j&b.UIStateFlag.TextFrameMarkerLines){b.textFrameMarkerLines=true;
a("#tglBtnShowTextFrameMarkerLines").addClass("ribbon-button-selected");
a("#tglBtnViewTextframeMarkerLines").addClass("ribbon-button-selected");
}else{b.textFrameMarkerLines=false;
a("#tglBtnShowTextFrameMarkerLines").removeClass("ribbon-button-selected");
a("#tglBtnViewTextframeMarkerLines").removeClass("ribbon-button-selected");
}var h=document.querySelector("#mnuItemDrawingMarkerLines div.small-menu-item-image-wrapper");
if(j&b.UIStateFlag.DrawingMarkerLines){if(h){h.classList.add("ribbon-button-selected");
}a("#tglBtnViewDrawingMarkerLines").addClass("ribbon-button-selected");
}else{if(h){h.classList.remove("ribbon-button-selected");
}a("#tglBtnViewDrawingMarkerLines").removeClass("ribbon-button-selected");
}var k=document.getElementById("tglBtnSelectObjects");
if(k){if(j&b.UIStateFlag.SelectObjects){k.classList.add("ribbon-button-selected");
}else{k.classList.remove("ribbon-button-selected");
}}b.contextMenusEnabled=(j&b.UIStateFlag.ContextMenusEnabled)!=0;
b.textFieldsEditable=(j&b.UIStateFlag.TextFieldsEditable)!=0;
};
function e(h){var j="";
var i=(typeof b.settings!=="undefined")&&b.settings.IsMVC;
var m=document.getElementById("txPrintFrame");
if(m){document.body.removeChild(m);
}var l=b.isSSLConnection?"https://":"http://";
if(i){j=b.settings.ConnectionID;
}else{if((typeof b.webControlSettings!=="undefined")&&b.webControlSettings.hasOwnProperty("connectionID")){j=b.webControlSettings.connectionID;
}}if(!j){return"";
}var k=i?l+b.getHostAndAppVirtPath()+b.settings.ApiRoute+"TXPrint":l+b.getHostAndAppVirtPath()+"TXPrintHandler.ashx";
return k+"?connectionID="+j+"&embedPrintAction="+(h?"true":"false");
}function f(){var h=e(true);
if(!h){return;
}txPrintFrame=document.createElement("IFRAME");
txPrintFrame.id="txPrintFrame";
txPrintFrame.frameBorder=0;
txPrintFrame.src=h;
document.body.appendChild(txPrintFrame);
}function d(){var i=e(false);
if(!i){return;
}var h=new b.EdgePrintDialog(i);
h.showModal();
}b.print=function(){if((b.BrowserDetect.browser==="Explorer")||(b.BrowserDetect.browser==="Other")){f();
}else{if(b.BrowserDetect.browser==="Edge"){d();
}else{b.sendCommand(b.Command.PrintToPDF,1);
}}};
b.printResultReceivedHandler=function(h){var i=h.detail;
if((b.BrowserDetect.browser==="Explorer")||(b.BrowserDetect.browser==="Other")||(b.BrowserDetect.browser==="Edge")){return;
}var j=document.getElementById("txPrintFrame");
if(j){document.body.removeChild(j);
}j=document.createElement("IFRAME");
j.id="txPrintFrame";
j.frameBorder=0;
j.src="data:application/pdf;base64,"+i.documentData;
document.body.appendChild(j);
};
b.HyperlinkClickedEventArgs=(function(){function h(target){this.target=target;
}return h;
})();
b.hyperlinkClickedHandler=function(i){var j=i.detail;
var h=new b.HyperlinkClickedEventArgs(j);
b.fireEvent(b.EventName.hyperlinkClicked,h);
};
function c(h,o,s){o=o||"";
s=s||512;
var m=atob(h);
var l=[];
for(var q=0;
q<m.length;
q+=s){var r=m.slice(q,q+s);
var n=new Array(r.length);
for(var p=0;
p<r.length;
p++){n[p]=r.charCodeAt(p);
}var k=new Uint8Array(n);
l.push(k);
}var j=new Blob(l,{type:o});
return j;
}return g;
}(TXTextControl||{},j$1_10_2));
var TXTextControl=(function(c,a){var b=c._private=c._private||{};
b.Caret=(function(){function d(e){this.canvas=e;
this.location={X:0,Y:0};
this.size={width:0,height:0};
this.isBlack=false;
this.blinkTimer=null;
this.isVisible=false;
this.divCaret=null;
this.divCaret=document.createElement("div");
this.divCaret.classList.add("caret");
this.divCaret.style.left="1px";
this.divCaret.style.top="1px";
this.canvas.parentNode.appendChild(this.divCaret);
}Object.defineProperty(d.prototype,"bounds",{get:function(){var e={x:this.location.X,y:this.location.Y,width:this.size.width,height:this.size.height};
return e;
},enumerable:true,configurable:true});
d.prototype.setState=function(g){var f=this.isVisible;
this.hide();
var e=Math.max(1,g.Size.Height);
var h=Math.max(1,g.Size.Width);
this.setSize(h,e);
this.setLocation(g.Location);
f=g.Visibility;
if(f){this.show();
}};
d.prototype.blink=function(){if(this.isBlack){this.setOpacity(0);
this.isBlack=false;
}else{this.setOpacity(1);
this.isBlack=true;
}};
d.prototype.show=function(){this.isVisible=true;
this.setOpacity(1);
this.isBlack=true;
clearInterval(this.blinkTimer);
this.blinkTimer=setInterval(this.blink.bind(this),500);
};
d.prototype.hide=function(){if(!this.isVisible){return;
}this.isVisible=false;
clearInterval(this.blinkTimer);
if(this.isBlack){this.setOpacity(0);
this.isBlack=false;
}};
d.prototype.setOpacity=function(e){if(!b.ViewersInvisible){this.divCaret.style.opacity=""+e;
}};
d.prototype.setLocation=function(f){this.location=cloneObject(f);
var e=this.canvas.offsetLeft+f.X;
var g=this.canvas.offsetTop+f.Y;
this.divCaret.style.left=e+"px";
this.divCaret.style.top=g+"px";
};
d.prototype.refreshLocation=function(){this.setLocation(this.location);
};
d.prototype.setSize=function(f,e){this.size.width=f;
this.size.height=e;
this.divCaret.style.width=f+"px";
this.divCaret.style.height=e+"px";
};
d.prototype.isVisible=function(){return this.isVisible;
};
return d;
})();
return c;
}(TXTextControl||{},j$1_10_2));
var TXTextControl=(function(c,a){var b=c._private=c._private||{};
b.ActivationState={Activated:1,Deactivated:2,Disabled:3};
b.HiddenTextField=(function(){function d(g,h,i){var j=this;
this.canvas=g;
this.componentType=h;
this.owner=i;
this.location={X:0,Y:0};
this.elemInput=b.isTouchDevice?document.createElement("input"):document.createElement("div");
this.elemInput.classList.add("txHiddenTextField");
this.elemInput.setAttribute("autocomplete","off");
this.elemInput.setAttribute("autocorrect","off");
this.elemInput.setAttribute("spellcheck",false);
this.elemInput.setAttribute("contenteditable",true);
this.elemInput.tabIndex="-1";
this.elemInput.addEventListener("keypress",b.keyPressHandler);
this.elemInput.addEventListener("keydown",b.keyDownHandler);
this.elemInput.addEventListener("keyup",b.keyUpHandler);
this.elemInput.addEventListener("compositionstart",this.compositionstartHandler.bind(this));
this.elemInput.addEventListener("compositionupdate",this.compositionupdateHandler.bind(this));
this.elemInput.addEventListener("compositionend",this.compositionendHandler.bind(this));
this.elemInput.addEventListener("blur",this.elemInput_Blur.bind(this));
this.elemInput.addEventListener("focus",this.elemInput_Focus.bind(this));
if(!b.isTouchDevice&&(h==b.ComponentType.TextView)){this.elemInput.addEventListener("paste",function(k){f(j,k);
});
this.elemInput.id="txHiddenTextField_textView";
}this.canvas.parentNode.appendChild(this.elemInput);
}Object.defineProperty(d.prototype,"top",{set:function(g){this.elemInput.style.top=g+"px";
},enumerable:true,configurable:true});
Object.defineProperty(d.prototype,"left",{set:function(g){this.elemInput.style.left=g+"px";
},enumerable:true,configurable:true});
d.prototype.compositionstartHandler=function(i){b.inIMEComposition=true;
var j=this.elemInput;
var g=this.owner.caretBounds;
var h=this.owner.canvas;
j.style.left=g.x+h.offsetLeft+"px";
j.style.top=g.y+h.offsetTop+g.height+"px";
j.style.zIndex=1000;
};
d.prototype.compositionupdateHandler=function(g){};
d.prototype.compositionendHandler=function(g){b.inIMEComposition=false;
var j=this.elemInput;
j.style.left="";
j.style.top="";
j.style.zIndex="";
if(j.tagName==="DIV"){j.innerHTML="";
}for(var h=0;
h<g.data.length;
++h){b.sendCommand(b.Command.ComponentEvent,b.UserInputEventType.KeyPress,0,0,{key:g.data[h],modifierKeys:0});
}};
d.prototype.focus=function(){if(!document.hasFocus()||(document.activeElement!=this.elemInput)){this.elemInput.focus();
}};
d.prototype.blur=function(){if(document.activeElement==this.elemInput){this.elemInput.blur();
}};
d.prototype.elemInput_Focus=function(g){if(this.elemInput.tagName==="INPUT"){this.elemInput.value="";
}else{this.elemInput.innerHTML="";
}};
d.prototype.elemInput_Blur=function(g){b.sendCommand(b.Command.ComponentActivationState,this.componentType,b.ActivationState.Deactivated);
};
d.prototype.update=function(h,g){if(h!==null){this.elemInput.value=h;
}if(this.elemInput.selectionStart!=g){this.elemInput.setSelectionRange(g,g);
}};
d.prototype.setText=function(g){if(this.elemInput.tagName==="INPUT"){this.elemInput.value=g;
}else{this.elemInput.innerHTML=g;
}};
d.prototype.selectAll=function(){if(this.elemInput.tagName==="INPUT"){this.elemInput.select();
return;
}var g=this.elemInput;
var h=document.createRange();
h.selectNodeContents(g);
var i=window.getSelection();
i.removeAllRanges();
i.addRange(h);
};
function e(g){var h=g.elemInput.innerHTML;
g.elemInput.innerHTML="";
b.pasteText(h,b.ClipboardDataType.HTML);
}function f(h,g){if(b.clipboardMode==b.ClipboardMode.Server){return;
}if(!b.handleClientPaste(g,false)){return;
}h.elemInput.innerHTML="";
setTimeout(function(){e(h);
},10);
return false;
}return d;
})();
return c;
}(TXTextControl||{},j$1_10_2));
var TXTextControl=(function(d,a){var b=d._private=d._private||{};
var c=d.images=d.images||{};
b.ImageInsertionMode={};
b.AddImageOperation={};
c.addInline=function(imageData,textPosition){if(typeof imageData!=="string"){throw new TypeError(b.ErrorText.ParamNotAString);
}if(!isInteger(textPosition)){throw new TypeError('"textPosition" must be an integer.');
}var e={imageData:imageData,textPosition:textPosition,};
b.sendCommand(b.Command.AddImage,b.AddImageOperation.Inline,0,0,e);
};
c.addAnchored=function(imageData,horizontalAlignment,textPosition,insertionMode){if(typeof imageData!=="string"){throw new TypeError(b.ErrorText.ParamNotAString);
}if(!isInteger(horizontalAlignment)){throw new TypeError('"horizontalAlignment" must be one of the values defined in TXTextControl.HorizontalAlignment.');
}if(!isInteger(textPosition)){throw new TypeError('"textPosition" must be an integer.');
}if(!isInteger(insertionMode)){throw new TypeError('"insertionMode" must be one of the values defined in TXTextControl.ImageInsertionMode.');
}var e={imageData:imageData,horizontalAlignment:horizontalAlignment,textPosition:textPosition,insertionMode:insertionMode};
b.sendCommand(b.Command.AddImage,b.AddImageOperation.Anchored,0,0,e);
};
c.addAnchoredAtLocation=function(imageData,location,textPosition,insertionMode){if(typeof imageData!=="string"){throw new TypeError(b.ErrorText.ParamNotAString);
}if((location===null)||(location===undefined)){throw new TypeError('Please provide the "location" parameter.');
}if(!location.hasOwnProperty("x")||!location.hasOwnProperty("y")){throw new TypeError('Parameter "location" must have properties "x" and "y".');
}if(!isInteger(textPosition)){throw new TypeError('"textPosition" must be an integer.');
}if(!isInteger(insertionMode)){throw new TypeError('"insertionMode" must be one of the values defined in TXTextControl.ImageInsertionMode.');
}var e={imageData:imageData,location:location,textPosition:textPosition,insertionMode:insertionMode};
b.sendCommand(b.Command.AddImage,b.AddImageOperation.AnchoredAtLocation,0,0,e);
};
c.addAtFixedPosition=function(imageData,pageNumber,location,insertionMode){if(typeof imageData!=="string"){throw new TypeError(b.ErrorText.ParamNotAString);
}if(!isInteger(pageNumber)){throw new TypeError('"pageNumber" must be an integer.');
}if((location===null)||(location===undefined)){throw new TypeError('Please provide the "location" parameter.');
}if(!location.hasOwnProperty("x")||!location.hasOwnProperty("y")){throw new TypeError('Parameter "location" must have properties "x" and "y".');
}if(!isInteger(insertionMode)){throw new TypeError('"insertionMode" must be one of the values defined in TXTextControl.ImageInsertionMode.');
}var e={imageData:imageData,pageNumber:pageNumber,location:location,insertionMode:insertionMode};
b.sendCommand(b.Command.AddImage,b.AddImageOperation.AtFixedPosition,0,0,e);
};
return d;
}(TXTextControl||{},j$1_10_2));
var TXTextControl=(function(d,a){var b=d._private=d._private||{};
var c=d.textFrames=d.textFrames||{};
b.TextFrameInsertionMode={};
b.AddTextFrameOperation={};
c.addInline=function(size,textPosition){if((size===null)||(size===undefined)){throw new TypeError('Please provide the "size" parameter.');
}if(!size.hasOwnProperty("width")||!size.hasOwnProperty("height")){throw new TypeError('Parameter "size" must have properties "width" and "height".');
}if(!isInteger(textPosition)){throw new TypeError('"textPosition" must be an integer.');
}var e={size:size,textPosition:textPosition,};
b.sendCommand(b.Command.AddTextFrame,b.AddTextFrameOperation.Inline,0,0,e);
};
c.addAnchored=function(size,horizontalAlignment,textPosition,insertionMode){if((size===null)||(size===undefined)){throw new TypeError('Please provide the "size" parameter.');
}if(!size.hasOwnProperty("width")||!size.hasOwnProperty("height")){throw new TypeError('Parameter "size" must have properties "width" and "height".');
}if(!isInteger(horizontalAlignment)){throw new TypeError('"horizontalAlignment" must be one of the values defined in TXTextControl.HorizontalAlignment.');
}if(!isInteger(textPosition)){throw new TypeError('"textPosition" must be an integer.');
}if(!isInteger(insertionMode)){throw new TypeError('"insertionMode" must be one of the values defined in TXTextControl.TextFrameInsertionMode.');
}var e={size:size,horizontalAlignment:horizontalAlignment,textPosition:textPosition,insertionMode:insertionMode};
b.sendCommand(b.Command.AddTextFrame,b.AddTextFrameOperation.Anchored,0,0,e);
};
c.addAnchoredAtLocation=function(size,location,textPosition,insertionMode){if((size===null)||(size===undefined)){throw new TypeError('Please provide the "size" parameter.');
}if(!size.hasOwnProperty("width")||!size.hasOwnProperty("height")){throw new TypeError('Parameter "size" must have properties "width" and "height".');
}if((location===null)||(location===undefined)){throw new TypeError('Please provide the "location" parameter.');
}if(!location.hasOwnProperty("x")||!location.hasOwnProperty("y")){throw new TypeError('Parameter "location" must have properties "x" and "y".');
}if(!isInteger(textPosition)){throw new TypeError('"textPosition" must be an integer.');
}if(!isInteger(insertionMode)){throw new TypeError('"insertionMode" must be one of the values defined in TXTextControl.TextFrameInsertionMode.');
}var e={size:size,location:location,textPosition:textPosition,insertionMode:insertionMode};
b.sendCommand(b.Command.AddTextFrame,b.AddTextFrameOperation.AnchoredAtLocation,0,0,e);
};
c.addAtFixedPosition=function(size,pageNumber,location,insertionMode){if((size===null)||(size===undefined)){throw new TypeError('Please provide the "size" parameter.');
}if(!size.hasOwnProperty("width")||!size.hasOwnProperty("height")){throw new TypeError('Parameter "size" must have properties "width" and "height".');
}if(!isInteger(pageNumber)){throw new TypeError('"pageNumber" must be an integer.');
}if((location===null)||(location===undefined)){throw new TypeError('Please provide the "location" parameter.');
}if(!location.hasOwnProperty("x")||!location.hasOwnProperty("y")){throw new TypeError('Parameter "location" must have properties "x" and "y".');
}if(!isInteger(insertionMode)){throw new TypeError('"insertionMode" must be one of the values defined in TXTextControl.TextFrameInsertionMode.');
}var e={size:size,pageNumber:pageNumber,location:location,insertionMode:insertionMode};
b.sendCommand(b.Command.AddTextFrame,b.AddTextFrameOperation.AtFixedPosition,0,0,e);
};
c.addWithMouse=function(insertionMode){if(!isInteger(insertionMode)){throw new TypeError('"insertionMode" must be one of the values defined in TXTextControl.TextFrameInsertionMode.');
}var e={insertionMode:insertionMode};
b.sendCommand(b.Command.AddTextFrame,b.AddTextFrameOperation.WithMouse,0,0,e);
};
return d;
}(TXTextControl||{},j$1_10_2));
var TXTextControl=(function(f,a){var b=f._private=f._private||{};
b.modifierKeys=0;
var d={Shift:4,Ctrl:8,Alt:2048,Mask:2060};
b.KeyCode={Backspace:a.ui.keyCode.BACKSPACE,TAB:a.ui.keyCode.TAB,Enter:a.ui.keyCode.ENTER,Shift:16,Control:17,Alt:18,LeftArrow:a.ui.keyCode.LEFT,UpArrow:a.ui.keyCode.UP,RightArrow:a.ui.keyCode.RIGHT,DownArrow:a.ui.keyCode.DOWN,DEL:a.ui.keyCode.DELETE,INS:45,END:a.ui.keyCode.END,HOME:a.ui.keyCode.HOME,PageUp:a.ui.keyCode.PAGE_UP,PageDown:a.ui.keyCode.PAGE_DOWN,Space:a.ui.keyCode.SPACE};
function c(g){var h=0;
if(g.shiftKey){h|=d.Shift;
}if(g.altKey){h|=d.Alt;
}if(g.ctrlKey||g.metaKey){h|=d.Ctrl;
}return h;
}function e(h,i){b.modifierKeys=c(h);
var j=h.keyCode||h.which||0;
switch(j){case 171:j=187;
break;
case 173:j=189;
break;
}var g={key:j,modifierKeys:b.modifierKeys};
b.sendCommand(b.Command.ComponentEvent,i,0,0,g);
switch(j){case b.KeyCode.Enter:case b.KeyCode.Backspace:case b.KeyCode.TAB:case b.KeyCode.DEL:case b.KeyCode.END:case b.KeyCode.HOME:case b.KeyCode.LeftArrow:case b.KeyCode.UpArrow:case b.KeyCode.RightArrow:case b.KeyCode.DownArrow:case b.KeyCode.PageUp:case b.KeyCode.PageDown:h.preventDefault();
break;
}}b.keyDownHandler=function(k){b.modifierKeys=c(k);
var l=k.keyCode||k.which||0;
if(b.modifierKeys&d.Ctrl){switch(l){case 43:case 45:case 107:case 109:case 171:case 173:case 187:case 189:k.preventDefault();
break;
}}var i=(((b.modifierKeys&d.Mask)==d.Ctrl)&&(l==86))||((b.modifierKeys&d.Shift)&&(l==b.KeyCode.INS));
var h=(((b.modifierKeys&d.Mask)==d.Ctrl)&&(l==88))||((b.modifierKeys&d.Shift)&&(l==b.KeyCode.DEL));
var g=((b.modifierKeys&d.Mask)==d.Ctrl)&&((l==67)||(l==b.KeyCode.INS));
if(((b.modifierKeys&d.Mask)==(d.Ctrl|d.Shift)&&(l==86))){var j=new b.ClientPasteDialog();
j.showModal();
k.preventDefault();
return;
}else{if(b.clipboardMode==b.ClipboardMode.Server){if(i){k.preventDefault();
}}}if((g||h)&&(b.clipboardMode==b.ClipboardMode.Client)){if(g){document.execCommand("copy");
}else{if(h){document.execCommand("cut");
}}k.preventDefault();
}if(i&&(b.clipboardMode==b.ClipboardMode.Client)){return;
}e(k,b.UserInputEventType.KeyDown);
};
b.keyUpHandler=function(g){e(g,b.UserInputEventType.KeyUp);
};
b.keyPressHandler=function(g){if((typeof g.charCode!=="undefined")&&(g.charCode===0)){return;
}b.modifierKeys=c(g);
var h=g.charCode||g.keyCode||g.which||0;
if(h){b.sendCommand(b.Command.ComponentEvent,b.UserInputEventType.KeyPress,0,0,{key:h,modifierKeys:b.modifierKeys});
}else{g.preventDefault();
}};
return f;
}(TXTextControl||{},j$1_10_2));
var TXTextControl=(function(j,a){var b=j._private=j._private||{};
b.ComponentType={TextView:0,HorRuler:1,VertRuler:2,StatusBar:3,TxDialog:4};
b.UserInputEventType={KeyDown:0,KeyPress:1,KeyUp:2,MouseMove:3,MouseDown:4,MouseUp:5,MouseDoubleClick:6,MouseWheel:7};
var g={Left:1,Right:2,Middle:16};
var f={IBeam:1,ArrowNE:2,VSplit:3,UpArrow:4,Arrow:5,DownArrow:6,SizeWE:7,SizeNS:8,SizeNWSE:9,SizeNESW:10,SizeAll:11,Cross:12,No:13,DragDropCopy:14,DragDropMove:15};
var h={MoveAndSizeFrame:1,TableBorderMovingLine:2,DropCaret:3};
b.cloneTouch=function(k){return{clientX:k.clientX,clientY:k.clientY,screenX:k.screenX,screenY:k.screenY,identifier:k.identifier,hasLeftDeadzone:k.hasLeftDeadzone};
};
var c=false;
var e={touches:{},getItem:function(k){return this.touches["_"+k];
},add:function(l){var k=l.identifier;
this.touches["_"+k]=b.cloneTouch(l);
},removeItem:function(k){var l=this.getItem(k);
delete this.touches["_"+k];
return l;
},update:function(l){for(var k=0;
k<l.length;
++k){this.add(l[k]);
}},count:function(){var l=0,k;
for(k in this.touches){if(this.touches.hasOwnProperty(k)){++l;
}}return l;
},clear:function(){this.touches={};
}};
var i=(function(){var l=250,k=500,n=500;
r.State={Initial:0,OneFinger:1,NoFingerAfterOneFinger:2,ImpendingDoubleClickOrObjectGrip:3,ObjectGrip:4};
r.TouchEventType={Start:0,Move:1,End:2};
function r(s){this.state=r.State.Initial;
this.viewer=s;
this.targetElem=s.canvas;
this.touch=null;
this.timeoutID=null;
}function p(w,u,s,v){var t=document.createEvent("MouseEvents");
t.initMouseEvent(u,true,true,window,1,w.screenX,w.screenY,w.clientX,w.clientY,false,false,false,false,s,null);
v.dispatchEvent(t);
}r.prototype.simulateMouseClick=function(t,s){p(t,"mouseover",s,this.targetElem);
p(t,"mousemove",s,this.targetElem);
p(t,"mousedown",s,this.targetElem);
p(t,"mouseup",s,this.targetElem);
p(t,"mousemove",s,this.targetElem);
p(t,"mouseout",s,this.targetElem);
p(t,"click",s,this.targetElem);
};
r.prototype.simulateMouseDoubleClick=function(t,s){p(t,"mouseover",s,this.targetElem);
p(t,"mousemove",s,this.targetElem);
p(t,"mousedown",s,this.targetElem);
p(t,"mouseup",s,this.targetElem);
p(t,"click",s,this.targetElem);
p(t,"mousedown",s,this.targetElem);
p(t,"mouseup",s,this.targetElem);
p(t,"mousemove",s,this.targetElem);
p(t,"mouseout",s,this.targetElem);
p(t,"click",s,this.targetElem);
p(t,"dblclick",s,this.targetElem);
};
r.prototype.reset=function(){if(this.timeoutID){clearTimeout(this.timeoutID);
this.timeoutID=null;
}if(this.touch){p(this.touch,"mouseup",0,this.targetElem);
p(this.touch,"mousemove",0,this.targetElem);
p(this.touch,"mouseout",0,this.targetElem);
this.touch=null;
}this.state=r.State.Initial;
};
function o(){b.ignoreNextTextFocusRequest=true;
this.simulateMouseClick(this.touch,2);
this.timeoutID=this.touch=null;
this.state=r.State.Initial;
}r.prototype.initialState=function(t,s){switch(s){case r.TouchEventType.Start:this.timeoutID=setTimeout(o.bind(this),k);
this.touch=b.cloneTouch(t);
this.state=r.State.OneFinger;
break;
default:this.reset();
}};
function m(){this.timeoutID=this.touch=null;
this.state=r.State.Initial;
}r.prototype.oneFingerState=function(t,s){switch(s){case r.TouchEventType.End:if(this.timeoutID){clearTimeout(this.timeoutID);
}this.timeoutID=setTimeout(m.bind(this),l);
this.touch=b.cloneTouch(t);
this.state=r.State.NoFingerAfterOneFinger;
break;
default:this.reset();
}};
function q(s){s=s||this;
p(s.touch,"mouseover",0,s.targetElem);
p(s.touch,"mousemove",0,s.targetElem);
p(s.touch,"mousedown",0,s.targetElem);
s.timeoutID=s.touch=null;
s.state=r.State.ObjectGrip;
}r.prototype.noFingerAfterOneFingerState=function(t,s){switch(s){case r.TouchEventType.Start:if(this.timeoutID){clearTimeout(this.timeoutID);
}this.timeoutID=setTimeout(q.bind(this),n);
this.touch=b.cloneTouch(t);
this.state=r.State.ImpendingDoubleClickOrObjectGrip;
break;
default:this.reset();
}};
r.prototype.impendingDoubleClickOrObjectGripState=function(t,s){switch(s){case r.TouchEventType.End:if(this.timeoutID){clearTimeout(this.timeoutID);
this.timeoutID=null;
}this.simulateMouseDoubleClick(t,0);
this.state=r.State.Initial;
break;
case r.TouchEventType.Move:if(this.timeoutID){clearTimeout(this.timeoutID);
this.timeoutID=null;
}q(this);
this.touch=b.cloneTouch(t);
break;
default:this.reset();
}};
r.prototype.objectGripState=function(t,s){switch(s){case r.TouchEventType.Move:p(t,"mousemove",0,this.targetElem);
this.touch=b.cloneTouch(t);
break;
case r.TouchEventType.End:p(t,"mouseup",0,this.targetElem);
p(t,"mousemove",0,this.targetElem);
p(t,"mouseout",0,this.targetElem);
this.touch=b.cloneTouch(t);
this.state=r.State.Initial;
break;
default:this.reset();
}};
r.prototype.processTouch=function(t,s){switch(this.state){case r.State.Initial:this.initialState(t,s);
break;
case r.State.OneFinger:this.oneFingerState(t,s);
break;
case r.State.NoFingerAfterOneFinger:this.noFingerAfterOneFingerState(t,s);
break;
case r.State.ImpendingDoubleClickOrObjectGrip:this.impendingDoubleClickOrObjectGripState(t,s);
break;
case r.State.ObjectGrip:this.objectGripState(t,s);
break;
}};
return r;
})();
var d=20;
b.mouseOwner=null;
b.isPinchZooming=false;
b.ComponentViewer=(function(){var p="1px dashed black",q="lightgray";
function k(r,s,u,t){this.canvas=r;
this.context=r.getContext("2d");
this.mouseButtons=0;
this.imgBuffer=null;
this.shapeDIV=null;
this.shapeBlinkTimer=null;
this.shapeIsBlack=true;
this.hiddenTextField=null;
this.touchStateMachine=b.isTouchDevice?new i(this):null;
this.viewChangedQueue=[];
this.bUpdating=false;
this.dialogNestingDepth=t||0;
this.caret=new b.Caret(r);
if((s==b.ComponentType.TextView)||(s==b.ComponentType.TxDialog)){this.hiddenTextField=new b.HiddenTextField(r,s,this);
}this.componentType=s;
this.dialogType=u||b.TXDialogType.Unknown;
this.cursorType=null;
this.shapeDIV=document.createElement("div");
this.shapeDIV.classList.add("txShapeDIV");
this.shapeDIV.style.top="1px";
this.shapeDIV.style.left="-9999px";
this.context.canvas.parentNode.appendChild(this.shapeDIV);
this.canvasClientBoundRect=null;
r.addEventListener("mousedown",this.canvas_MouseDown.bind(this));
r.addEventListener("mouseup",this.canvas_MouseUp.bind(this));
r.addEventListener("click",this.canvas_Click.bind(this));
this.shapeDIV.addEventListener("mouseup",this.canvas_MouseUp.bind(this));
r.addEventListener("mousemove",this.canvas_MouseMove.bind(this));
r.addEventListener("dblclick",this.canvas_DoubleClick.bind(this));
r.addEventListener("DOMMouseScroll",this.canvas_MouseWheel.bind(this));
r.addEventListener("mousewheel",this.canvas_MouseWheel.bind(this));
r.addEventListener("contextmenu",function(v){v.preventDefault();
});
if(b.isTouchDevice){r.addEventListener("touchstart",this.canvas_TouchStart.bind(this));
r.addEventListener("touchend",this.canvas_TouchEnd.bind(this));
r.addEventListener("touchcancel",this.canvas_TouchCancel.bind(this));
r.addEventListener("touchleave",this.canvas_TouchEnd.bind(this));
r.addEventListener("touchmove",this.canvas_TouchMove.bind(this));
}document.addEventListener("componentCursorChanged",this.cursorChanged.bind(this));
if(this.componentType==b.ComponentType.TextView){document.addEventListener("drawShapeMessageReceived",this.drawShape.bind(this));
}}Object.defineProperty(k.prototype,"width",{get:function(){return this.canvas.width;
},set:function(r){this.canvas.width=r;
},enumerable:true,configurable:true});
Object.defineProperty(k.prototype,"height",{get:function(){return this.canvas.height;
},set:function(r){this.canvas.height=r;
},enumerable:true,configurable:true});
Object.defineProperty(k.prototype,"left",{get:function(){return this.canvas.offsetLeft;
},set:function(r){this.canvas.style.left=r+"px";
},enumerable:true,configurable:true});
Object.defineProperty(k.prototype,"top",{get:function(){return this.canvas.offsetTop;
},set:function(r){this.canvas.style.top=r+"px";
},enumerable:true,configurable:true});
Object.defineProperty(k.prototype,"caretBounds",{get:function(){return this.caret.bounds;
},enumerable:true,configurable:true});
k.prototype.setCaretState=function(r){if(b.isTouchDevice&&!b.inIMEComposition&&r.Visibility&&this.hiddenTextField){this.hiddenTextField.top=r.Location.Y+this.canvas.offsetTop;
}this.caret.setState(r);
};
k.prototype.setImage=function(t,r){var u=this;
r=r||false;
var s=new Image();
s.onload=function(){if(r){u.canvas.width=s.naturalWidth;
u.canvas.height=s.naturalHeight;
}u.context.clearRect(0,0,s.naturalWidth,s.naturalHeight);
u.context.drawImage(s,0,0,s.naturalWidth,s.naturalHeight);
b.sendCommand(b.Command.ImageLoaded,u.componentType,u.dialogType,u.dialogNestingDepth);
};
s.src=t;
};
k.prototype.requestUpdateImageRegions=function(r){if(this.bUpdating){this.viewChangedQueue.push({tiles:r});
return;
}this.bUpdating=true;
this.updateImageRegions(r);
};
k.prototype.requestScroll=function(r,s){if(this.bUpdating){this.viewChangedQueue.push({delta:r,tiles:s});
return;
}this.bUpdating=true;
this.scroll(r,s);
};
k.prototype.updateImageRegions=function(t){var s=this,u=0,r=t.length;
t.forEach(function(w){var v=new Image();
v.onload=function(){if(s.componentType==b.ComponentType.TxDialog){s.context.clearRect(w.pos.X,w.pos.Y,v.naturalWidth,v.naturalHeight);
}s.context.drawImage(v,w.pos.X,w.pos.Y,v.naturalWidth,v.naturalHeight);
if(r==++u){if(s.viewChangedQueue.length>0){s.processNextQueueEntry();
}else{b.sendCommand(b.Command.ImageLoaded,s.componentType,s.dialogType,s.dialogNestingDepth);
s.bUpdating=false;
}}};
v.src=w.imageDataURL;
});
};
k.prototype.scroll=function(s,v){var u=this,t=0,r=v.length;
if(!this.canvas.width||!this.canvas.height){return;
}this.context.drawImage(this.canvas,s.X,s.Y,this.canvas.width,this.canvas.height);
v.forEach(function(x){var w=new Image();
w.onload=function(){u.context.drawImage(w,x.pos.X,x.pos.Y,w.naturalWidth,w.naturalHeight);
if(r==++t){if(u.viewChangedQueue.length>0){u.processNextQueueEntry();
}else{b.sendCommand(b.Command.ImageLoaded,u.componentType,u.dialogType,u.dialogNestingDepth);
u.bUpdating=false;
}}};
w.src=x.imageDataURL;
});
};
k.prototype.processNextQueueEntry=function(){var r=this.viewChangedQueue.shift();
if(r.hasOwnProperty("delta")){this.scroll(r.delta,r.tiles);
}else{this.updateImageRegions(r.tiles);
}};
k.prototype.show=function(){this.canvas.style.display="block";
};
k.prototype.hide=function(){this.canvas.style.display="none";
};
k.prototype.showCaret=function(){this.caret.show();
};
k.prototype.hideCaret=function(){this.caret.hide();
};
k.prototype.refreshCaretLocation=function(){this.caret.refreshLocation();
};
k.prototype.bufferContent=function(){if(!this.canvas.width||!this.canvas.height){this.imgBuffer=null;
return;
}this.imgBuffer=this.context.getImageData(0,0,this.canvas.width,this.canvas.height);
};
k.prototype.drawBufferedContent=function(){if(!this.imgBuffer){return;
}this.context.putImageData(this.imgBuffer,0,0);
delete this.imgBuffer;
};
k.prototype.canvas_MouseDown=function(s){if(!b.mouseOwner){b.mouseOwner=this;
}else{if(b.mouseOwner!=this){b.mouseOwner.canvas_MouseDown(s);
return;
}}if(s.which==1){this.mouseButtons|=g.Left;
}if(s.which==2){this.mouseButtons|=g.Middle;
}if(s.which==3){this.mouseButtons|=g.Right;
}if(s.detail==2){this.canvas_DoubleClick(s);
c=true;
s.preventDefault();
return;
}var t=this.getMousePos(s),r={mousePos:{X:Math.round(t.x),Y:Math.round(t.y)},modifierKeys:b.modifierKeys,buttons:this.mouseButtonToMouseButtonFlag(s.which)};
b.sendCommand(b.Command.ComponentEvent,b.UserInputEventType.MouseDown,this.componentType,0,r);
s.preventDefault();
};
k.prototype.canvas_MouseUp=function(s){if(b.mouseOwner&&(b.mouseOwner!=this)){b.mouseOwner.canvas_MouseUp(s);
return;
}b.lastMouseUpEvent=s;
var t=this.getMousePos(s),r={mousePos:{X:Math.round(t.x),Y:Math.round(t.y)},modifierKeys:b.modifierKeys,buttons:this.mouseButtonToMouseButtonFlag(s.which)};
b.sendCommand(b.Command.ComponentEvent,b.UserInputEventType.MouseUp,this.componentType,0,r);
if(s.which==1){this.mouseButtons&=~g.Left;
}if(s.which==2){this.mouseButtons&=~g.Middle;
}if(s.which==3){this.mouseButtons&=~g.Right;
}this.canvasClientBoundRect=null;
if(s.which==1){this.hideShape();
}s.preventDefault();
};
k.prototype.canvas_Click=function(r){this.focus();
};
k.prototype.canvas_MouseMove=function(s){if(b.mouseOwner&&(b.mouseOwner!=this)){b.mouseOwner.canvas_MouseMove(s);
return;
}var t=this.getMousePos(s),r={mousePos:{X:Math.round(t.x),Y:Math.round(t.y)},modifierKeys:b.modifierKeys,buttons:this.mouseButtons};
b.sendCommand(b.Command.ComponentEvent,b.UserInputEventType.MouseMove,this.componentType,0,r);
s.preventDefault();
};
k.prototype.canvas_DoubleClick=function(s){if(c){c=false;
s.preventDefault();
return;
}var t=this.getMousePos(s),r={mousePos:{X:Math.round(t.x),Y:Math.round(t.y)},modifierKeys:b.modifierKeys,};
b.sendCommand(b.Command.ComponentEvent,b.UserInputEventType.MouseDoubleClick,this.componentType,0,r);
s.preventDefault();
};
k.prototype.canvas_TouchStart=function(r){b.hideAllOtherMenus();
b.fileMenu.hide();
var s=r.changedTouches;
if((s.length==1)&&(e.count()==0)){this.canvasClientBoundRect=this.canvas.getBoundingClientRect();
this.touchStateMachine.processTouch(s[0],i.TouchEventType.Start);
}else{this.touchStateMachine.reset();
}e.update(s);
};
k.prototype.canvas_TouchDragTextView=function(s){var t=e.getItem(s.identifier);
if(this.componentType==b.ComponentType.TextView){var r={X:t.clientX-s.clientX,Y:t.clientY-s.clientY};
r=b.pointPixelToTwips(r,b.zoom);
b.scrollDelta(r);
}};
k.prototype.canvas_TouchPinchTextView=function(D){b.isPinchZooming=true;
var B=D[0],E=e.getItem(B.identifier);
var C,F;
if(D.length==2){C=D[1];
F=e.getItem(C.identifier);
}else{for(var A in e.touches){if(A!=("_"+B.identifier)){F=C=e.touches[A];
break;
}}}var y={X:E.clientX,Y:E.clientY},z={X:F.clientX,Y:F.clientY},u=l(z,y),s=n(y,z);
y={X:B.clientX,Y:B.clientY};
z={X:C.clientX,Y:C.clientY};
var t=l(z,y),r=n(y,z);
var x={X:Math.round(s.X-r.X),Y:Math.round(s.Y-r.Y)};
var v=Math.sqrt(x.X*x.X+x.Y*x.Y);
if(v>0){x=b.pointPixelToTwips(x,b.zoom);
b.scrollDelta(x);
}var w=t/u;
b.zoom=Math.round(b.zoom*w);
b.sendCommand(b.Command.Zoom,b.zoom);
};
function o(u){var r=u.changedTouches;
var w=[];
for(var v=0;
v<r.length;
++v){var s=r[v];
var x=e.getItem(s.identifier);
if(x.hasLeftDeadzone){s.hasLeftDeadzone=true;
w.push(s);
}else{var t=m(x,s);
if(t>=d){s.hasLeftDeadzone=true;
w.push(s);
}}}return w;
}k.prototype.canvas_TouchMove=function(r){if(!e.count()){if(this.touchStateMachine.state!=i.State.Initial){this.touchStateMachine.reset();
}return;
}var s=o(r);
if(s.length){switch(this.touchStateMachine.state){case i.State.ObjectGrip:case i.State.ImpendingDoubleClickOrObjectGrip:this.touchStateMachine.processTouch(s[0],i.TouchEventType.Move);
break;
default:switch(this.componentType){case b.ComponentType.TextView:this.canvas_TouchMoveTextView(s);
break;
}this.touchStateMachine.reset();
}e.update(s);
}if(r.cancelable){r.preventDefault();
}};
k.prototype.canvas_TouchMoveTextView=function(r){switch(e.count()){case 1:this.canvas_TouchDragTextView(r[0]);
break;
case 2:this.canvas_TouchPinchTextView(r);
break;
}};
k.prototype.canvas_TouchEnd=function(r){b.isPinchZooming=false;
var u=r.changedTouches;
if(u.length==1){this.touchStateMachine.processTouch(u[0],i.TouchEventType.End);
}for(var s=0;
s<u.length;
++s){var t=u[s];
e.removeItem(t.identifier);
}};
k.prototype.canvas_TouchCancel=function(r){var u=r.changedTouches;
if(u.length==1){this.touchStateMachine.processTouch(u[0],i.TouchEventType.End);
}for(var s=0;
s<u.length;
++s){var t=u[s];
e.removeItem(t.identifier);
}if(r.cancelable){r.preventDefault();
}};
function l(t,u){var r=u.X-t.X;
var s=u.Y-t.Y;
return Math.sqrt((r*r)+(s*s));
}function m(t,u){var r={X:t.clientX,Y:t.clientY},s={X:u.clientX,Y:u.clientY};
return l(s,r);
}function n(r,s){return{X:(r.X+s.X)/2,Y:(r.Y+s.Y)/2};
}k.prototype.canvas_MouseWheel=function(t){var s=(t.wheelDelta||-(t.detail*40)),u=this.getMousePos(t),r={mousePos:{X:Math.round(u.x),Y:Math.round(u.y)},modifierKeys:b.modifierKeys,delta:s};
b.sendCommand(b.Command.ComponentEvent,b.UserInputEventType.MouseWheel,this.componentType,0,r);
t.preventDefault();
};
k.prototype.cursorChanged=function(s){var t=s.detail;
var r;
if(t.target!=this.componentType){return;
}if(t.dialogType!=this.dialogType){return;
}if(this.mouseButtons&g.Left){return;
}this.cursorType=t.cursorType;
switch(t.cursorType){case f.IBeam:this.canvas.style.cursor="text";
break;
case f.ArrowNE:if((b.BrowserDetect.browser==="Explorer")||(b.BrowserDetect.browser==="Other")||(b.BrowserDetect.browser==="Edge")){if(typeof b.webControlSettings!=="undefined"){r='url(<%=WebResource("TXTextControl.Web.Kernel.cursors.Markline.cur")%>), default';
}else{r="url("+b.getTXFileDir()+"cursors/markline.cur), default";
}}else{r="url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAAYdEVYdFNvZnR3YXJlAHBhaW50Lm5ldCA0LjAuNWWFMmUAAACXSURBVFhH7c/bCoAgEARQ//+njXEmK0qfHJdgD0TuhcZKoKonRAW8We7VwgFntvZRNKFmew/FXtDjyE+RT+hz7KW4N8y44qOob5hzzUMxY9jh6nqKmMMe19c6P9yfEc3tFMfAO9Rtw0xxPVDVngso6gpvXfXxZunTggBntjr7BRQ9/dPwC9goOiYcFB93AQgNTyml9BelHIyxV7cc72i2AAAAAElFTkSuQmCC) 32 0, default";
}this.canvas.style.cursor=r;
break;
case f.VSplit:this.canvas.style.cursor="col-resize";
break;
case f.UpArrow:this.canvas.style.cursor="pointer";
break;
case f.Arrow:this.canvas.style.cursor="default";
break;
case f.DownArrow:if((b.BrowserDetect.browser==="Explorer")||(b.BrowserDetect.browser==="Other")||(b.BrowserDetect.browser==="Edge")){if(typeof b.webControlSettings!=="undefined"){r='url(<%=WebResource("TXTextControl.Web.Kernel.cursors.tablecol.cur")%>), default';
}else{r="url("+b.getTXFileDir()+"cursors/tablecol.cur), default";
}}else{r="url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAAYdEVYdFNvZnR3YXJlAHBhaW50Lm5ldCA0LjAuNWWFMmUAAABRSURBVFhH7c5BCsAgDETR3P/SSiQjpSi4SVz4H2RRLPyxDG0hnmpEcB4DGPDOgFEK/qn78v/SRGB76QPcbkRJXP4jSuOiEVficjUOAACAM2YdIA+kXMDmcwcAAAAASUVORK5CYII=) 23 11, default";
}this.canvas.style.cursor=r;
break;
case f.SizeWE:this.canvas.style.cursor="ew-resize";
break;
case f.SizeNS:this.canvas.style.cursor="ns-resize";
break;
case f.SizeNWSE:this.canvas.style.cursor="nwse-resize";
break;
case f.SizeNESW:this.canvas.style.cursor="nesw-resize";
break;
case f.SizeAll:this.canvas.style.cursor="move";
break;
case f.Cross:this.canvas.style.cursor="crosshair";
break;
case f.No:this.canvas.style.cursor="not-allowed";
break;
case f.DragDropCopy:this.canvas.style.cursor="copy";
break;
case f.DragDropMove:this.canvas.style.cursor="move";
break;
default:this.canvas.style.cursor="default";
break;
}};
k.prototype.shapeBlink=function(){if(this.shapeIsBlack){this.shapeDIV.style.borderColor=q;
this.shapeIsBlack=false;
}else{this.shapeDIV.style.borderColor="black";
this.shapeIsBlack=true;
}};
k.prototype.hideShape=function(){if(this.shapeBlinkTimer){clearTimeout(this.shapeBlinkTimer);
this.shapeDIV.style.borderColor="black";
this.shapeBlinkTimer=null;
this.shapeIsBlack=true;
}this.shapeDIV.style.opacity=0;
this.shapeDIV.style.left="-9999px";
};
k.prototype.drawShape=function(r){if(!(this.mouseButtons&g.Left)){return;
}var s=r.detail;
if(!this.shapeBlinkTimer){this.shapeBlinkTimer=setInterval(this.shapeBlink.bind(this),500);
this.shapeDIV.style.background="transparent";
switch(s.Kind){case h.TableBorderMovingLine:this.shapeDIV.style.border="none";
this.shapeDIV.style.borderLeft=p;
break;
case h.MoveAndSizeFrame:this.shapeDIV.style.border=p;
break;
case h.DropCaret:this.shapeDIV.style.border="none";
this.shapeDIV.style.background="black";
break;
}this.shapeDIV.style.opacity=1;
}var t=s.Location.X+this.left,u=s.Location.Y+this.top;
this.shapeDIV.style.top=u+"px";
this.shapeDIV.style.left=t+"px";
this.shapeDIV.style.height=s.Size.Height+"px";
this.shapeDIV.style.width=s.Size.Width+"px";
};
k.prototype.focus=function(){if(b.ignoreNextTextFocusRequest){b.ignoreNextTextFocusRequest=false;
return;
}if(!this.hiddenTextField){return;
}if((this.componentType!=b.ComponentType.TextView)&&(this.componentType!=b.ComponentType.TxDialog)){return;
}this.hiddenTextField.focus();
b.sendCommand(b.Command.ComponentActivationState,this.componentType,b.ActivationState.Activated);
};
k.prototype.blur=function(){if(this.hiddenTextField){this.hiddenTextField.blur();
}};
k.prototype.getMousePos=function(r){var s;
if(b.isTouchDevice&&this.canvasClientBoundRect){s=this.canvasClientBoundRect;
}else{s=this.canvas.getBoundingClientRect();
}return{x:r.clientX-s.left,y:r.clientY-s.top};
};
k.prototype.mouseButtonToMouseButtonFlag=function(r){switch(r){case 1:return g.Left;
case 2:return g.Middle;
case 3:return g.Right;
}return 0;
};
k.prototype.setHiddenTextFieldText=function(r){this.hiddenTextField.setText(r);
};
k.prototype.selectHiddenTextfieldContent=function(){this.hiddenTextField.selectAll();
};
return k;
})();
return j;
}(TXTextControl||{},j$1_10_2));
var TXTextControl=(function(s,a){"use strict";
var e=s._private=s._private||{};
e.ScrollbarWidth=15;
e.StatusBarHeight=22;
e.VertRulerWidth=25;
e.HorRulerHeight=25;
e.MinScrollbarHandleLength=30;
e.DEFAULT_RIBBONBAR_HEIGHT=114;
e.ribbonBarHeight=e.DEFAULT_RIBBONBAR_HEIGHT;
e.DefRes=96;
e.ScrollStep=1000;
var c=false;
var h=false;
var b=true;
var g=true;
var f=true;
e.ViewersInvisible=true;
e.ScrollPadding=567;
var d=false;
e.clientSize={Width:0,Height:0};
e.textViewSizeInTwips={Width:0,Height:0};
e.documentSize={Width:0,Height:0};
e.viewLocation={X:-e.ScrollPadding,Y:0};
e.zoom=100;
e.createScrollbars=function(){var A=a("#slider-horizontal");
var B=a("#slider-vertical");
B.on("mousedown",y);
B.on("touchstart",y);
A.on("mousedown",m);
A.on("touchstart",m);
A.slider({orientation:"horizontal",min:-e.ScrollPadding,max:100,value:-e.ScrollPadding,slide:function(C,D){n(D.value);
},start:function(){d=true;
},stop:function(){d=false;
}});
B.slider({orientation:"vertical",min:0,max:100,value:100,slide:function(C,D){var E=B.slider("option","max")-D.value;
o(E);
},start:function(){d=true;
},stop:function(){d=false;
}});
a("#slider-horizontal .txui-slider-handle").unbind("keydown");
a("#slider-vertical .txui-slider-handle").unbind("keydown");
a("#vertical-scrollbar-wrapper").click(x);
a("#horizontal-scrollbar-wrapper").click(l);
a("div.scroll-button").click(p);
};
function n(A){e.sendCommand(e.Command.HScroll,A);
}function o(A){e.sendCommand(e.Command.VScroll,A);
}e.scrollDelta=function(A){e.sendCommand(e.Command.ScrollDelta,A.X,A.Y);
};
e.onContainerResize=function(){e.adaptViewToContainerSize();
};
e.documentSizeChangedHandler=function(A){var B=A.detail;
e.documentSize.Width=B.Width;
e.documentSize.Height=B.Height;
i();
};
function ZoomFactorChangedEventArgs(zoomFactor){this.zoomFactor=zoomFactor;
}e.txZoomedHandler=function(B){var C=B.detail;
var A=new ZoomFactorChangedEventArgs(C.zoomFactor);
e.fireEvent(e.EventName.zoomFactorChanged,A);
if(!e.isPinchZooming){e.zoom=C.zoomFactor;
}r(C.zoomFactor);
i();
};
function v(){if(d){return;
}if(!e.documentSize.Width||!e.documentSize.Height){return;
}var D={Width:e.textViewer.width,Height:e.textViewer.height};
D=q(D,e.zoom);
var A=e.documentSize.Width-D.Width;
var E=e.documentSize.Height-D.Height;
var B=(e.viewLocation.X+e.ScrollPadding)/A;
var C=e.viewLocation.Y/E;
if(c){a("#slider-horizontal").slider("option","value",(B*e.documentSize.Width)-e.ScrollPadding);
}if(h){a("#slider-vertical").slider("option","value",(1-C)*e.documentSize.Height);
}}function u(){var A=b?e.HorRulerHeight:0;
var B=g?e.VertRulerWidth:0;
t(B,A);
w(B,A);
}function t(J,D){var G=a("#slider-horizontal");
var H=a("#horizontal-scrollbar-wrapper");
var A={left:a("#scroll-button-left"),right:a("#scroll-button-right")};
var C=a("#slider-horizontal a.txui-slider-handle");
if(c){H.show();
A.left.show();
A.right.show();
var B=A.left[0].clientWidth;
var F=e.textViewer.width-(2*B);
var E=Math.max(e.MinScrollbarHandleLength,(e.textViewSizeInTwips.Width/e.documentSize.Width)*F);
C.css({width:E,height:e.ScrollbarWidth,top:0,marginLeft:-(E/2)});
G.slider("option","min",-e.ScrollPadding);
G.slider("option","max",e.documentSize.Width-e.ScrollPadding);
G.css({width:e.textViewer.width-E-(2*B),marginLeft:E/2});
var I=e.textViewer.height+e.ribbonBarHeight+D;
H.css({width:F,height:e.ScrollbarWidth,left:B+J,top:I});
A.left.css({left:J,top:I});
A.right.css({left:B+F+J,top:I});
}else{H.hide();
A.left.hide();
A.right.hide();
}}function w(I,D){var G=a("#slider-vertical");
var H=a("#vertical-scrollbar-wrapper");
var B={up:a("#scroll-button-up"),down:a("#scroll-button-down")};
var C=a("#slider-vertical a.txui-slider-handle");
if(h){H.show();
B.up.show();
B.down.show();
var A=B.up[0].clientHeight;
var F=e.textViewer.height-(2*A);
var E=Math.max(e.MinScrollbarHandleLength,(e.textViewSizeInTwips.Height/e.documentSize.Height)*F);
C.css({width:e.ScrollbarWidth,height:E,left:0,marginBottom:-(E/2)});
G.slider("option","min",0);
G.slider("option","max",e.documentSize.Height);
G.css({height:e.textViewer.height-E-(2*A),marginTop:E/2});
H.css({height:F,width:e.ScrollbarWidth,left:e.textViewer.width+I,top:e.ribbonBarHeight+A+D});
B.up.css({left:e.textViewer.width+I,top:e.ribbonBarHeight+D});
B.down.css({left:e.textViewer.width+I,top:e.ribbonBarHeight+A+F+D});
}else{H.hide();
B.up.hide();
B.down.hide();
}}function x(A){var C=a("#vertical-scrollbar-wrapper")[0];
var D=(A.pageY-C.offsetTop)/C.clientHeight;
var B=1-(a("#slider-vertical").slider("option","value")/e.documentSize.Height);
if(!e.isTouchDevice){e.textViewer.focus();
}if(D>B){e.sendCommand(e.Command.ComponentEvent,e.UserInputEventType.KeyDown,e.ComponentType.TextView,0,{key:e.KeyCode.PageDown});
}else{e.sendCommand(e.Command.ComponentEvent,e.UserInputEventType.KeyDown,e.ComponentType.TextView,0,{key:e.KeyCode.PageUp});
}}function l(A){var C=a("#horizontal-scrollbar-wrapper")[0];
var D=(A.pageX-C.offsetLeft)/C.clientWidth;
var B=(a("#slider-horizontal").slider("option","value")+e.ScrollPadding)/e.documentSize.Width;
if(!e.isTouchDevice){e.textViewer.focus();
}if(D>B){e.scrollDelta({X:e.ScrollStep,Y:0});
}else{e.scrollDelta({X:-e.ScrollStep,Y:0});
}}function y(A){var C=a("#slider-vertical");
var B=C.find(".txui-slider-handle");
if(A.target!=B[0]){A.stopImmediatePropagation();
}}function m(A){var C=a("#slider-horizontal");
var B=C.find(".txui-slider-handle");
if(A.target!=B[0]){A.stopImmediatePropagation();
}}function p(A){switch(A.currentTarget.id){case"scroll-button-up":e.scrollDelta({X:0,Y:-e.ScrollStep});
break;
case"scroll-button-down":e.scrollDelta({X:0,Y:e.ScrollStep});
break;
case"scroll-button-left":e.scrollDelta({X:-e.ScrollStep,Y:0});
break;
case"scroll-button-right":e.scrollDelta({X:e.ScrollStep,Y:0});
break;
}}function k(){if(e.ViewersInvisible){var C=document.querySelectorAll("#txTemplateDesignerContainer canvas");
for(var A=0;
A<C.length;
++A){C[A].style.opacity="";
}var B=document.getElementById("txLoaderGif");
B.style.opacity="";
setTimeout(function(){var D=document.getElementById("txTemplateDesignerContainer");
D.removeChild(B);
},500);
e.ViewersInvisible=false;
}}e.imageReceivedHandler=function(A){var C=A.detail;
switch(C.target){case e.ComponentType.TextView:e.textViewer.setImage(C.data);
break;
case e.ComponentType.HorRuler:e.horRulerViewer.setImage(C.data);
break;
case e.ComponentType.VertRuler:e.vertRulerViewer.setImage(C.data);
break;
case e.ComponentType.StatusBar:e.statusBarViewer.setImage(C.data);
if(e.ViewersInvisible){k();
}break;
case e.ComponentType.TxDialog:var B=new CustomEvent("txDialogImageReceived",{detail:C});
document.dispatchEvent(B);
break;
}};
e.imageRegionsUpdatedHandler=function(A){var C=A.detail;
switch(C.target){case e.ComponentType.TextView:e.textViewer.requestUpdateImageRegions(C.tiles);
break;
case e.ComponentType.HorRuler:e.horRulerViewer.updateImageRegions(C.tiles);
break;
case e.ComponentType.VertRuler:e.vertRulerViewer.updateImageRegions(C.tiles);
break;
case e.ComponentType.StatusBar:e.statusBarViewer.updateImageRegions(C.tiles);
if(e.ViewersInvisible){k();
}break;
case e.ComponentType.TxDialog:var B=new CustomEvent("txDialogImageRegionsUpdated",{detail:C});
document.dispatchEvent(B);
break;
}};
e.viewContentScrolledHandler=function(A){var B=A.detail;
switch(B.target){case e.ComponentType.TextView:e.textViewer.requestScroll(B.delta,B.images);
break;
}};
e.textViewLocationChangedHandler=function(A){e.viewLocation=A.detail;
v();
};
e.textViewCaretStateChangedHandler=function(A){var B=A.detail;
e.textViewer.setCaretState(B.caretState);
};
function i(){e.textViewSizeInTwips=q({Width:e.textViewer.width,Height:e.textViewer.height});
c=e.isSocketConnected()&&(e.documentSize.Width>e.textViewSizeInTwips.Width);
h=e.isSocketConnected()&&(e.documentSize.Height>e.textViewSizeInTwips.Height);
var C=g?e.VertRulerWidth:0;
var D=b?e.ribbonBarHeight+e.HorRulerHeight:e.ribbonBarHeight;
var B=e.clientSize.Width-(h?e.ScrollbarWidth:0)-C;
var A=e.clientSize.Height-(c?e.ScrollbarWidth:0)-(f?e.StatusBarHeight:0)-D;
e.textViewSizeInTwips=q({Width:B,Height:A});
if((e.textViewer.left!=C)||(e.textViewer.top!=D)||(e.textViewer.width!=B)||(e.textViewer.height!=A)){e.textViewer.bufferContent();
e.textViewer.left=C;
e.textViewer.top=D;
if(e.isSocketConnected()){e.textViewer.width=B;
e.textViewer.height=A;
}e.textViewer.drawBufferedContent();
if(b){e.horRulerViewer.bufferContent();
e.horRulerViewer.top=e.ribbonBarHeight;
if(e.isSocketConnected()){e.horRulerViewer.width=B+(g?e.VertRulerWidth:0)+(h?e.ScrollbarWidth:0);
e.horRulerViewer.height=e.HorRulerHeight;
}e.horRulerViewer.drawBufferedContent();
}if(g){e.vertRulerViewer.bufferContent();
e.vertRulerViewer.top=D;
if(e.isSocketConnected()){e.vertRulerViewer.width=e.VertRulerWidth;
e.vertRulerViewer.height=A+(c?e.ScrollbarWidth:0);
}e.vertRulerViewer.drawBufferedContent();
}if(f){e.statusBarViewer.bufferContent();
e.statusBarViewer.top=e.ribbonBarHeight+A+(b?e.HorRulerHeight:0)+(c?e.ScrollbarWidth:0);
if(e.isSocketConnected()){e.statusBarViewer.width=e.clientSize.Width;
e.statusBarViewer.height=e.StatusBarHeight;
}e.statusBarViewer.drawBufferedContent();
}}z();
u();
v();
}function z(){var D={location:{X:e.textViewer.left,Y:e.textViewer.top-e.ribbonBarHeight},size:{Width:e.textViewer.width,Height:e.textViewer.height}};
var B={visible:b,location:{X:0,Y:e.horRulerViewer.top-e.ribbonBarHeight},size:{Width:e.horRulerViewer.width,Height:e.horRulerViewer.height}};
var E={visible:g,location:{X:0,Y:e.vertRulerViewer.top-e.ribbonBarHeight},size:{Width:e.vertRulerViewer.width,Height:e.vertRulerViewer.height}};
var C={visible:f,location:{X:0,Y:e.statusBarViewer.top-e.ribbonBarHeight},size:{Width:e.statusBarViewer.width,Height:e.statusBarViewer.height}};
var A={textViewerInfo:D,horRulerInfo:B,vertRulerInfo:E,statusBarInfo:C};
e.sendCommand(e.Command.WindowResized,0,0,0,A);
}e.showHorizontalRuler=function(show){if(typeof show==="undefined"){show=true;
}show=!!show;
if(b==show){return;
}b=show;
if(show){e.horRulerViewer.show();
}else{e.horRulerViewer.hide();
}i();
e.textViewer.refreshCaretLocation();
var A=document.getElementById("chkRulerHor");
if(A){A.checked=show;
}};
e.showVerticalRuler=function(show){if(typeof show==="undefined"){show=true;
}show=!!show;
if(g==show){return;
}g=show;
if(show){e.vertRulerViewer.show();
}else{e.vertRulerViewer.hide();
}i();
e.textViewer.refreshCaretLocation();
var A=document.getElementById("chkRulerVert");
if(A){A.checked=show;
}};
e.showStatusBar=function(show){if(typeof show==="undefined"){show=true;
}show=!!show;
if(f==show){return;
}f=show;
if(show){e.statusBarViewer.show();
}else{e.statusBarViewer.hide();
}i();
e.textViewer.refreshCaretLocation();
var A=document.getElementById("chkStatusBar");
if(A){A.checked=show;
}};
function j(){e.textViewer.blur();
e.horRulerViewer.blur();
e.vertRulerViewer.blur();
e.statusBarViewer.blur();
if(e.txDialog){e.txDialog.blur();
}}e.adaptViewToContainerSize=function(){var A=document.getElementById("txTemplateDesignerContainer").parentElement;
var C,B;
if(A.tagName=="BODY"){C=window.innerWidth;
B=window.innerHeight;
}else{C=A.offsetWidth;
B=A.offsetHeight;
}if((e.isTouchDevice)&&((B-e.clientSize.Height)>20)){j();
}e.clientSize={Width:C,Height:B};
i();
e.updateRibbonTabContentOffset();
e.updateRibbonScrollArrows();
e.updateRibbonHideButtonPos();
e.adaptRibbonTabWidths(A);
};
function r(B){var A=null;
B=B||0;
a("#zoomDropDown div.ribbon-button-checkmark").removeClass("ribbon-button-selected");
switch(B){case 25:A=a("#tglBtnZoom_25");
break;
case 50:A=a("#tglBtnZoom_50");
break;
case 75:A=a("#tglBtnZoom_75");
break;
case 100:A=a("#tglBtnZoom_100");
break;
case 150:A=a("#tglBtnZoom_150");
break;
case 200:A=a("#tglBtnZoom_200");
break;
case 400:A=a("#tglBtnZoom_400");
break;
}if(A){A.addClass("ribbon-button-selected");
}}e.twips2mm=function(A){return A/1440*25.4;
};
e.mm2twips=function(A){return A/25.4*1440;
};
e.twips2px=function(B,C,A){C=C||100;
A=A||96;
return(B*A*C/144000);
};
e.px2twips=function(B,C,A){C=C||100;
A=A||96;
return Math.round(B*144000/(A*C));
};
function q(B,A){return{Width:e.px2twips(B.Width,A||e.zoom,e.DefRes),Height:e.px2twips(B.Height,A||e.zoom,e.DefRes)};
}e.pointPixelToTwips=function(B,A){return{X:e.px2twips(B.X,A||e.zoom,e.DefRes),Y:e.px2twips(B.Y,A||e.zoom,e.DefRes)};
};
return s;
}(TXTextControl||{},j$1_10_2));
this.__extends=this.__extends||function(c,d){for(var b in d){if(d.hasOwnProperty(b)){c[b]=d[b];
}}function a(){this.constructor=c;
}a.prototype=d.prototype;
c.prototype=new a();
};
var TXTextControl=(function(c,a){var b=c._private=c._private||{};
b.FieldType={MergeField:0,IfField:1,IncludeTextField:2,DateField:3,NextField:4,NextIfField:5,};
b.FieldDisplayMode={ShowFieldText:0,ShowFieldCodes:1,};
b.RelationalOperator=Object.freeze({Equals:0,NotEqual:1,LessThan:2,GreaterThan:3,GreaterThanOrEqualTo:4,LessThanOrEqualTo:5});
b.FieldAdapter=(function(){function d(preserveFormatting){this.preserveFormatting=!!preserveFormatting;
}return d;
})();
b.IfField=(function(d){__extends(e,d);
function e(){d.call(this,true);
this.expression1="";
this.expression2="";
this.trueText="";
this.falseText="";
this.operator=b.RelationalOperator.Equals;
}e.prototype.toUpperCamelCase=function(){return{Expression1:this.expression1,Expression2:this.expression2,TrueText:this.trueText,FalseText:this.falseText,Operator:this.operator,PreserveFormatting:this.preserveFormatting};
};
return e;
})(b.FieldAdapter);
b.NextIfField=(function(d){__extends(e,d);
function e(){d.call(this,true);
this.expression1="";
this.expression2="";
this.operator=b.RelationalOperator.Equals;
}e.prototype.toUpperCamelCase=function(){return{Expression1:this.expression1,Expression2:this.expression2,Operator:this.operator,PreserveFormatting:this.preserveFormatting};
};
return e;
})(b.FieldAdapter);
b.NextField=(function(d){__extends(e,d);
function e(){d.call(this,true);
}e.prototype.toUpperCamelCase=function(){return{};
};
return e;
})(b.FieldAdapter);
b.DateField=(function(d){__extends(e,d);
function e(format){d.call(this,true);
this.format=format||"";
}e.prototype.toUpperCamelCase=function(){return{Format:this.format,PreserveFormatting:this.preserveFormatting};
};
return e;
})(b.FieldAdapter);
b.showFieldPropsDialogHandler=function(){if(b.currentFieldData){b.showFieldDialog(b.currentFieldData.fieldAdapter,b.currentFieldData.mergeFieldType);
}};
b.showFieldDialog=function(e,f,g){var d;
switch(f){case b.FieldType.MergeField:d=new b.MergeFieldDialog(e,g);
break;
case b.FieldType.IfField:d=new b.IfFieldDialog(e,g);
break;
case b.FieldType.DateField:d=new b.DateFieldDialog(e,g);
break;
case b.FieldType.IncludeTextField:d=new b.IncludeTextFieldDialog(e,g);
break;
case b.FieldType.NextIfField:d=new b.NextIfFieldDialog(e,g);
break;
}if(d){d.showModal();
}};
b.selectMasterTable=function(d){b.sendCommand(b.Command.SelectMasterTable,0,0,0,d);
};
return c;
}(TXTextControl||{},j$1_10_2));
var TXTextControl=(function(l,a){var b=l._private=l._private||{};
var c;
b.lastMouseUpEvent=null;
var f={TextSelection:1,TextInputPosition:2,Header:4,NoHeader:8,Footer:16,NoFooter:32,PageMargin:64,PageNumberField:128,SelectedFrame:256,Table:512,TextField:1024,MisspelledWord:2048};
var d="txMenu_";
b.initContextMenus=function(){c=a("#txContextMenu").menu().hide();
c.on("menuselect",i);
};
function h(n){var p=[];
var o=1;
for(var m=0;
m<32;
++m){switch(n&o){case f.Footer:p.push("Footer");
break;
case f.Header:p.push("Header");
break;
case f.MisspelledWord:p.push("MisspelledWord");
break;
case f.NoFooter:p.push("NoFooter");
break;
case f.NoHeader:p.push("NoHeader");
break;
case f.PageMargin:p.push("PageMargin");
break;
case f.PageNumberField:p.push("PageNumberField");
break;
case f.SelectedFrame:p.push("SelectedFrame");
break;
case f.Table:p.push("Table");
break;
case f.TextField:p.push("TextField");
break;
case f.TextInputPosition:p.push("TextInputPosition");
break;
case f.TextSelection:p.push("TextSelection");
break;
}o<<=1;
}return p;
}function j(n,q){var p=d.length;
for(var o=0;
o<n.classList.length;
++o){var m=n.classList[o];
if(m.substring(0,p)===d){n.classList.remove(m);
}}q.forEach(function(r){n.classList.add(d+r);
});
}b.contextMenuDataReceivedHandler=function(m){var r=m.detail;
var q=r.menuItems;
var p=h(r.contextMenuLocation);
var n=document.getElementById("txContextMenu");
e(q,n);
var o=a("#txContextMenu");
o.menu("refresh");
b.calcMenuWidths(n);
j(n,p);
k(b.lastMouseUpEvent);
};
function e(o,m){var n;
var p=false;
m.innerHTML="";
o.forEach(function(v){if(!v.Text){p=true;
return;
}var s=document.createElement("li");
s.dataset.itemId=v.ID;
if(!v.Enabled){s.classList.add("txui-state-disabled");
}m.appendChild(s);
var q=document.createElement("a");
if(p){q.style.borderTop="1px solid lightgray";
p=false;
}s.appendChild(q);
var r=document.createElement("div");
r.classList.add("small-menu-item-image-wrapper");
if(v.ImageDataURL){n=document.createElement("img");
n.src=v.ImageDataURL;
r.appendChild(n);
}else{if(v.Checked){n=document.createElement("img");
n.src=b.imageResources.small.checkmark;
r.appendChild(n);
r.classList.add("ribbon-button");
r.classList.add("ribbon-button-selected");
}}q.appendChild(r);
r=document.createElement("div");
r.classList.add("small-menu-item-caption-container");
q.appendChild(r);
var t=document.createElement("p");
t.textContent=v.Text;
r.appendChild(t);
if(v.Items.length){var u=document.createElement("ul");
u.classList.add("dropDownMenu");
u.classList.add("contextMenu");
s.appendChild(u);
e(v.Items,u);
}});
}function i(o,q){var n=q.item.context;
var m=n.dataset.itemId;
if(m){var p=parseInt(m,10);
b.sendCommand(b.Command.ContextMenuItemClicked,p);
}}b.isInsideElementWithID=function(m,n){if(!m){return false;
}else{if(m.parentElement&&(m.parentElement.id===n)){return true;
}else{return b.isInsideElementWithID(m.parentElement,n);
}}};
function g(m,n){if(!m){return null;
}else{if(m.parentElement&&(m.parentElement.tagName===n)){return m.parentElement;
}else{return g(m.parentElement,n);
}}}b.isPartOfMenuItemWithSubMenu=function(m){var n=g(m,"LI");
if(n&&n.classList.contains("txui-menu-item")){return(n.querySelectorAll("ul").length>0);
}return false;
};
function k(m){b.fileMenu.hide();
b.hideAllMenus_homeTab();
c.show().position({my:"left top",at:"left bottom",of:m,});
a(document).on("click",function(n){if(!(b.isInsideElementWithID(n.target,"txContextMenu")&&b.isPartOfMenuItemWithSubMenu(n.target))){c.hide();
a(document).off(n);
}});
}return l;
}(TXTextControl||{},j$1_10_2));
var TXTextControl=(function(i,a){var c=i._private=i._private||{};
var d={RTF:"text/rtf",HTML:"text/html",Plain:"text/plain"};
c.ClipboardDataType=Object.freeze({None:0,RTF:1,HTML:2,Plain:3,File:4,fromValue:function(j){switch(j){case this.RTF:return d.RTF;
case this.HTML:return d.HTML;
case this.Plain:return d.Plain;
}return"";
},toValue:function(j){switch(j){case d.RTF:return this.RTF;
case d.HTML:return this.HTML;
case d.Plain:return this.Plain;
}return this.None;
}});
c.ClipboardMode=Object.freeze({Client:1,Server:2});
c.clipboardMode=c.ClipboardMode.Client;
var h={Start:0,Data:1,End:2};
var b={id:"",data:"",chunksExpected:0,chunksReceived:0,isEmptySelection:false,start:function(j){this.id=j.id;
this.data="";
this.chunksReceived=0;
this.isEmptySelection=j.isEmptySelection;
},progress:function(j){this.chunksExpected=j.chunks;
},reset:function(){this.id="";
this.data="";
this.chunksExpected=0;
this.chunksReceived=0;
}};
function g(m,l,j){var p="";
var o=false;
var q=m.types;
j=j||false;
var k=[].some.call(q,function(r){return r==="Files";
});
if(m.types){if(!o&&[].some.call(q,function(r){return r===d.RTF;
})){p=m.getData(d.RTF);
if(p.length>0){c.pasteText(p,c.ClipboardDataType.RTF,j);
o=true;
}}if(!o&&[].some.call(q,function(r){return r===d.HTML;
})){p=m.getData(d.HTML);
if(p.length>0){c.pasteText(p,c.ClipboardDataType.HTML,j);
o=true;
}}if(l&&!o&&[].some.call(q,function(r){return r===d.Plain;
})){p=m.getData(d.Plain);
if(p.length>0){c.pasteText(p,c.ClipboardDataType.Plain,j);
o=true;
}}if(l&&!o){p=m.getData("Text");
if(p&&(p.length>0)){c.pasteText(p,c.ClipboardDataType.Plain,j);
o=true;
}}}if(!o&&m.files&&m.files.length){f(m.files[0],j);
o=true;
}if(!o&&m.items&&k){var n=[].find.call(m.items,function(r){return r.kind==="file";
});
if(n){e(n,j);
o=true;
}}return o;
}c.handleClientPaste=function(k,j){if(typeof j=="undefined"){j=true;
}if(k&&k.clipboardData){if(g(k.clipboardData,j)){k.stopPropagation();
k.preventDefault();
return false;
}}return true;
};
c.handleDrop=function(j){j.stopPropagation();
j.preventDefault();
if(j&&j.dataTransfer){g(j.dataTransfer,true,true);
}};
function e(l,j){var k=l.getAsFile();
f(k,j);
}c.FileDroppedEventArgs=(function(){function j(fileBlob,k){this.fileName=fileBlob.name;
this.fileType=fileBlob.type;
this.cancel=!!k;
}return j;
})();
function f(l,k){if(!c.txProperties.canEdit){return;
}var j=new c.FileDroppedEventArgs(l,false);
c.fireEvent(c.EventName.fileDropped,j);
if(j.cancel){return;
}var m=l.name;
var o=l.type;
var n=new FileReader();
n.onload=function(q){var r={dataB64:q.target.result,fileName:m};
var p=function(){c.sendCommand(c.Command.ClientPaste,c.ClipboardDataType.File,0,0,r);
};
if(c.documentDirty&&(o.substring(0,5)!=="image")){c.fileSaveQuestion(p);
}else{p();
}};
n.readAsDataURL(l);
}c.TextDroppedEventArgs=(function(){function j(cancel,text,textType){this.cancel=cancel;
this.text=text;
this.textType=textType;
}return j;
})();
c.TextPastedEventArgs=(function(){function j(cancel,text,textType){this.cancel=cancel;
this.text=text;
this.textType=textType;
}return j;
})();
c.pasteText=function(m,n,k){var j,l=c.ClipboardDataType.fromValue(n);
if(k){j=new c.TextDroppedEventArgs(false,m,l);
c.fireEvent(c.EventName.textDropped,j);
}else{j=new c.TextPastedEventArgs(false,m,l);
c.fireEvent(c.EventName.textPasted,j);
}m=""+j.text;
n=c.ClipboardDataType.toValue(j.textType);
if(!j.cancel){c.sendCommand(c.Command.ClientPaste,n,0,0,m);
}};
c.ClipboardModeChangedEventArgs=(function(){function j(clipboardMode){this.clipboardMode=clipboardMode;
}return j;
})();
c.setClipboardMode=function(k){c.clipboardMode=k;
var l=document.getElementById("tglBtnLocalClipboard");
if(l){switch(k){case c.ClipboardMode.Client:l.classList.add("ribbon-button-selected");
break;
case c.ClipboardMode.Server:l.classList.remove("ribbon-button-selected");
break;
}}var j=new c.ClipboardModeChangedEventArgs(k);
c.fireEvent(c.EventName.clipboardModeChanged,j);
};
c.ClipboardTransferStartEventArgs=(function(){function j(id){this.id=id;
}return j;
})();
c.ClipboardTransferProgressEventArgs=(function(){function j(id,progress){this.id=id;
this.progress=progress;
}return j;
})();
c.ClipboardTransferCompleteEventArgs=(function(){function j(id){this.id=id;
}return j;
})();
c.ClipboardTransferAbortedEventArgs=(function(){function j(id){this.id=id;
}return j;
})();
c.processSelectionHTMLContentMessage=function(k){var j;
if(!c.textViewer){return;
}switch(k.msgType){case h.Start:if(b.id){j=new c.ClipboardTransferAbortedEventArgs(b.id);
c.fireEvent(c.EventName.clipboardDataTransferAborted,j);
}b.start(k);
if(!k.isEmptySelection){j=new c.ClipboardTransferStartEventArgs(k.id);
c.fireEvent(c.EventName.clipboardDataTransferStart,j);
}break;
case h.Data:if(k.id!==b.id){break;
}b.data+=k.data;
b.progress(k);
++b.chunksReceived;
if(!b.isEmptySelection){j=new c.ClipboardTransferProgressEventArgs(k.id,(k.number/k.chunks)*100);
c.fireEvent(c.EventName.clipboardDataTransferProgress,j);
}break;
case h.End:var l=b.isEmptySelection;
if((k.id!==b.id)||(b.chunksReceived!=b.chunksExpected)){break;
}c.textViewer.setHiddenTextFieldText(b.data);
b.reset();
c.textViewer.selectHiddenTextfieldContent();
if(!l){j=new c.ClipboardTransferCompleteEventArgs(k.id);
c.fireEvent(c.EventName.clipboardDataTransferComplete,j);
}break;
}};
return i;
}(TXTextControl||{},j$1_10_2));
var TXTextControl=(function(c,a){var b=c._private=c._private||{};
b.EventName={ribbonTabsLoaded:"ribbonTabsLoaded",textFieldEntered:"textFieldEntered",textFieldLeft:"textFieldLeft",textFieldClicked:"textFieldClicked",textDropped:"textDropped",fileDropped:"fileDropped",textPasted:"textPasted",documentLoaded:"documentLoaded",webSocketClosed:"webSocketClosed",textControlLoaded:"textControlLoaded",ribbonTabIndexChanged:"ribbonTabIndexChanged",subTextPartEntered:"subTextPartEntered",subTextPartLeft:"subTextPartLeft",subTextPartClicked:"subTextPartClicked",subTextPartDoubleClicked:"subTextPartDoubleClicked",hyperlinkClicked:"hyperlinkClicked",textControlChanged:"textControlChanged",inputPositionChanged:"inputPositionChanged",clipboardDataTransferStart:"clipboardDataTransferStart",clipboardDataTransferProgress:"clipboardDataTransferProgress",clipboardDataTransferComplete:"clipboardDataTransferComplete",clipboardDataTransferAborted:"clipboardDataTransferAborted",textViewLocationChanged:"textViewLocationChanged",zoomFactorChanged:"zoomFactorChanged",clipboardModeChanged:"clipboardModeChanged"};
b.SubTextPartEventType={Entered:0,Left:1,Clicked:2,DoubleClicked:3};
b.eventListeners={};
c.addEventListener=function(eventName,callback){if(!eventName){throw new Error("Wrong number of parameters.");
}if(typeof eventName!=="string"){throw new TypeError('Parameter "eventName" must be of type "string".');
}if(!callback){throw new Error("Wrong number of parameters.");
}if(typeof callback!=="function"){throw new TypeError('Parameter "callback" must be of type "function".');
}b.eventListeners[eventName]=b.eventListeners[eventName]||[];
var e=b.eventListeners[eventName];
var d=e.indexOf(callback);
if(d==-1){e.push(callback);
}};
c.removeEventListener=function(eventName,callback){if(!eventName){throw new Error("Wrong number of parameters.");
}if(typeof eventName!=="string"){throw new TypeError('Parameter "eventName" must be of type "string".');
}if(!callback){throw new Error("Wrong number of parameters.");
}if(typeof callback!=="function"){throw new TypeError('Parameter "callback" must be of type "function".');
}if(!b.eventListeners.hasOwnProperty(eventName)){return;
}var g=b.eventListeners[eventName];
try{var f=g.indexOf(callback);
if(f>-1){g.splice(f,1);
if(g.length==0){delete b.eventListeners[eventName];
}}}catch(d){}};
b.fireEvent=function(h,g){if(!b.eventListeners.hasOwnProperty(h)){return;
}var k=b.eventListeners[h];
for(var j=0;
j<k.length;
++j){var d=k[j];
try{d(g);
}catch(f){}}};
b.textFieldDataReceivedHandler=function(f){var g=f.detail.item;
var i=f.detail.mouseClick;
var h=b.currentFieldData.textField;
if(g){if(!h||i||(g.fieldName!==h.fieldName)||(g.fieldType!==h.fieldType)||((g.typeName&&h.typeName)&&(g.typeName!==h.typeName))){if(h&&!i){b.fireEvent(b.EventName.textFieldLeft);
}var d=cloneObject(g);
if(i){b.fireEvent(b.EventName.textFieldClicked,d);
}else{b.fireEvent(b.EventName.textFieldEntered,d);
}}}else{if(h){b.fireEvent(b.EventName.textFieldLeft);
}}b.currentFieldData.textField=g;
};
return c;
}(TXTextControl||{},j$1_10_2));
(function(a){if(a.MutationObserver){return;
}function c(d){return window.ShadowDOMPolyfill&&window.ShadowDOMPolyfill.wrapIfNeeded(d)||d;
}function b(d){this._callback=d;
}b.prototype={observe:function(e,d){e=c(e);
if(!d.childList&&!d.attributes&&!d.characterData||d.attributeOldValue&&!d.attributes||d.attributeFilter&&d.attributeFilter.length&&!d.attributes||d.characterDataOldValue&&!d.characterData){throw new SyntaxError();
}}};
a.MutationObserver=b;
})(this);
var TXTextControl=(function(c,a){var b=c._private=c._private||{};
b.HTMLDialog=(function(){function d(){this.dialogData={dialogResult:false};
this.resourcesReceivedHandlerBound=this.resourcesReceivedHandler.bind(this);
this.loadedBound=this.loaded.bind(this);
this.dialogContainerID="dialogContainer"+randomIntFromInterval(10000,99999);
this.isDialogReady=false;
this.closeRequested=false;
}d.prototype.OKHandler=function(e){this.dialogData.dialogResult=true;
this.close(e);
};
d.prototype.close=function(e){if(!this.isDialogReady){this.closeRequested=true;
return;
}this.closing();
b.sendCommand(b.Command.DialogResult,this.DialogInfo.DialogType,0,0,this.dialogData);
a(e).dialog("destroy").remove();
a("#"+this.dialogContainerID).remove();
if(!b.isTouchDevice){b.textViewer.focus();
}};
d.prototype.loaded=function(){document.addEventListener("dialogResourcesReceived",this.resourcesReceivedHandlerBound);
b.sendCommand(b.Command.GetDialogResources,this.DialogInfo.DialogType);
};
d.prototype.resourcesReceivedHandler=function(f){if(f.detail.dialogType==this.DialogInfo.DialogType){this.dialogize(f.detail.stringResources);
document.removeEventListener("dialogResourcesReceived",this.resourcesReceivedHandlerBound);
}};
d.prototype.dialogize=function(f){var e=this;
this.caption=f[this.DialogInfo.TitleResourceName];
a("#"+this.DialogInfo.ElementID).dialog({modal:true,resizable:this.DialogInfo.Resizable||false,width:this.DialogInfo.Width||"auto",height:this.DialogInfo.Height||"auto",dialogClass:this.DialogInfo.DialogClass||"",title:e.caption,buttons:this.DialogInfo.Buttons||{OK:{text:"OK",click:function(){e.OKHandler(this);
},id:"btnOK_"+this.dialogContainerID},Cancel:{text:"Cancel",click:function(){e.close(this);
},id:"btnCancel_"+this.dialogContainerID}},close:function(){e.close(this);
},}).keypress(function(g){if(g.keyCode==a.ui.keyCode.ENTER){e.OKHandler(this);
return false;
}});
this.applyStringResources(f);
this.dialogReady(this);
this.isDialogReady=true;
if(this.closeRequested){this.close(a("#"+this.DialogInfo.ElementID));
}};
d.prototype.setDefaultBtnTexts=function(j){var i;
var g=document.getElementById("btnOK_"+this.dialogContainerID);
if(g&&j.hasOwnProperty("BTN_OK")){i=g.querySelector("span.txui-button-text");
i.textContent=j.BTN_OK;
}var e=document.getElementById("btnCancel_"+this.dialogContainerID);
if(e&&j.hasOwnProperty("BTN_CANCEL")){i=e.querySelector("span.txui-button-text");
i.textContent=j.BTN_CANCEL;
}var h=document.getElementById("btnYes_"+this.dialogContainerID);
if(h&&j.hasOwnProperty("BTN_YES")){i=h.querySelector("span.txui-button-text");
i.textContent=j.BTN_YES;
}var f=document.getElementById("btnNo_"+this.dialogContainerID);
if(f&&j.hasOwnProperty("BTN_NO")){i=f.querySelector("span.txui-button-text");
i.textContent=j.BTN_NO;
}};
d.prototype.showModal=function(){var f=document.getElementById("txTemplateDesignerContainer"),g=document.createElement("div");
g.id=this.dialogContainerID;
f.appendChild(g);
var h=b.getTXFileDir();
var e=a("#"+this.dialogContainerID);
e.load(h+this.DialogInfo.FileName,this.loadedBound);
};
d.prototype.applyStringResources=function(e){};
d.prototype.dialogReady=function(e){};
d.prototype.closing=function(){};
return d;
})();
return c;
}(TXTextControl||{},j$1_10_2));
this.__extends=this.__extends||function(c,d){for(var b in d){if(d.hasOwnProperty(b)){c[b]=d[b];
}}function a(){this.constructor=c;
}a.prototype=d.prototype;
c.prototype=new a();
};
var TXTextControl=(function(c,a){var b=c._private=c._private||{};
b.HyperlinkDialog=(function(d){__extends(e,d);
function e(){d.call(this);
this.DialogInfo={DialogType:b.HTMLDialogType.HyperlinkDialog,ElementID:"hyperlinkDialog",FileName:"Dialogs/HyperlinkDialog.html",TitleResourceName:"HYPLNK_DIALOG_CAPTION",};
}e.prototype.docTargetsReceivedHandler=function(f){var h=f.detail.targets,g=a("#selTarget");
g.empty();
h.forEach(function(j){var i=document.createElement("option");
i.text=j.TargetName;
g.append(i);
});
};
e.prototype.txItemReceivedHandler=function(f){var h=f.detail.itemType,g=f.detail.item;
if(g===null){return;
}switch(h){case b.ItemType.HypertextLink:a("#txtLinkedText").val(g.Text);
a("#txtLinkTarget").val(g.Target);
break;
case b.ItemType.DocumentLink:a("#txtLinkedText").val(g.Text);
a("#txtLinkTarget").val("#"+g.TargetName);
break;
}};
e.prototype.OKHandler=function(f){var g=a("#txtLinkedText").val(),h=a("#txtLinkTarget").val();
if((g.length>0)&&(h.length>0)){b.sendCommand(b.Command.InsertItem,b.ItemType.HypertextLink,0,0,{linkedText:g,linkTarget:h});
}this.close(f);
};
e.prototype.closing=function(f){document.removeEventListener("documentTargetsReceived",this.docTargetsReceivedHandler);
document.removeEventListener("txItemReceived",this.txItemReceivedHandler);
};
e.prototype.dialogReady=function(){document.addEventListener("documentTargetsReceived",this.docTargetsReceivedHandler);
document.addEventListener("txItemReceived",this.txItemReceivedHandler);
b.sendCommand(b.Command.GetDocumentTargets);
b.sendCommand(b.Command.GetItem,b.ItemType.Link);
a("#selTarget").change(function(){var f=a(this).val();
a("#txtLinkTarget").val("#"+f);
});
};
e.prototype.applyStringResources=function(f){a("#HYPLNK_DIALOG_LBL_LINKED_TEXT").text(f.HYPLNK_DIALOG_LBL_LINKED_TEXT);
a("#HYPLNK_DIALOG_GROUP_BOX > legend").text(f.HYPLNK_DIALOG_GROUP_BOX);
a("#HYPLNK_DIALOG_LBL_LINK_TGT").text(f.HYPLNK_DIALOG_LBL_LINK_TGT);
a("#HYPLNK_DIALOG_LBL_SEL_TGT").text(f.HYPLNK_DIALOG_LBL_SEL_TGT);
this.setDefaultBtnTexts(f);
};
return e;
})(b.HTMLDialog);
return c;
}(TXTextControl||{},j$1_10_2));
var TXTextControl=(function(c,a){var b=c._private=c._private||{};
b.InputBoxDialog=(function(){function d(i,h,g,f){this.title=i;
this.text=h||"";
this.label=g||null;
this.isPasswordBox=f||false;
this.callback=null;
this.dialogResult=false;
this.loadedBound=this.loaded.bind(this);
this.dialogContainerID="dialogContainer"+randomIntFromInterval(10000,99999);
}d.prototype.OKHandler=function(f){this.text=a("#txtInputBox").val();
this.dialogResult=true;
this.close(f);
};
d.prototype.close=function(g){if(this.callback){if(this.dialogResult){this.callback(this.text);
}}else{var f={text:this.text,dialogResult:this.dialogResult};
b.sendCommand(b.Command.DialogResult,b.HTMLDialogType.InputBoxDialog,0,0,f);
}a(g).dialog("destroy").remove();
a("#"+this.dialogContainerID).remove();
if(!b.isTouchDevice){b.textViewer.focus();
}};
d.prototype.init=function(g){var i=document.getElementById("txtInputBox");
i.value=this.text;
if(this.isPasswordBox){i.type="password";
}if(this.label){var h=document.getElementById("lblInputoxDialog");
var f=document.getElementById("inputBoxDialog");
h.style.display="";
h.innerHTML=this.label;
f.style.height=(f.clientHeight+h.clientHeight+5)+"px";
}};
function e(i){var g=document.getElementById("btnOK_"+i.dialogContainerID);
var h=g.querySelector("span.txui-button-text");
h.textContent=b.variousMessages.defaultButtonTexts.btnOK;
var f=document.getElementById("btnCancel_"+i.dialogContainerID);
h=f.querySelector("span.txui-button-text");
h.textContent=b.variousMessages.defaultButtonTexts.btnCancel;
}d.prototype.loaded=function(){var f=this;
a("#inputBoxDialog").dialog({modal:true,resizable:false,width:"auto",height:110,title:this.title||"Input Box",buttons:{OK:{text:"OK",click:function(){f.OKHandler(this);
},id:"btnOK_"+this.dialogContainerID},Cancel:{text:"Cancel",click:function(){f.close(this);
},id:"btnCancel_"+this.dialogContainerID}},close:function(){f.close(this);
},open:function(){f.init(this);
},}).keypress(function(g){if(g.keyCode==a.ui.keyCode.ENTER){f.OKHandler(this);
return false;
}});
e(this);
};
d.prototype.showModal=function(f){this.callback=f;
var h=document.getElementById("txTemplateDesignerContainer"),i=document.createElement("div");
i.id=this.dialogContainerID;
h.appendChild(i);
var j=b.getTXFileDir();
var g=a("#"+this.dialogContainerID);
g.load(j+"Dialogs/InputBoxDialog.html",this.loadedBound);
};
return d;
})();
return c;
}(TXTextControl||{},j$1_10_2));
var TXTextControl=(function(c,a){var b=c._private=c._private||{};
b.LoadDictionaryDialog=(function(d){__extends(g,d);
function g(h){d.call(this);
this.DialogInfo={DialogType:b.HTMLDialogType.LoadDictionaryDialog,ElementID:"loadDictionaryDialog",FileName:"Dialogs/LoadDictionaryDialog.html",TitleResourceName:"LOAD_DICT_DIALOG_TITLE"};
this.availableDicts=h.AvailableDicts;
this.loadedDicts=h.LoadedDicts;
}function f(n){var m=[];
var j=document.querySelectorAll("#loadDictionaryDialog input[type=checkbox]");
for(var l=0;
l<j.length;
++l){var h=j[l];
if(!h.disabled&&h.checked){var k=h.dataset.dictName;
m.push(k);
}}return m;
}g.prototype.closing=function(){if(this.dialogData.dialogResult){this.dialogData.selected=f(this);
}};
function e(h,q){var m=document.getElementById("dictNameCheckBoxContanier");
m.innerHTML="";
for(var p=0;
p<h.length;
++p){var l=h[p];
var k="chkDictName"+p;
var n=document.createElement("input");
n.id=k;
n.setAttribute("type","checkbox");
n.dataset.dictName=l;
n.title=l;
n.style.cssFloat="left";
n.style.clear="left";
var j=q.some(function(i){return(l===i);
});
if(j){n.checked=true;
n.disabled=true;
}m.appendChild(n);
var o=document.createElement("label");
o.setAttribute("for",k);
o.textContent=l;
o.title=l;
o.style.cssFloat="left";
m.appendChild(o);
}}g.prototype.dialogReady=function(h){e(h.availableDicts,h.loadedDicts);
};
g.prototype.applyStringResources=function(h){this.setDefaultBtnTexts(h);
};
return g;
})(b.HTMLDialog);
return c;
}(TXTextControl||{},j$1_10_2));
var TXTextControl=(function(c,a){var b=c._private=c._private||{};
b.LoadThesaurusDialog=(function(d){__extends(g,d);
function g(h){d.call(this);
this.DialogInfo={DialogType:b.HTMLDialogType.LoadThesaurusDialog,ElementID:"loadThesaurusDialog",FileName:"Dialogs/LoadThesaurusDialog.html",TitleResourceName:"LOAD_THESAURUS_DIALOG_TITLE"};
this.availableThesauri=h.availableThesauri;
this.loadedThesauri=h.loadedThesauri;
}function f(m){var l=[];
var j=document.querySelectorAll("#loadThesaurusDialog input[type=checkbox]");
for(var k=0;
k<j.length;
++k){var h=j[k];
if(!h.disabled&&h.checked){var n=h.dataset.thesaurusName;
l.push(n);
}}return l;
}g.prototype.closing=function(){if(this.dialogData.dialogResult){this.dialogData.selected=f(this);
}};
function e(h,o){var q=document.getElementById("thesaurusNameCheckBoxContanier");
q.innerHTML="";
for(var n=0;
n<h.length;
++n){var p=h[n];
var k="chkThesaurusName"+n;
var l=document.createElement("input");
l.id=k;
l.setAttribute("type","checkbox");
l.dataset.thesaurusName=p;
l.title=p;
l.style.cssFloat="left";
l.style.clear="left";
var j=o.some(function(i){return(p===i);
});
if(j){l.checked=true;
l.disabled=true;
}q.appendChild(l);
var m=document.createElement("label");
m.setAttribute("for",k);
m.textContent=p;
m.title=p;
m.style.cssFloat="left";
q.appendChild(m);
}}g.prototype.dialogReady=function(h){e(h.availableThesauri,h.loadedThesauri);
};
g.prototype.applyStringResources=function(h){this.setDefaultBtnTexts(h);
};
return g;
})(b.HTMLDialog);
return c;
}(TXTextControl||{},j$1_10_2));
var TXTextControl=(function(c,a){var b=c._private=c._private||{};
b.TXStreamType=Object.freeze({HTMLFormat:4,RichTextFormat:8,PlainText:16,InternalUnicodeFormat:32,MSWord:64,AdobePDF:512,WordprocessingML:1024});
var d={BMP:1,PNG:2,GIF:3,JPG:4,WMF:5,EMF:6,TIF:7};
b.DataBaseType=Object.freeze({XML:1,JSON:2});
b.OpenFileDialog=(function(e){__extends(r,e);
function r(v,w){e.call(this);
this.DialogInfo={DialogType:b.HTMLDialogType.OpenFileDialog,ElementID:"openFileDialog",FileName:"Dialogs/OpenFileDialog.html",TitleResourceName:"OPEN_FILE_DIALOG_TITLE"};
this.command=v||b.Command.OpenFile;
this.fileType=w||b.FileType.Document;
this.subFileType=-1;
this.imageDataURLs={dir:"",file:""};
this.altTexts={fileName:"",dirName:""};
this.dirNames=[];
this.fileNames=[];
this.fileFilters=[];
this.fileFilterAll="";
this.fileListReceivedHandlerBound=this.fileListReceivedHandler.bind(this);
this.fileTypeChangeHandlerBound=this.fileTypeChangeHandler.bind(this);
this.fileNameChangeHandlerBound=this.fileNameChangeHandler.bind(this);
}r.prototype.closing=function(){var x=this;
document.removeEventListener("fileListReceived",this.fileListReceivedHandlerBound);
if(this.dialogData.dialogResult){var y=document.getElementById("txOFDTxtFileName");
var w=y.value;
if(w&&(w!=="")){b.sendCommand(this.command,this.fileType,v(),0,w);
}}function v(){return(x.fileType==b.FileType.DataBase)?x.subFileType:0;
}};
function j(v){while(v&&v.tagName!=="TR"){v=v.parentElement;
}return v;
}function q(w,v){w.dialogData.dialogResult=true;
w.close(a("#"+w.DialogInfo.ElementID));
}function p(v){var w=document.getElementById("txOFDTxtFileName");
w.value="";
b.sendCommand(b.Command.OpenDirectory,0,0,0,v);
}function l(v){switch(v){case d.BMP:return["bmp"];
case d.EMF:return["emf"];
case d.GIF:return["gif"];
case d.JPG:return["jpg","jpeg"];
case d.PNG:return["png"];
case d.TIF:return["tif"];
case d.WMF:return["wmf"];
}return[];
}function f(v){switch(v){case b.DataBaseType.XML:return["xml"];
case b.DataBaseType.JSON:return["json"];
}return[];
}function u(v){switch(v){case b.TXStreamType.MSWord:return["doc"];
case b.TXStreamType.WordprocessingML:return["docx"];
case b.TXStreamType.HTMLFormat:return["htm","html"];
case b.TXStreamType.AdobePDF:return["pdf"];
case b.TXStreamType.RichTextFormat:return["rtf"];
case b.TXStreamType.InternalUnicodeFormat:return["tx"];
case b.TXStreamType.PlainText:return["txt"];
}return[];
}function h(w,v){if(!w||!w.length){return v;
}var x=[];
v.forEach(function(z){var y=z.split(".").pop().toLowerCase();
if(w.some(function(A){return A===y;
})){x.push(z);
}});
return x;
}function i(v,w){if(w==0){return[];
}switch(v){case b.FileType.Document:return u(w);
case b.FileType.Image:return l(w);
case b.FileType.DataBase:return f(w);
}}function m(v){if(!v){return false;
}return v.classList.contains("txOFDItemTypeDir");
}function o(v){if(!v){return false;
}return v.classList.contains("txOFDItemTypeFile");
}function t(z){var A=document.getElementById("txOFDTblFilesAndFolders");
var D=document.getElementById("txOFDSelFileType");
for(var y=A.children.length-1;
y>=0;
--y){var v=A.children[y];
if(v.tagName==="TR"){A.removeChild(v);
}}z.subFileType=parseInt(D.value,10);
var x=i(z.fileType,z.subFileType);
var w=h(x,z.fileNames);
z.dirNames.forEach(function(E){var I=document.createElement("TR");
var G=document.createElement("TD");
var H=document.createElement("TD");
var F=document.createElement("IMG");
I.classList.add("txOFDItemTypeDir");
F.alt=z.altTexts.dirName;
F.src=z.imageDataURLs.dir;
H.textContent=E;
G.appendChild(F);
I.appendChild(G);
I.appendChild(H);
A.appendChild(I);
});
w.forEach(function(I){var H=document.createElement("TR");
var F=document.createElement("TD");
var G=document.createElement("TD");
var E=document.createElement("IMG");
H.classList.add("txOFDItemTypeFile");
E.alt=z.altTexts.fileName;
E.src=z.imageDataURLs.file;
G.textContent=I;
F.appendChild(E);
H.appendChild(F);
H.appendChild(G);
A.appendChild(H);
});
function B(F){var E=document.getElementById("btnOK_"+z.dialogContainerID);
var H=j(F.target);
if(H){a("#txOFDTblFilesAndFolders tr.selected").removeClass("selected");
H.classList.add("selected");
var I=document.getElementById("txOFDTxtFileName");
var G=H.children[1];
if(o(H)){g(E,true);
I.value=G.textContent;
}else{if(m(H)){g(E,true);
I.value="";
}}}}function C(F){var E=document.getElementById("btnOK_"+z.dialogContainerID);
var H=j(F.target);
if(H){var G=H.children[1];
if(m(H)){g(E,false);
p(G.textContent);
}else{if(o(H)){q(z,G.textContent);
}}}}a("#txOFDTblFilesAndFolders tr").click(B);
a("#txOFDTblFilesAndFolders tr").dblclick(C);
}function s(y){var z=document.getElementById("txOFDSelFileType");
var v=document.createElement("OPTION");
v.value="0";
v.textContent=y.fileFilterAll;
v.selected=true;
z.appendChild(v);
for(var x=0;
x<y.fileFilters.length;
++x){var w=y.fileFilters[x];
v=document.createElement("OPTION");
v.value=w.FileType;
v.textContent=w.Text;
z.appendChild(v);
}}r.prototype.fileTypeChangeHandler=function(w){var v=document.getElementById("btnOK_"+this.dialogContainerID);
var x=document.getElementById("txOFDTxtFileName");
g(v,false);
x.value="";
t(this);
};
function g(v,w){if(w){v.removeAttribute("disabled");
v.classList.remove("txui-state-disabled");
}else{v.setAttribute("disabled","disabled");
v.classList.add("txui-state-disabled");
}}function k(){return document.querySelector("#txOFDTblFilesAndFolders tr.selected");
}function n(){var v=k();
return(v&&m(v));
}r.prototype.fileNameChangeHandler=function(w){a("#txOFDTblFilesAndFolders tr.selected").removeClass("selected");
var v=document.getElementById("btnOK_"+this.dialogContainerID);
var x=document.getElementById("txOFDTxtFileName");
if(x.value.length||n()){g(v,true);
}else{g(v,false);
}};
r.prototype.fileListReceivedHandler=function(v){this.fileNames=v.detail.fileNames;
this.dirNames=v.detail.dirNames;
t(this);
};
r.prototype.OKHandler=function(w){if(n()){var x=document.querySelector("#txOFDTblFilesAndFolders tr.selected").children[1];
var v=document.getElementById("btnOK_"+this.dialogContainerID);
g(v,false);
p(x.textContent);
}else{this.dialogData.dialogResult=true;
this.close(w);
}};
r.prototype.dialogReady=function(w){document.addEventListener("fileListReceived",this.fileListReceivedHandlerBound);
b.sendCommand(b.Command.GetFileList,this.fileType);
var y=document.getElementById("txOFDTxtFileName");
y.value="";
var v=document.getElementById("btnOK_"+this.dialogContainerID);
g(v,false);
var x=document.getElementById("txOFDSelFileType");
x.addEventListener("change",this.fileTypeChangeHandlerBound);
y.addEventListener("change",this.fileNameChangeHandlerBound);
y.addEventListener("input",this.fileNameChangeHandlerBound);
};
r.prototype.applyStringResources=function(v){a("#OPEN_FILE_DIALOG_LBL_FILENAME").text(v.OPEN_FILE_DIALOG_LBL_FILENAME);
a("#OPEN_FILE_DIALOG_LBL_FILETYPE").text(v.OPEN_FILE_DIALOG_LBL_FILETYPE);
this.imageDataURLs.dir=v.ImageDataURLs.Dir;
this.altTexts.fileName=v.OPEN_FILE_DIALOG_ALT_TXT_FILE_NAME;
this.altTexts.dirName=v.OPEN_FILE_DIALOG_ALT_TXT_DIR_NAME;
this.setDefaultBtnTexts(v);
this.fileFilterAll=v.FileTypes.All;
switch(this.fileType){case b.FileType.Document:this.fileFilters=v.FileTypes.Document;
this.imageDataURLs.file=v.ImageDataURLs.Document;
break;
case b.FileType.Image:this.fileFilters=v.FileTypes.Image;
this.imageDataURLs.file=v.ImageDataURLs.Image;
break;
case b.FileType.DataBase:this.fileFilters=v.FileTypes.DataBase;
this.imageDataURLs.file=v.ImageDataURLs.DataBase;
break;
}s(this);
};
return r;
})(b.HTMLDialog);
return c;
}(TXTextControl||{},j$1_10_2));
var TXTextControl=(function(c,a){var b=c._private=c._private||{};
b.WaitDialog=(function(d){__extends(e,d);
function e(g,f){d.call(this);
this.DialogInfo={DialogType:b.HTMLDialogType.WaitDialog,ElementID:"waitDialog",Width:"auto",Height:100,FileName:"Dialogs/WaitDialog.html",TitleResourceName:"WAIT_DLG_TITLE",DialogClass:"no-close",Buttons:{},};
this.title=g;
this.message=f;
}e.prototype.loaded=function(){var f={WAIT_DLG_LABEL_MESSAGE:this.message,WAIT_DLG_TITLE:this.title};
this.dialogize(f);
};
e.prototype.applyStringResources=function(f){a("#WAIT_DLG_LABEL_MESSAGE").text(f.WAIT_DLG_LABEL_MESSAGE);
};
e.prototype.dialogReady=function(){var g=a("#waitDialog"),h=g.css("margin-left"),f={width:g.css("border-left-width"),color:g.css("border-left-color"),style:g.css("border-left-style")};
g.css("border-bottom-width",f.width);
g.css("border-bottom-color",f.color);
g.css("border-bottom-style",f.style);
g.css("margin-bottom",h);
};
return e;
})(b.HTMLDialog);
return c;
}(TXTextControl||{},j$1_10_2));
var TXTextControl=(function(f,a){var b=f._private=f._private||{},g={None:0,CreateFile:8192,OverwriteFile:16384,Inline:32768},c={AllowAuthoring:1,AllowAuthoringFields:2,AllowContentAccessibility:4,AllowDocumentAssembly:8,AllowExtractContents:16,AllowGeneralEditing:32,AllowHighLevelPrinting:64,AllowLowLevelPrinting:128,AllowAll:255,},e={Disabled:-1,All:0,OnlyCorrect:1},d={Disabled:-1,All:0,OnlyAtBegin:1,OnlyWhenBeginIsUpper:2};
b.OptionsDialog=(function(h){__extends(k,h);
function k(o){h.call(this);
this.DialogInfo={DialogType:b.HTMLDialogType.OptionsDialog,ElementID:"optionsDialog",Width:540,Height:350,FileName:"Dialogs/OptionsDialog.html",TitleResourceName:"OPTIONS_DIALOG_TITLE"};
this.options=o;
this.errorMessages={permPwdEmpty:"",samePwd:"",docPwdEmpty:""};
}b.arrayBufferToB64=function(p){var o=[],q=new Uint8Array(p),t=q.byteLength;
for(var r=0;
r<t;
r++){o.push(String.fromCharCode(q[r]));
}var s=o.join("");
return window.btoa(s);
};
k.prototype.OKHandler=function(p){var o=document.getElementById("chkUserPassword"),q=document.getElementById("txtUserPassword");
if(o.checked&&(q.value.length==0)){b.jQueryAlert(this.caption,this.errorMessages.docPwdEmpty);
return;
}this.dialogData.dialogResult=true;
this.close(p);
};
function j(){var r=document.getElementById("chkIgnoreUpper"),v=document.getElementById("selIgnoreUpper"),p=document.getElementById("chkIgnoreCntNums"),t=document.getElementById("chkIgnoreURLs"),q=document.getElementById("chkIgnoreEmails"),o=document.getElementById("chkFlagRepeatedWords"),s=document.getElementById("chkIgnoreUpperAndLower"),w=document.getElementById("selIgnoreUpperLower");
var u={ignoreUpperCaseWords:e.All,ignoreContNums:true,ignoreURLs:true,ignoreEmails:true,flagRepeated:true,ignoreAll:d.OnlyWhenBeginIsUpper};
if(!r.checked){u.ignoreUpperCaseWords=e.Disabled;
}else{u.ignoreUpperCaseWords=v.selectedIndex;
}u.ignoreContNums=p.checked;
u.ignoreURLs=t.checked;
u.ignoreEmails=q.checked;
u.flagRepeated=o.checked;
if(!s.checked){u.ignoreAll=d.Disabled;
}else{u.ignoreAll=w.selectedIndex;
}return u;
}k.prototype.close=function(p){var o={dialogResult:this.dialogData.dialogResult};
if(this.dialogData.dialogResult){o.cssSaveMode=i();
o.reqPDFDocPwd=document.getElementById("chkUserPassword").checked;
o.pdfDocPwd=document.getElementById("txtUserPassword").value;
o.pdfa=document.getElementById("chkEnPDFAExp").checked;
o.hyphEnabled=document.getElementById("chkEnableHyphenation").checked;
o.langDetectEnabled=document.getElementById("chkEnableLangDetect").checked;
o.spellCheckEnabled=document.getElementById("chkEnableSpellCheck").checked;
o.pfxFilePassword=document.getElementById("txtPDFCertPwd").value;
if(this.options.IsTXSpellAssemblyPresent){o.spellChecking=j();
}var r=document.getElementById("txtPDFCertFile"),q=r.files;
if(q.length){var t=this,s=new FileReader();
s.onloadend=function(){var u=b.arrayBufferToB64(s.result);
o.pfxFile=u;
b.sendCommand(b.Command.DialogResult,t.DialogInfo.DialogType,0,0,o);
};
s.readAsArrayBuffer(q[0]);
}else{b.sendCommand(b.Command.DialogResult,this.DialogInfo.DialogType,0,0,o);
}}else{b.sendCommand(b.Command.DialogResult,this.DialogInfo.DialogType,0,0,o);
}a(p).dialog("destroy").remove();
a("#"+this.dialogContainerID).remove();
if(!b.isTouchDevice){b.textViewer.focus();
}};
function i(){if(document.getElementById("rbCSSOptsNoStSh").checked){return g.None;
}else{if(document.getElementById("rbCSSOptsInlStSh").checked){return g.Inline;
}}}function l(o){switch(o.CssSaveMode){case g.None:document.getElementById("rbCSSOptsNoStSh").checked=true;
break;
case g.Inline:document.getElementById("rbCSSOptsInlStSh").checked=true;
break;
}}function m(w){var r=document.getElementById("chkIgnoreUpper"),u=document.getElementById("selIgnoreUpper"),p=document.getElementById("chkIgnoreCntNums"),t=document.getElementById("chkIgnoreURLs"),q=document.getElementById("chkIgnoreEmails"),o=document.getElementById("chkFlagRepeatedWords"),s=document.getElementById("chkIgnoreUpperAndLower"),v=document.getElementById("selIgnoreUpperLower");
r.checked=true;
switch(w.IgnoreUpperCaseWords){case e.Disabled:r.checked=false;
u.disabled=true;
break;
default:u.selectedIndex=w.IgnoreUpperCaseWords;
break;
}p.checked=w.IgnoreContainingNumbers;
t.checked=w.IgnoreURLs;
q.checked=w.IgnoreEmailAddresses;
o.checked=w.FlagRepeatedWords;
s.checked=true;
switch(w.IgnoreAll){case d.Disabled:s.checked=false;
v.disabled=true;
break;
default:v.selectedIndex=w.IgnoreAll;
break;
}}function n(t){var u=document.getElementById("txtPDFCertPwd"),s=document.getElementById("chkUserPassword"),v=document.getElementById("txtUserPassword"),r=document.getElementById("chkEnPDFAExp"),o=document.getElementById("chkEnableHyphenation"),p=document.getElementById("chkEnableLangDetect"),q=document.getElementById("chkEnableSpellCheck");
l(t);
u.value=t.PDFCertFilePwd;
s.checked=t.RequireUserPwd;
v.disabled=!t.RequireUserPwd;
v.value=t.PDFUserPwd;
r.checked=t.PDFA;
if(t.IsTXSpellAssemblyPresent){o.checked=t.IsHyphenationEnabled;
p.checked=t.IsLanguageDetectionEnabled;
q.checked=t.IsSpellCheckingEnabled;
if(t.IsSpellCheckingEnabled){m(t.SpellCheckSettings);
}else{a("#optionsDialogTabs").tabs("option","disabled",[4]);
}}else{a("#optionsDialogTabs").tabs("option","disabled",[3,4]);
}}k.prototype.dialogReady=function(u){a("#optionsDialogTabs").tabs();
n(u.options);
function s(v){var w=document.getElementById("txtUserPassword");
w.disabled=!this.checked;
}var t=document.getElementById("chkUserPassword");
t.addEventListener("click",s);
function r(v){var w=document.getElementById("selIgnoreUpper");
w.disabled=!this.checked;
}var o=document.getElementById("chkIgnoreUpper");
o.addEventListener("click",r);
function q(v){var w=document.getElementById("selIgnoreUpperLower");
w.disabled=!this.checked;
}var p=document.getElementById("chkIgnoreUpperAndLower");
p.addEventListener("click",q);
};
k.prototype.applyStringResources=function(o){a("#OPTIONS_DIALOG_TAB_HTML").text(o.OPTIONS_DIALOG_TAB_HTML);
a("#OPTIONS_DIALOG_TAB_PDF_SEC").text(o.OPTIONS_DIALOG_TAB_PDF_SEC);
a("#OPTIONS_DIALOG_TAB_PDF_EXP").text(o.OPTIONS_DIALOG_TAB_PDF_EXP);
a("#OPTIONS_DIALOG_GRP_STYLESH_SAV_OPTS > legend").text(o.OPTIONS_DIALOG_GRP_STYLESH_SAV_OPTS);
a("#OPTIONS_DIALOG_LBL_CSS_OPTS_NO_STSH").text(o.OPTIONS_DIALOG_LBL_CSS_OPTS_NO_STSH);
a("#OPTIONS_DIALOG_LBL_CSS_OPTS_INL_STSH").text(o.OPTIONS_DIALOG_LBL_CSS_OPTS_INL_STSH);
a("#OPTIONS_DIALOG_GRP_PDF_DIG_SIG > legend").text(o.OPTIONS_DIALOG_GRP_PDF_DIG_SIG);
a("#OPTIONS_DIALOG_GRP_PDF_PWD > legend").text(o.OPTIONS_DIALOG_GRP_PDF_PWD);
a("#OPTIONS_DIALOG_LBL_PDF_CERT_FILE").text(o.OPTIONS_DIALOG_LBL_PDF_CERT_FILE);
a("#OPTIONS_DIALOG_LBL_PDF_CERT_PWD").text(o.OPTIONS_DIALOG_LBL_PDF_CERT_PWD);
a("#OPTIONS_DIALOG_LBL_PDF_REQ_PWD").text(o.OPTIONS_DIALOG_LBL_PDF_REQ_PWD);
a("#OPTIONS_DIALOG_LBL_PDF_DOC_PWD").text(o.OPTIONS_DIALOG_LBL_PDF_DOC_PWD);
a("#OPTIONS_DIALOG_GRP_PDF_EXP_OPTS > legend").text(o.OPTIONS_DIALOG_GRP_PDF_EXP_OPTS);
a("#OPTIONS_DIALOG_CHK_EN_PDFA").text(o.OPTIONS_DIALOG_CHK_EN_PDFA);
a("#OPTIONS_DIALOG_TAB_PROOFING").text(o.OPTIONS_DIALOG_TAB_PROOFING);
a("#OPTIONS_DIALOG_GRP_PROOF_OPTS > legend").text(o.OPTIONS_DIALOG_GRP_PROOF_OPTS);
a("#OPTIONS_DIALOG_LBL_PROOF_SPELL_CHECK").text(o.OPTIONS_DIALOG_LBL_PROOF_SPELL_CHECK);
a("#OPTIONS_DIALOG_LBL_PROOF_HYPHEN").text(o.OPTIONS_DIALOG_LBL_PROOF_HYPHEN);
a("#OPTIONS_DIALOG_LBL_PROOF_LANGDETECT").text(o.OPTIONS_DIALOG_LBL_PROOF_LANGDETECT);
a("#OPTIONS_DIALOG_TAB_SPELL_CHECK").text(o.OPTIONS_DIALOG_TAB_SPELL_CHECK);
this.setDefaultBtnTexts(o);
if(o.TXSpell){a("#LBL_IGNORE_UPPERCASE").text(o.TXSpell.LBL_IGNORE_UPPERCASE);
a("#ITM_UPPERCASE_ALL").text(o.TXSpell.ITM_UPPERCASE_ALL);
a("#ITM_UPPERCASE_ONLY_CORRECT").text(o.TXSpell.ITM_UPPERCASE_ONLY_CORRECT);
a("#LBL_IGNORE_WORD_WITH_NUMBERS").text(o.TXSpell.LBL_IGNORE_WORD_WITH_NUMBERS);
a("#LBL_IGNORE_INTERNET_ADDRESSES").text(o.TXSpell.LBL_IGNORE_INTERNET_ADDRESSES);
a("#LBL_IGNORE_EMAIL_ADDRESSES").text(o.TXSpell.LBL_IGNORE_EMAIL_ADDRESSES);
a("#LBL_FLAG_REPEATED_WORDS").text(o.TXSpell.LBL_FLAG_REPEATED_WORDS);
a("#LBL_IGNORE_CASE").text(o.TXSpell.LBL_IGNORE_CASE);
a("#ITM_CASE_ALL").text(o.TXSpell.ITM_CASE_ALL);
a("#ITM_CASE_WORD_BEGIN_ALWAYS").text(o.TXSpell.ITM_CASE_WORD_BEGIN_ALWAYS);
a("#ITM_CASE_WORD_BEGIN_IS_UPPER").text(o.TXSpell.ITM_CASE_WORD_BEGIN_IS_UPPER);
}this.errorMessages.docPwdEmpty=o.OPTIONS_DIALOG_DOC_PWD_EMPTY_ERROR;
this.errorMessages.permPwdEmpty=o.OPTIONS_DIALOG_PERM_PWD_EMPTY_ERROR;
this.errorMessages.samePwd=o.OPTIONS_DIALOG_SAME_PWD_ERROR;
};
return k;
})(b.HTMLDialog);
return f;
}(TXTextControl||{},j$1_10_2));
var TXTextControl=(function(c,a){var b=c._private=c._private||{};
b.SaveDocumentAsDialog=(function(d){__extends(f,d);
function f(g,h){d.call(this);
this.DialogInfo={DialogType:b.HTMLDialogType.SaveDocumentAsDialog,ElementID:"saveDocumentAsDialog",Width:280,FileName:"Dialogs/SaveDocumentAsDialog.html",TitleResourceName:"SAVEDOCAS_DIALOG_TITLE"};
this.fileName=g;
this.streamType=h;
this.errorMessages={fileNameEmpty:""};
}f.prototype.OKHandler=function(g){var h=document.getElementById("txtSaveDocAsFilename").value;
if(a.trim(h)==""){b.jQueryAlert(this.caption,this.errorMessages.fileNameEmpty);
return;
}this.dialogData.dialogResult=true;
this.close(g);
};
function e(){var g=document.getElementById("selSaveAsDocType");
var h=g.options[g.selectedIndex].value;
return parseInt(h,10);
}f.prototype.closing=function(g){if(this.dialogData.dialogResult){this.dialogData.fileName=document.getElementById("txtSaveDocAsFilename").value;
this.dialogData.streamType=e();
}};
f.prototype.dialogReady=function(g){var h=document.getElementById("txtSaveDocAsFilename");
h.value=g.fileName;
a("#selSaveAsDocType").val(""+g.streamType);
};
f.prototype.applyStringResources=function(g){a("#SAVEDOCAS_DIALOG_LBL_FILENAME").text(g.SAVEDOCAS_DIALOG_LBL_FILENAME);
a("#SAVEDOCAS_DIALOG_LBL_DOC_TYPE").text(g.SAVEDOCAS_DIALOG_LBL_DOC_TYPE);
this.errorMessages.fileNameEmpty=g.SAVEDOCAS_DIALOG_FILE_NAME_EMPTY_ERROR;
this.setDefaultBtnTexts(g);
};
return f;
})(b.HTMLDialog);
return c;
}(TXTextControl||{},j$1_10_2));
var TXTextControl=(function(c,a){var b=c._private=c._private||{};
b.FontStyle=Object.freeze({Regular:0,Bold:1,Italic:2,Underline:4,Strikeout:8});
b.FontDialog=(function(d){__extends(e,d);
function e(f){d.call(this);
this.DialogInfo={DialogType:b.HTMLDialogType.FontDialog,ElementID:"txFontDialog",FileName:"Dialogs/FontDialog.html",TitleResourceName:"FONT_DLG_TITLE",};
this.state=f;
}e.prototype.OKHandler=function(f){this.dialogData.dialogResult=true;
this.close(f);
};
e.prototype.close=function(g){var f={state:{fontName:this.state.fontName,fontSize:this.state.fontSize,fontStyle:this.state.fontStyle},dialogResult:this.dialogData.dialogResult};
b.sendCommand(b.Command.DialogResult,b.HTMLDialogType.FontDialog,0,0,f);
a(g).dialog("destroy").remove();
a("#"+this.dialogContainerID).remove();
if(!b.isTouchDevice){b.textViewer.focus();
}};
e.prototype.dialogReady=function(){var s=this,q,l;
var t=document.getElementById("selTxFntDlgNames");
this.state.fontNames.forEach(f);
var y=this.state.fontSizes;
if(y.indexOf(this.state.fontSize)===-1){y.push(this.state.fontSize);
y.sort(function(z,A){return z-A;
});
}var v=document.getElementById("selTxFntDlgSizes");
y.forEach(g);
var p=document.getElementById("FONT_DLG_STYLE_REGULAR");
p.value=b.FontStyle.Regular;
var o=document.getElementById("FONT_DLG_STYLE_ITALIC");
o.value=b.FontStyle.Italic;
var m=document.getElementById("FONT_DLG_STYLE_BOLD");
m.value=b.FontStyle.Bold;
var n=document.getElementById("FONT_DLG_STYLE_BOLD_ITALIC");
n.value=(b.FontStyle.Bold|b.FontStyle.Italic);
r(this.state.fontStyle);
var h=document.getElementById("chkTxFntDlgStrikeThrough");
var j=document.getElementById("chkTxFntDlgUnderline");
h.checked=!!(this.state.fontStyle&b.FontStyle.Strikeout);
j.checked=!!(this.state.fontStyle&b.FontStyle.Underline);
t.addEventListener("change",u);
v.addEventListener("change",w);
document.getElementById("selTxFntDlgStyles").addEventListener("change",x);
h.addEventListener("change",i);
j.addEventListener("change",k);
function f(z){l=document.createElement("option");
t.appendChild(l);
l.value=l.text=z;
if(z===s.state.fontName){l.selected=true;
}}function g(z){l=document.createElement("option");
v.appendChild(l);
l.value=l.text=z;
if(z===s.state.fontSize){l.selected=true;
}}function r(z){switch(z&3){case b.FontStyle.Italic:o.selected=true;
break;
case b.FontStyle.Bold:m.selected=true;
break;
case (b.FontStyle.Italic|b.FontStyle.Bold):n.selected=true;
break;
case b.FontStyle.Regular:default:p.selected=true;
break;
}}function u(z){s.state.fontName=t.value;
}function w(z){s.state.fontSize=parseInt(v.value,10);
}function x(z){var A=z.target;
s.state.fontStyle&=~3;
s.state.fontStyle|=parseInt(A.value,10);
}function i(z){if(h.checked){s.state.fontStyle|=b.FontStyle.Strikeout;
}else{s.state.fontStyle&=~b.FontStyle.Strikeout;
}}function k(z){if(j.checked){s.state.fontStyle|=b.FontStyle.Underline;
}else{s.state.fontStyle&=~b.FontStyle.Underline;
}}};
e.prototype.applyStringResources=function(f){a("#FONT_DLG_LBL_FONT").text(f.FONT_DLG_LBL_FONT);
a("#FONT_DLG_LBL_SIZE").text(f.FONT_DLG_LBL_SIZE);
a("#FONT_DLG_LBL_STYLE").text(f.FONT_DLG_LBL_STYLE);
a("#FONT_DLG_GRP_EFFECTS > legend").text(f.FONT_DLG_GRP_EFFECTS);
a("#FONT_DLG_STRIKEOUT").text(f.FONT_DLG_STRIKEOUT);
a("#FONT_DLG_STYLE_BOLD").text(f.FONT_DLG_STYLE_BOLD);
a("#FONT_DLG_STYLE_ITALIC").text(f.FONT_DLG_STYLE_ITALIC);
a("#FONT_DLG_STYLE_BOLD_ITALIC").text(f.FONT_DLG_STYLE_BOLD_ITALIC);
a("#FONT_DLG_STYLE_REGULAR").text(f.FONT_DLG_STYLE_REGULAR);
a("#FONT_DLG_UNDERLINE").text(f.FONT_DLG_UNDERLINE);
this.setDefaultBtnTexts(f);
};
return e;
})(b.HTMLDialog);
return c;
}(TXTextControl||{},j$1_10_2));
var TXTextControl=(function(d,a){var b=d._private=d._private||{};
var c="http://www.w3.org/2000/svg";
b.ThesaurusDialogCommand={};
b.ThesaurusDialog=(function(e){__extends(o,e);
function o(p){e.call(this);
this.DialogInfo={DialogType:b.HTMLDialogType.ThesaurusDialog,ElementID:"thesaurusDialog",FileName:"Dialogs/ThesaurusDialog.html",TitleResourceName:"THESAURUS_DLG_TITLE"};
this.dialogStateUpdatedHandlerBound=this.dialogStateUpdatedHandler.bind(this);
this.state=p;
this.noAltText="";
this.lastSelectedSynonym=null;
}o.prototype.applyDialogState=function(M){var L=this;
var y,G,I,J,O,D,B,E,C,A,x,z,H;
var v=document.getElementById("thesaurusDialog_cbLanguage");
var R=document.getElementById("thesaurusDialog_txtFindSynonymsFor");
var r=document.getElementById("thesaurusDialog_btnBack");
var Q=document.getElementById("thesaurusDialog_tvSynonyms");
var u=document.querySelector("#btnOK_"+this.dialogContainerID+" span.txui-button-text");
var t=document.getElementById("btnOK_"+this.dialogContainerID);
if(M.languages){M.languages.forEach(q);
}if(M.findSynonymsFor){R.value=M.findSynonymsFor;
}if(M.backButton){r.disabled=!M.backButton.Enabled;
}if(M.insertButton){S(M.insertButton);
}if(M.synonyms){T(M.synonyms);
}if(M.selectedLanguage){K(M.selectedLanguage);
}function q(s){y=document.createElement("option");
v.appendChild(y);
y.value=y.text=s.text;
}function S(s){if(s.Text){u.textContent=s.Text;
}F(s.Enabled);
}function F(s){t.disabled=!s;
if(s){t.classList.remove("txui-state-disabled");
}else{t.classList.add("txui-state-disabled");
}}function K(s){v.value=s;
}function T(U){var s=(document.activeElement==Q);
L.lastSelectedSynonym=null;
Q.innerHTML="";
if(U.length==0){D=document.createElement("tr");
Q.appendChild(D);
B=document.createElement("td");
D.appendChild(B);
z=document.createElement("p");
B.appendChild(z);
z.classList.add("noAltText");
z.textContent=L.noAltText;
F(false);
return;
}for(G=0;
G<U.length;
++G){J=U[G];
O=""+(G+1)+". "+J.text;
D=document.createElement("tr");
D.dataset.collapsed="false";
H=J.items[0];
D.dataset.word=H.word;
D.dataset.text=H.text;
Q.appendChild(D);
D.classList.add("treeNode");
D.addEventListener("dblclick",function(V){P(V.currentTarget);
});
D.addEventListener("click",function(V){m();
V.currentTarget.classList.add("selected");
});
B=document.createElement("td");
D.appendChild(B);
B.appendChild(i());
B.addEventListener("click",w);
B=document.createElement("td");
D.appendChild(B);
z=document.createElement("p");
B.appendChild(z);
z.textContent=O;
E=document.createElement("tr");
Q.appendChild(E);
E.classList.add("treeNodeItemContainer");
C=document.createElement("td");
E.appendChild(C);
C.colSpan=2;
x=document.createElement("div");
C.appendChild(x);
x.classList.add("thesaurusDialog_itemsWrapper");
A=document.createElement("table");
x.appendChild(A);
A.classList.add("thesaurusDialog_tblItems");
A.classList.add("unselectable");
p(A,J.items,U.length);
x.style.height=x.clientHeight+"px";
x.dataset.height=x.clientHeight;
}F(true);
if(s){Q.blur();
Q.focus();
}}function N(s){var U=s.currentTarget;
b.sendCommand(b.Command.ThesaurusDialogCommand,b.ThesaurusDialogCommand.SelectedNodeChanged,0,0,{word:U.dataset.word,text:U.dataset.text});
}function p(s,U,V){for(I=0;
I<U.length;
++I){H=U[I];
D=document.createElement("tr");
s.appendChild(D);
D.classList.add("treeNodeItem");
D.dataset.word=H.word;
D.dataset.text=H.text;
D.addEventListener("dblclick",N);
D.addEventListener("click",function(W){m();
W.currentTarget.classList.add("selected");
});
B=document.createElement("td");
D.appendChild(B);
if(G<(V-1)){B.appendChild(l());
}else{B.appendChild(g());
}B=document.createElement("td");
D.appendChild(B);
if(I<(U.length-1)){B.appendChild(k());
}else{B.appendChild(h());
}B=document.createElement("td");
D.appendChild(B);
z=document.createElement("p");
B.appendChild(z);
z.textContent=H.text;
}}function P(s){if(s.dataset.collapsed==="true"){n(s);
}else{f(s);
}}function w(s){var U=s.currentTarget.parentElement;
P(U);
}};
function f(s){if(!s.classList.contains("treeNode")){throw new Error("Only tree nodes can be collapsed.");
}var q=s.cells[0];
var t=s.nextSibling;
var r=t.cells[0];
var p=r.children[0];
p.style.height="0px";
s.dataset.collapsed="true";
q.innerHTML="";
q.appendChild(j());
}function n(s){if(!s.classList.contains("treeNode")){throw new Error("Only tree nodes can be expanded.");
}var q=s.cells[0];
var t=s.nextSibling;
var r=t.cells[0];
var p=r.children[0];
p.style.height=p.dataset.height+"px";
s.dataset.collapsed="false";
q.innerHTML="";
q.appendChild(i());
}o.prototype.dialogStateUpdatedHandler=function(p){this.applyDialogState(p.detail);
};
function m(){var p=document.querySelectorAll("#thesaurusDialog_tvSynonyms tr");
[].forEach.call(p,function(q){q.classList.remove("selected");
});
}function i(){var p=document.createElementNS(c,"svg");
p.setAttributeNS(null,"width","16");
p.setAttributeNS(null,"height","16");
var r=document.createElementNS(c,"rect");
r.setAttributeNS(null,"x","4");
r.setAttributeNS(null,"y","4");
r.setAttributeNS(null,"height","8");
r.setAttributeNS(null,"width","8");
r.setAttributeNS(null,"fill","none");
r.setAttributeNS(null,"stroke","gray");
p.appendChild(r);
var q=document.createElementNS(c,"line");
q.setAttributeNS(null,"x1","6");
q.setAttributeNS(null,"y1","8");
q.setAttributeNS(null,"x2","10");
q.setAttributeNS(null,"y2","8");
q.setAttributeNS(null,"stroke","gray");
p.appendChild(q);
return p;
}function j(){var p=i();
var q=document.createElementNS(c,"line");
q.setAttributeNS(null,"x1","8");
q.setAttributeNS(null,"y1","6");
q.setAttributeNS(null,"x2","8");
q.setAttributeNS(null,"y2","10");
q.setAttributeNS(null,"stroke","gray");
p.appendChild(q);
return p;
}function l(){var p=document.createElementNS(c,"svg");
p.setAttributeNS(null,"width","16");
p.setAttributeNS(null,"height","18");
var q=document.createElementNS(c,"line");
q.setAttributeNS(null,"x1","8");
q.setAttributeNS(null,"y1","0");
q.setAttributeNS(null,"x2","8");
q.setAttributeNS(null,"y2","18");
q.setAttributeNS(null,"stroke","gray");
q.setAttributeNS(null,"stroke-dasharray","1, 1");
p.appendChild(q);
return p;
}function k(){var p=document.createElementNS(c,"svg");
p.setAttributeNS(null,"width","16");
p.setAttributeNS(null,"height","18");
var q=document.createElementNS(c,"line");
q.setAttributeNS(null,"x1","8");
q.setAttributeNS(null,"y1","0");
q.setAttributeNS(null,"x2","8");
q.setAttributeNS(null,"y2","18");
q.setAttributeNS(null,"stroke","gray");
q.setAttributeNS(null,"stroke-dasharray","1, 1");
p.appendChild(q);
q=document.createElementNS(c,"line");
q.setAttributeNS(null,"x1","8");
q.setAttributeNS(null,"y1","8");
q.setAttributeNS(null,"x2","16");
q.setAttributeNS(null,"y2","8");
q.setAttributeNS(null,"stroke","gray");
q.setAttributeNS(null,"stroke-dasharray","1, 1");
p.appendChild(q);
return p;
}function g(){var p=document.createElementNS(c,"svg");
p.setAttributeNS(null,"width","16");
p.setAttributeNS(null,"height","18");
return p;
}function h(){var p=document.createElementNS(c,"svg");
p.setAttributeNS(null,"width","16");
p.setAttributeNS(null,"height","18");
var q=document.createElementNS(c,"line");
q.setAttributeNS(null,"x1","8");
q.setAttributeNS(null,"y1","0");
q.setAttributeNS(null,"x2","8");
q.setAttributeNS(null,"y2","8");
q.setAttributeNS(null,"stroke","gray");
q.setAttributeNS(null,"stroke-dasharray","1, 1");
p.appendChild(q);
q=document.createElementNS(c,"line");
q.setAttributeNS(null,"x1","8");
q.setAttributeNS(null,"y1","8");
q.setAttributeNS(null,"x2","16");
q.setAttributeNS(null,"y2","8");
q.setAttributeNS(null,"stroke","gray");
q.setAttributeNS(null,"stroke-dasharray","1, 1");
p.appendChild(q);
return p;
}o.prototype.OKHandler=function(p){this.dialogData.dialogResult=true;
this.close(p);
};
o.prototype.getSelectedSynonym=function(){var p=document.getElementById("thesaurusDialog_tvSynonyms");
var q=p.querySelector("tr.selected");
if(!q&&this.lastSelectedSynonym){return this.lastSelectedSynonym;
}if(!q&&p.rows.length){q=p.rows[0];
}if(!q){return null;
}return{word:q.dataset.word,text:q.dataset.text};
};
o.prototype.close=function(q){var p={state:{selectedElement:this.getSelectedSynonym()},dialogResult:this.dialogData.dialogResult};
b.sendCommand(b.Command.DialogResult,b.HTMLDialogType.ThesaurusDialog,0,0,p);
document.removeEventListener("thesaurusDialogStateUpdated",this.dialogStateUpdatedHandlerBound);
a(q).dialog("destroy").remove();
a("#"+this.dialogContainerID).remove();
if(!b.isTouchDevice){b.textViewer.focus();
}};
o.prototype.dialogReady=function(){var v=this;
this.applyDialogState(this.state);
var q=document.getElementById("thesaurusDialog_btnBack");
q.addEventListener("click",r);
var z=document.getElementById("thesaurusDialog_txtFindSynonymsFor");
z.addEventListener("input",A);
z.addEventListener("change",A);
var s=document.getElementById("thesaurusDialog_cbLanguage");
s.addEventListener("change",t);
var w=document.getElementById("thesaurusDialog_tvSynonyms");
w.addEventListener("keydown",y);
w.addEventListener("focus",x);
w.addEventListener("blur",function(){v.lastSelectedSynonym=v.getSelectedSynonym();
m();
});
var B=document.getElementById("thesaurusDialog_treeViewWrapper");
document.addEventListener("thesaurusDialogStateUpdated",this.dialogStateUpdatedHandlerBound);
z.focus();
function p(){b.sendCommand(b.Command.ThesaurusDialogCommand,b.ThesaurusDialogCommand.Back);
}function r(C){p();
}function A(C){b.sendCommand(b.Command.ThesaurusDialogCommand,b.ThesaurusDialogCommand.FindSynonymTextChanged,0,0,{text:z.value});
}function t(C){b.sendCommand(b.Command.ThesaurusDialogCommand,b.ThesaurusDialogCommand.LanguageChanged,0,0,{languageName:s.value});
}function x(C){var D=document.querySelector("#thesaurusDialog_tvSynonyms tr.selected");
if(!D&&(w.rows.length>1)){w.rows[0].classList.add("selected");
}}function y(D){var F=D.keyCode||D.which||0;
switch(F){case b.KeyCode.DownArrow:H();
D.preventDefault();
break;
case b.KeyCode.UpArrow:H(true);
D.preventDefault();
break;
case b.KeyCode.LeftArrow:C();
D.preventDefault();
break;
case b.KeyCode.RightArrow:E();
D.preventDefault();
break;
case b.KeyCode.Space:G();
D.preventDefault();
break;
case b.KeyCode.Backspace:if(document.activeElement==w){p();
D.preventDefault();
}break;
case b.KeyCode.Enter:v.OKHandler(document.getElementById("thesaurusDialog"));
D.preventDefault();
break;
}function C(){var I=document.querySelector("#thesaurusDialog_tvSynonyms tr.selected");
if(I.classList.contains("treeNode")){f(I);
u(I);
}else{if(I.classList.contains("treeNodeItem")){I.classList.remove("selected");
I=I.parentElement.parentElement.parentElement.parentElement.previousSibling;
I.classList.add("selected");
u(I);
}}}function E(){var I=document.querySelector("#thesaurusDialog_tvSynonyms tr.selected");
if(I.classList.contains("treeNode")){if(I.dataset.collapsed=="true"){n(I);
}else{I.classList.remove("selected");
I=I.nextSibling.cells[0].children[0].children[0].rows[0];
I.classList.add("selected");
}u(I);
}}function G(){var I=document.querySelector("#thesaurusDialog_tvSynonyms tr.selected");
if(I&&I.classList.contains("treeNodeItem")){b.sendCommand(b.Command.ThesaurusDialogCommand,b.ThesaurusDialogCommand.SelectedNodeChanged,0,0,{word:I.dataset.word,text:I.dataset.text});
}}function H(L){var K,J,I;
L=!!L;
K=document.getElementById("thesaurusDialog_tvSynonyms");
J=K.querySelectorAll("tr.treeNode, tr:not([data-collapsed='true']) + tr.treeNodeItemContainer tr.treeNodeItem");
for(I=0;
I<J.length;
++I){if(J[I].classList.contains("selected")){J[I].classList.remove("selected");
break;
}}if(I==J.length){return;
}I=L?(I-1).mod(J.length):(I+1).mod(J.length);
J[I].classList.add("selected");
u(J[I]);
}}function u(E){var C=B.clientHeight;
var D=E.clientHeight;
var F=E.getBoundingClientRect().top-w.getBoundingClientRect().top;
if(F<B.scrollTop){B.scrollTop=F-C+D;
}else{if((F+D)>(B.scrollTop+C)){B.scrollTop=F;
}}}};
o.prototype.applyStringResources=function(p){document.getElementById("THESAURUS_DLG_LBL_FIND_SYN_FOR").textContent=p.THESAURUS_DLG_LBL_FIND_SYN_FOR;
document.getElementById("THESAURUS_DLG_LBL_LANGUAGE").textContent=p.THESAURUS_DLG_LBL_LANGUAGE;
document.getElementById("THESAURUS_DLG_LBL_SYNONYMS").textContent=p.THESAURUS_DLG_LBL_SYNONYMS;
this.noAltText=p.THESAURUS_DLG_NO_ALTERNATIVES;
this.setDefaultBtnTexts(p);
document.querySelector("#btnOK_"+this.dialogContainerID+" span.txui-button-text").textContent=p.THESAURUS_DLG_BTN_INSERT;
};
return o;
})(b.HTMLDialog);
return d;
}(TXTextControl||{},j$1_10_2));
var TXTextControl=(function(c,a){var b=c._private=c._private||{};
b.ClientPasteDialog=(function(d){__extends(f,d);
function f(k){d.call(this);
this.DialogInfo={DialogType:b.HTMLDialogType.ClientPasteDialog,ElementID:"clientPasteDialog",Width:300,Height:255,FileName:"Dialogs/ClientPasteDialog.html",TitleResourceName:"CLIENTPASTE_DIALOG_TITLE",Buttons:{}};
}function h(){var k=document.getElementById("pasteArea");
return k.innerHTML;
}function j(){var k=h();
b.pasteText(k,b.ClipboardDataType.HTML);
}f.prototype.closing=function(){b.modifierKeys=0;
};
function e(k){j();
k.close(a("#"+k.DialogInfo.ElementID));
}function i(m,k){if(!b.handleClientPaste(k,false)){m.close(a("#"+m.DialogInfo.ElementID));
return;
}var l=document.getElementById("pasteArea");
l.innerHTML="";
setTimeout(function(){e(m);
},10);
return false;
}function g(l,k){b.handleDrop(k);
l.close(a("#"+l.DialogInfo.ElementID));
return false;
}f.prototype.dialogReady=function(l){var p=this;
var m=a("#clientPasteDialog"),n=m.css("margin-left"),k={width:m.css("border-left-width"),color:m.css("border-left-color"),style:m.css("border-left-style")};
m.css("border-bottom-width",k.width);
m.css("border-bottom-color",k.color);
m.css("border-bottom-style",k.style);
m.css("margin-bottom",n);
var o=document.getElementById("pasteArea");
if(!b.isTouchDevice){o.focus();
}o.addEventListener("paste",function(q){i(p,q);
});
o.addEventListener("drop",function(q){g(p,q);
q.stopPropagation();
});
o.addEventListener("dragenter",function(q){q.preventDefault();
q.stopPropagation();
});
o.addEventListener("dragover",function(q){q.preventDefault();
q.stopPropagation();
q.dataTransfer.dropEffect="copy";
});
};
f.prototype.applyStringResources=function(k){a("#CLIENTPASTE_DIALOG_PLACEHLD_TXT").text(k.CLIENTPASTE_DIALOG_PLACEHLD_TXT);
};
return f;
})(b.HTMLDialog);
return c;
}(TXTextControl||{},j$1_10_2));
var TXTextControl=(function(d,a){var b=d._private=d._private||{};
b.SpellCheckDialogCommand={IgnoreOnce:1,IgnoreAll:2,AddToDict:3,Change:4,ChangeAll:5,SuggestionSelected:6,SuggestionDictSelected:7,PreviewTextChanged:8};
var c=false;
b.SpellCheckDialog=(function(f){__extends(l,f);
function l(m){f.call(this);
this.DialogInfo={DialogType:b.HTMLDialogType.SpellCheckDialog,ElementID:"spellCheckDialog",FileName:"Dialogs/SpellCheckDialog.html",TitleResourceName:"SPELLCHECK_DIALOG_TITLE",Buttons:{}};
this.dialogStateUpdatedHandlerBound=this.dialogStateUpdatedHandler.bind(this);
this.initialState=m;
}l.prototype.btnIgnoreOnceClick=function(m){b.sendCommand(b.Command.SpellCheckDialogCommand,b.SpellCheckDialogCommand.IgnoreOnce);
};
l.prototype.btnIgnoreAllClick=function(m){b.sendCommand(b.Command.SpellCheckDialogCommand,b.SpellCheckDialogCommand.IgnoreAll);
};
l.prototype.btnAddToDictClick=function(m){b.sendCommand(b.Command.SpellCheckDialogCommand,b.SpellCheckDialogCommand.AddToDict);
};
l.prototype.btnChangeClick=function(m){b.sendCommand(b.Command.SpellCheckDialogCommand,b.SpellCheckDialogCommand.Change);
};
l.prototype.btnChangeAllClick=function(m){b.sendCommand(b.Command.SpellCheckDialogCommand,b.SpellCheckDialogCommand.ChangeAll);
};
var e={spanBefore:null,spanEmph:null,spanAfter:null,textContent:""};
function h(m){var n;
if(m.target.children.length!=3){m.target.innerHTML="";
m.target.appendChild(e.spanBefore);
m.target.appendChild(e.spanEmph);
m.target.appendChild(e.spanAfter);
return;
}var s=m.target.children[1],t=s.textContent,u=e.spanEmph.textContent;
if(t!==u){b.sendCommand(b.Command.SpellCheckDialogCommand,b.SpellCheckDialogCommand.PreviewTextChanged,0,0,t);
}else{var q=m.target.children[0],o=m.target.children[2],r=e.spanBefore,p=e.spanAfter;
if(q.textContent!==r.textContent){q.textContent=r.textContent;
}else{if(o.textContent!==p.textContent){o.textContent=p.textContent;
}else{if(m.target.textContent!==e.textContent){m.target.innerHTML="";
m.target.appendChild(e.spanBefore);
m.target.appendChild(e.spanEmph);
m.target.appendChild(e.spanAfter);
}}}}e.spanBefore=m.target.children[0].cloneNode(true);
e.spanEmph=s.cloneNode(true);
e.spanAfter=m.target.children[2].cloneNode(true);
e.textContent=m.target.textContent;
}function k(q,m){m.innerHTML="";
var u=q.Text;
var o=document.createElement("SPAN");
var n=document.createElement("SPAN");
var p=document.createElement("SPAN");
p.style.fontWeight="bold";
p.style.color="red";
p.id="txSpellDlgPrevAreaEmphWord";
o.contentEditable=false;
n.contentEditable=false;
if(q.EmphasizedAreaStart!==null){var t=u.substring(q.EmphasizedAreaStart,q.EmphasizedAreaEnd);
p.textContent=t;
var s=u.substring(0,q.EmphasizedAreaStart);
var r=u.substring(q.EmphasizedAreaEnd);
o.textContent=s;
n.textContent=r;
}else{n.textContent=u;
}m.appendChild(o);
m.appendChild(p);
m.appendChild(n);
e.spanBefore=o.cloneNode(true);
e.spanEmph=p.cloneNode(true);
e.spanAfter=n.cloneNode(true);
e.textContent=m.textContent;
}l.prototype.applyPrevAreaState=function(n){var m=document.getElementById("txSpellCheckPreviewArea");
if(n.AreaEnabled){m.contentEditable=true;
}else{m.removeAttribute("contenteditable");
}if(n.Text!==null){k(n,m);
}};
l.prototype.setSugDicts=function(q){var n=document.getElementById("txSpellCheckSelSuggDict");
n.innerHTML="";
for(var o=0;
o<q.Names.length;
++o){var p=q.Names[o];
var m=document.createElement("OPTION");
m.textContent=p;
m.value=p;
n.appendChild(m);
}if(q.SelectedDict!==null){n.value=q.SelectedDict;
}};
function i(m){if(c){return;
}b.sendCommand(b.Command.SpellCheckDialogCommand,b.SpellCheckDialogCommand.SuggestionDictSelected,0,0,m.target.value);
}l.prototype.setSuggestions=function(o){var p=o.Suggestions;
var m=o.NoSuggestionsCreated;
var n=document.getElementById("txSpellCheckSelSuggestions");
n.innerHTML="";
if(m){n.setAttribute("disabled","disabled");
}else{n.removeAttribute("disabled");
}p.forEach(function(r){var q=document.createElement("OPTION");
q.textContent=r;
n.appendChild(q);
});
if(!m){n.selectedIndex=0;
}};
function j(m){if(c){return;
}b.sendCommand(b.Command.SpellCheckDialogCommand,b.SpellCheckDialogCommand.SuggestionSelected,0,0,m.target.value);
}function g(m,n){if(n){m.removeAttribute("disabled");
m.classList.remove("txui-state-disabled");
}else{m.setAttribute("disabled","disabled");
m.classList.add("txui-state-disabled");
}}l.prototype.setButtonStates=function(r){var p=document.getElementById("ID_SPELL_BTN_IGNORE_ONCE");
if(r.BtnIgnore.Text!==null){p.textContent=r.BtnIgnore.Text;
}if(r.BtnIgnore.Enabled!==null){g(p,r.BtnIgnore.Enabled);
}var q=document.getElementById("ID_SPELL_BTN_IGNORE_ALL");
if(r.BtnIgnoreAll.Enabled!==null){g(q,r.BtnIgnoreAll.Enabled);
}var m=document.getElementById("ID_SPELL_BTN_ADD_TO_DICTIONARY");
if(r.BtnAddToDict.Enabled!==null){g(m,r.BtnAddToDict.Enabled);
}var n=document.getElementById("ID_SPELL_BTN_CHANGE");
if(r.BtnChange.Text!==null){n.textContent=r.BtnChange.Text;
}if(r.BtnChange.Enabled!==null){g(n,r.BtnChange.Enabled);
}var o=document.getElementById("ID_SPELL_BTN_CHANGE_ALL");
if(r.BtnChangeAll.Text!==null){o.textContent=r.BtnChangeAll.Text;
}if(r.BtnChangeAll.Enabled!==null){g(o,r.BtnChangeAll.Enabled);
}};
l.prototype.updateSugArea=function(n){var m=document.getElementById("txSpellCheckSelSuggDict");
if(n.CbSugDictsEnabled){m.removeAttribute("disabled");
}else{m.setAttribute("disabled","disabled");
}};
l.prototype.setDialogState=function(n){var m=document.getElementById("txSpellCheckLblLang");
if(n.LblLangText!==null){m.textContent=n.LblLangText;
}if(n.MessageBoxText!==null){b.jQueryAlert("TXSpell",n.MessageBoxText);
}if(n.CloseDialog){this.close(a("#"+this.DialogInfo.ElementID));
}};
l.prototype.applyDialogState=function(m){c=true;
if(m.Preview!==null){this.applyPrevAreaState(m.Preview);
}if(m.SugDicts!==null){this.setSugDicts(m.SugDicts);
}if(m.Suggestions!==null){this.setSuggestions(m.Suggestions);
}if(m.ButtonStates!==null){this.setButtonStates(m.ButtonStates);
}if(m.SuggestionsArea!==null){this.updateSugArea(m.SuggestionsArea);
}if(m.DialogState!==null){this.setDialogState(m.DialogState);
}c=false;
};
l.prototype.dialogStateUpdatedHandler=function(m){var n=m.detail;
this.applyDialogState(n);
};
l.prototype.applyStringResources=function(m){a("#ID_SPELL_LBL_NOT_IN_DICTIONARIES").text(m.ID_SPELL_LBL_NOT_IN_DICTIONARIES);
a("#LBL_LANGUAGE").text(m.LBL_LANGUAGE);
a("#ID_SPELL_BTN_IGNORE_ONCE").text(m.ID_SPELL_BTN_IGNORE_ONCE);
a("#ID_SPELL_BTN_IGNORE_ALL").text(m.ID_SPELL_BTN_IGNORE_ALL);
a("#ID_SPELL_BTN_ADD_TO_DICTIONARY").text(m.ID_SPELL_BTN_ADD_TO_DICTIONARY);
a("#ID_SPELL_LBL_SUGGESTIONS").text(m.ID_SPELL_LBL_SUGGESTIONS);
a("#ID_SPELL_BTN_CHANGE").text(m.ID_SPELL_BTN_CHANGE);
a("#ID_SPELL_BTN_CHANGE_ALL").text(m.ID_SPELL_BTN_CHANGE_ALL);
a("#ID_SPELL_LBL_SUGGESTIONS_DICTIONARY").text(m.ID_SPELL_LBL_SUGGESTIONS_DICTIONARY);
a("#ID_SPELL_BTN_CANCEL").text(m.ID_SPELL_BTN_CANCEL);
};
l.prototype.closing=function(){document.removeEventListener("spellCheckDialogStateUpdated",this.dialogStateUpdatedHandlerBound);
};
l.prototype.dialogReady=function(){var s=this;
var n=a("#spellCheckDialog"),r=n.css("margin-left"),m={width:n.css("border-left-width"),color:n.css("border-left-color"),style:n.css("border-left-style")};
n.css("border-bottom-width",m.width);
n.css("border-bottom-color",m.color);
n.css("border-bottom-style",m.style);
n.css("margin-bottom",r);
a("#ID_SPELL_BTN_IGNORE_ONCE").click(s.btnIgnoreOnceClick);
a("#ID_SPELL_BTN_IGNORE_ALL").click(s.btnIgnoreAllClick);
a("#ID_SPELL_BTN_ADD_TO_DICTIONARY").click(s.btnAddToDictClick);
a("#ID_SPELL_BTN_CHANGE").click(s.btnChangeClick);
a("#ID_SPELL_BTN_CHANGE_ALL").click(s.btnChangeAllClick);
a("#ID_SPELL_BTN_CANCEL").click(function(){s.close(a("#"+s.DialogInfo.ElementID));
});
this.applyDialogState(this.initialState);
document.addEventListener("spellCheckDialogStateUpdated",this.dialogStateUpdatedHandlerBound);
var q=document.getElementById("txSpellCheckSelSuggestions");
q.addEventListener("change",j);
var p=document.getElementById("txSpellCheckSelSuggDict");
p.addEventListener("change",i);
var o=document.getElementById("txSpellCheckPreviewArea");
o.addEventListener("keyup",h);
};
return l;
})(b.HTMLDialog);
return d;
}(TXTextControl||{},j$1_10_2));
var TXTextControl=(function(c,a){var b=c._private=c._private||{};
b.EdgePrintDialog=(function(d){__extends(e,d);
function e(f){d.call(this);
var g=this;
this.DialogInfo={DialogType:b.HTMLDialogType.EdgePrintDialog,ElementID:"edgePrintDialog",FileName:"Dialogs/EdgePrintDialog.html",Width:400,TitleResourceName:"EDGE_PRINT_DIALOG_TITLE",Buttons:{Cancel:{text:"Cancel",click:function(){g.close(this);
},id:"btnCancel_"+this.dialogContainerID}}};
this.printHandlerUrl=f;
}e.prototype.dialogReady=function(f){var g=document.getElementById("edgePrintDialog_downloadLink");
g.download="print_result.pdf";
g.href=this.printHandlerUrl;
};
e.prototype.applyStringResources=function(h){var f=document.getElementById("EDGE_PRINT_DIALOG_TEXT");
f.innerHTML=h.EDGE_PRINT_DIALOG_TEXT;
var g=document.getElementById("EDGE_PRINT_DIALOG_DOWNLOAD_LINK_TEXT");
g.innerHTML=h.EDGE_PRINT_DIALOG_DOWNLOAD_LINK_TEXT;
this.setDefaultBtnTexts(h);
};
return e;
})(b.HTMLDialog);
return c;
}(TXTextControl||{},j$1_10_2));
var TXTextControl=(function(c,a){var b=c._private=c._private||{};
b.PermissionsAddUserDialogCommand={};
b.PermissionsAddUserDialog=(function(d){__extends(h,d);
function h(i){d.call(this);
this.DialogInfo={DialogType:b.HTMLDialogType.PermissionsAddUserDialog,ElementID:"permissionsAddUserDialog",FileName:"Dialogs/PermissionsAddUserDialog.html",TitleResourceName:"PERMISSIONSADDUSER_DLG_TITLE"};
this.dialogStateUpdatedHandlerBound=this.dialogStateUpdatedHandler.bind(this);
this.state=i;
this.registeredUserNameHintText="";
}h.prototype.applyDialogState=function(y){var w=this,p,o;
var z=document.getElementById("permissionsAddUserDialog_txtNewUser");
var l=document.getElementById("permissionsAddUserDialog_btnDelete");
var k=document.getElementById("permissionsAddUserDialog_btnAdd");
var r=document.getElementById("permissionsAddUserDialog_lbUsers");
var m=document.getElementById("btnOK_"+w.dialogContainerID);
var n=document.getElementById("permissionsAddUserDialog_cbRegUsers");
var s=document.getElementById("permissionsAddUserDialog_rowLblNewUser");
var u=document.getElementById("permissionsAddUserDialog_rowNewUser");
var t=document.getElementById("permissionsAddUserDialog_rowLblRegUsers");
var v=document.getElementById("permissionsAddUserDialog_rowRegUsers");
if(y.userName!==null){z.value=y.userName;
}if(y.userNames){j(y.userNames);
}if(y.registeredUserNames){if(y.registeredUserNames.length){i(y.registeredUserNames);
}else{t.style.display=v.style.display="none";
}}if(y.deleteButton){g(l,y.deleteButton.Enabled);
}if(y.addButton){g(k,y.addButton.Enabled);
}if(y.okButton){g(m,y.okButton.Enabled);
}if(y.selectedIndex!==null){x(y.selectedIndex);
}if((y.allowAdditional!==null)&&!y.allowAdditional){s.style.display=u.style.display="none";
}function j(C){var A,B;
r.innerHTML="";
for(A=0;
A<C.length;
++A){B=C[A];
p=document.createElement("div");
r.appendChild(p);
p.dataset.index=A;
p.addEventListener("click",q);
o=document.createElement("p");
p.appendChild(o);
o.textContent=B;
}}function x(A){f();
if(A>-1){var B=document.querySelectorAll("#permissionsAddUserDialog_lbUsers div");
if(A<B.length){B[A].classList.add("selected");
}}}function q(A){f();
A.currentTarget.classList.add("selected");
b.sendCommand(b.Command.PermissionsAddUserDialogCommand,b.PermissionsAddUserDialogCommand.SelectedIndexChanged,0,0,{index:parseInt(A.currentTarget.dataset.index,10)});
}function i(B){var A;
if(!B.length){return;
}A=document.createElement("option");
n.appendChild(A);
A.disabled=true;
A.selected=true;
A.style.display="none";
A.style.color="#AAA";
A.textContent=w.registeredUserNameHintText;
B.forEach(function(C){A=document.createElement("option");
n.appendChild(A);
A.textContent=C;
});
n.selectedIndex=0;
}};
h.prototype.close=function(j){var i={dialogResult:this.dialogData.dialogResult};
b.sendCommand(b.Command.DialogResult,b.HTMLDialogType.PermissionsAddUserDialog,0,0,i);
document.removeEventListener("permissionsAddUserDialogUpdated",this.dialogStateUpdatedHandlerBound);
a(j).dialog("destroy").remove();
a("#"+this.dialogContainerID).remove();
if(!b.isTouchDevice){b.textViewer.focus();
}};
function e(i){b.sendCommand(b.Command.PermissionsAddUserDialogCommand,b.PermissionsAddUserDialogCommand.DeleteButtonClicked);
}function f(){var i=document.querySelectorAll("#permissionsAddUserDialog_lbUsers div");
[].forEach.call(i,function(j){j.classList.remove("selected");
});
}function g(j,i){j.disabled=!i;
if(i){j.classList.remove("txui-state-disabled");
}else{j.classList.add("txui-state-disabled");
}}h.prototype.dialogReady=function(){var p=this;
i();
var q=document.getElementById("permissionsAddUserDialog_txtNewUser");
var n=document.getElementById("permissionsAddUserDialog_cbRegUsers");
n.addEventListener("change",o);
var j=document.getElementById("permissionsAddUserDialog_btnAdd");
j.addEventListener("keydown",l);
var m=document.getElementById("permissionsAddUserDialog_btnDelete");
q.addEventListener("input",r);
q.addEventListener("change",r);
q.addEventListener("keydown",t);
q.addEventListener("focus",s);
j.addEventListener("click",k);
this.applyDialogState(this.state);
document.addEventListener("permissionsAddUserDialogUpdated",this.dialogStateUpdatedHandlerBound);
function r(u){b.sendCommand(b.Command.PermissionsAddUserDialogCommand,b.PermissionsAddUserDialogCommand.UserNameChanged,0,0,{userName:q.value});
}function t(u){var v=u.keyCode||u.which||0;
switch(v){case b.KeyCode.Enter:if(!j.disabled){b.sendCommand(b.Command.PermissionsAddUserDialogCommand,b.PermissionsAddUserDialogCommand.AddButtonClicked);
u.preventDefault();
}break;
}}function l(u){t(u);
}function s(){f();
g(m,false);
}function k(u){b.sendCommand(b.Command.PermissionsAddUserDialogCommand,b.PermissionsAddUserDialogCommand.AddButtonClicked);
q.focus();
}function i(){var w=document.getElementById("permissionsAddUserDialog").parentElement;
var v=w.querySelector("div.txui-dialog-buttonpane > .txui-dialog-buttonset");
var u=document.createElement("button");
v.appendChild(u);
u.type="button";
u.id="permissionsAddUserDialog_btnDelete";
u.classList.add("txui-button");
u.classList.add("txui-button-text-only");
u.classList.add("txui-state-default");
var x=document.createElement("span");
u.appendChild(x);
x.classList.add("txui-button-text");
x.textContent=p.stringResources.PERMISSIONSADDUSER_DLG_BTN_DELETE;
u.addEventListener("click",e);
}function o(u){b.sendCommand(b.Command.PermissionsAddUserDialogCommand,b.PermissionsAddUserDialogCommand.RegisteredUserSelected,0,0,{userName:n.value});
n.selectedIndex=0;
}};
h.prototype.dialogStateUpdatedHandler=function(i){this.applyDialogState(i.detail);
};
h.prototype.applyStringResources=function(i){document.getElementById("PERMISSIONSADDUSER_DLG_LBL_NEW_USER").textContent=i.PERMISSIONSADDUSER_DLG_LBL_NEW_USER;
document.getElementById("PERMISSIONSADDUSER_DLG_LBL_USERS").textContent=i.PERMISSIONSADDUSER_DLG_LBL_USERS;
document.getElementById("permissionsAddUserDialog_btnAdd").textContent=i.PERMISSIONSADDUSER_DLG_BTN_ADD;
document.getElementById("PERMISSIONSADDUSER_DLG_LBL_REG_USERS").textContent=i.PERMISSIONSADDUSER_DLG_LBL_REG_USERS;
this.registeredUserNameHintText=i.PERMISSIONSADDUSER_DLG_REG_USERS_HINT;
this.setDefaultBtnTexts(i);
this.stringResources=i;
};
return h;
})(b.HTMLDialog);
return c;
}(TXTextControl||{},j$1_10_2));
var TXTextControl=(function(c,a){var b=c._private=c._private||{};
b.FieldDialog=(function(d){__extends(e,d);
function e(f,g){d.call(this);
this.fieldAdapter=f;
this.textField=g||null;
this.fieldDataReceivedHandlerBound=this.fieldDataReceivedHandler.bind(this);
}e.prototype.fieldDataReceivedHandler=function(f){var h=f.detail.fieldType,g=f.detail.field;
if(!g||(h!=this.DialogInfo.FieldType)){return;
}this.setValues(g);
};
e.prototype.OKHandler=function(g){if(this.textField){var f={updatedValues:this.getValues(),textField:this.textField};
b.sendCommand(b.Command.UpdateField,this.DialogInfo.FieldType,0,0,f);
}else{b.sendCommand(b.Command.InsertItem,b.ItemType.FieldAdapter,this.DialogInfo.FieldType,0,this.getValues());
}this.close(g);
};
e.prototype.closing=function(f){if(!this.fieldAdapter){document.removeEventListener("fieldDataReceived",this.fieldDataReceivedHandlerBound);
}};
e.prototype.loaded=function(){if(!this.fieldAdapter){document.addEventListener("fieldDataReceived",this.fieldDataReceivedHandlerBound);
b.sendCommand(b.Command.GetItem,b.ItemType.FieldAdapter);
}else{this.setValues(this.fieldAdapter);
}document.addEventListener("dialogResourcesReceived",this.resourcesReceivedHandlerBound);
b.sendCommand(b.Command.GetDialogResources,this.DialogInfo.DialogType);
};
e.prototype.setValues=function(f){};
e.prototype.getValues=function(){return{};
};
return e;
})(b.HTMLDialog);
return c;
}(TXTextControl||{},j$1_10_2));
var TXTextControl=(function(c,a){var b=c._private=c._private||{};
b.IfFieldDialog=(function(d){__extends(e,d);
function e(f,g){d.call(this,f,g);
this.DialogInfo={DialogType:b.HTMLDialogType.IfFieldDialog,FieldType:b.FieldType.IfField,ElementID:"ifFieldDialog",Width:385,FileName:"Dialogs/MailMerge/IfFieldDialog.html",TitleResourceName:"IF_FIELD_DIALOG_TITLE"};
}e.prototype.setValues=function(f){a("#txtFieldName").val(f.Expression1);
a("#txtCompareTo").val(f.Expression2);
a("#txtInsertThis").val(f.TrueText);
a("#txtOtherwise").val(f.FalseText);
document.getElementById("selIfFldOperators").selectedIndex=f.Operator;
};
e.prototype.getValues=function(){var f={Expression1:a("#txtFieldName").val(),Expression2:a("#txtCompareTo").val(),TrueText:a("#txtInsertThis").val(),FalseText:a("#txtOtherwise").val(),Operator:document.getElementById("selIfFldOperators").selectedIndex};
return f;
};
e.prototype.applyStringResources=function(f){a("#IF_FIELD_GROUP_BOX > legend").text(f.IF_FIELD_GROUP_BOX);
a("#IF_FIELD_LABEL_NAME").text(f.IF_FIELD_LABEL_NAME);
a("#IF_FIELD_LABEL_COMPARISON").text(f.IF_FIELD_LABEL_COMPARISON);
a("#IF_FIELD_COMBO_BOX_COMPARISON_EQUALS").text(f.IF_FIELD_COMBO_BOX_COMPARISON_EQUALS);
a("#IF_FIELD_COMBO_BOX_COMPARISON_NOT_EQUAL").text(f.IF_FIELD_COMBO_BOX_COMPARISON_NOT_EQUAL);
a("#IF_FIELD_COMBO_BOX_COMPARISON_LESS").text(f.IF_FIELD_COMBO_BOX_COMPARISON_LESS);
a("#IF_FIELD_COMBO_BOX_COMPARISON_GREATER").text(f.IF_FIELD_COMBO_BOX_COMPARISON_GREATER);
a("#IF_FIELD_COMBO_BOX_COMPARISON_GREATER_OR_EQUAL").text(f.IF_FIELD_COMBO_BOX_COMPARISON_GREATER_OR_EQUAL);
a("#IF_FIELD_COMBO_BOX_COMPARISON_LESS_OR_EQUAL").text(f.IF_FIELD_COMBO_BOX_COMPARISON_LESS_OR_EQUAL);
a("#IF_FIELD_LABEL_COMPARE_TO").text(f.IF_FIELD_LABEL_COMPARE_TO);
a("#IF_FIELD_LABEL_INSERT_THIS").text(f.IF_FIELD_LABEL_INSERT_THIS);
a("#IF_FIELD_LABEL_OTHERWISE").text(f.IF_FIELD_LABEL_OTHERWISE);
this.setDefaultBtnTexts(f);
};
return e;
})(b.FieldDialog);
return c;
}(TXTextControl||{},j$1_10_2));
var TXTextControl=(function(c,a){var b=c._private=c._private||{};
b.MergeFieldDialog=(function(d){__extends(e,d);
function e(f,g){d.call(this,f,g);
this.DialogInfo={DialogType:b.HTMLDialogType.MergeFieldDialog,FieldType:b.FieldType.MergeField,ElementID:"mergeFieldDialog",FileName:"Dialogs/MailMerge/MergeFieldDialog.html",TitleResourceName:"MERGEFIELD_DIALOG_TITLE",};
}e.prototype.setValues=function(f){document.getElementById("txtFieldName").value=f.Name;
document.getElementById("txtFieldText").value=f.Text;
document.getElementById("selMergeFieldFormat").selectedIndex=f.TextFormat;
document.getElementById("txtTextBefore").value=f.TextBefore;
document.getElementById("txtTextBefore").disabled=(f.TextBefore.length==0);
document.getElementById("chkTextBefore").checked=(f.TextBefore.length>0);
document.getElementById("txtTextAfter").value=f.TextAfter;
document.getElementById("txtTextAfter").disabled=(f.TextAfter.length==0);
document.getElementById("chkTextAfter").checked=(f.TextAfter.length>0);
document.getElementById("txtDateTimeFormat").value=f.DateTimeFormat;
document.getElementById("txtDateTimeFormat").disabled=(f.DateTimeFormat.length==0);
document.getElementById("chkDateTimeFormat").checked=(f.DateTimeFormat.length>0);
document.getElementById("txtNumericFormat").value=f.NumericFormat;
document.getElementById("txtNumericFormat").disabled=(f.NumericFormat.length==0);
document.getElementById("chkNumericFormat").checked=(f.NumericFormat.length>0);
document.getElementById("chkPreserveFormat").checked=(f.PreserveFormatting);
};
e.prototype.getValues=function(){var f={Name:a("#txtFieldName").val(),Text:a("#txtFieldText").val(),TextFormat:document.getElementById("selMergeFieldFormat").selectedIndex,TextBefore:document.getElementById("chkTextBefore").checked?document.getElementById("txtTextBefore").value:"",TextAfter:document.getElementById("chkTextAfter").checked?document.getElementById("txtTextAfter").value:"",DateTimeFormat:document.getElementById("chkDateTimeFormat").checked?document.getElementById("txtDateTimeFormat").value:"",NumericFormat:document.getElementById("chkNumericFormat").checked?document.getElementById("txtNumericFormat").value:"",PreserveFormatting:document.getElementById("chkPreserveFormat").checked,};
return f;
};
e.prototype.applyStringResources=function(f){a("#MERGEFIELD_GROUP_FIELD_PROPERTIES > legend").text(f.MERGEFIELD_GROUP_FIELD_PROPERTIES);
a("#MERGEFIELD_LABEL_NAME").text(f.MERGEFIELD_LABEL_NAME);
a("#MERGEFIELD_LABEL_TEXT").text(f.MERGEFIELD_LABEL_TEXT);
a("#MERGEFIELD_LABEL_FORMAT").text(f.MERGEFIELD_LABEL_FORMAT);
a("#MERGEFIELD_FORMAT_NONE").text(f.MERGEFIELD_FORMAT_NONE);
a("#MERGEFIELD_FORMAT_UPPER").text(f.MERGEFIELD_FORMAT_UPPER);
a("#MERGEFIELD_FORMAT_LOWER").text(f.MERGEFIELD_FORMAT_LOWER);
a("#MERGEFIELD_FORMAT_FIRST_CAP").text(f.MERGEFIELD_FORMAT_FIRST_CAP);
a("#MERGEFIELD_FORMAT_TITLE_CASE").text(f.MERGEFIELD_FORMAT_TITLE_CASE);
a("#MERGEFIELD_GROUP_FIELD_OPTIONS > legend").text(f.MERGEFIELD_GROUP_FIELD_OPTIONS);
a("#MERGEFIELD_LABEL_TEXT_BEFORE").text(f.MERGEFIELD_LABEL_TEXT_BEFORE);
a("#MERGEFIELD_LABEL_TEXT_AFTER").text(f.MERGEFIELD_LABEL_TEXT_AFTER);
a("#MERGEFIELD_LABEL_DATE_TIME_FORMAT").text(f.MERGEFIELD_LABEL_DATE_TIME_FORMAT);
a("#MERGEFIELD_LABEL_NUMERIC_FORMAT").text(f.MERGEFIELD_LABEL_NUMERIC_FORMAT);
a("#MERGEFIELD_CHECK_BOX_PRESERVE_FORMAT").text(f.MERGEFIELD_CHECK_BOX_PRESERVE_FORMAT);
this.setDefaultBtnTexts(f);
};
e.prototype.dialogReady=function(){function i(j){a("#txtTextBefore").prop("disabled",!j.target.checked);
}function h(j){a("#txtTextAfter").prop("disabled",!j.target.checked);
}function f(j){a("#txtDateTimeFormat").prop("disabled",!j.target.checked);
}function g(j){a("#txtNumericFormat").prop("disabled",!j.target.checked);
}a("#chkTextBefore").click(i);
a("#chkTextAfter").click(h);
a("#chkDateTimeFormat").click(f);
a("#chkNumericFormat").click(g);
};
return e;
})(b.FieldDialog);
return c;
}(TXTextControl||{},j$1_10_2));
var TXTextControl=(function(c,a){var b=c._private=c._private||{};
b.MergeFieldTextFormat=Object.freeze({None:0,Uppercase:1,Lowercase:2,FirstCapital:3,TitleCase:4,});
b.IncludeTextField=(function(d){__extends(e,d);
function e(fileName){d.call(this,true);
this.fileName=fileName||"";
this.textFormat=0;
this.bookmark="";
}e.prototype.toUpperCamelCase=function(){return{Filename:this.fileName,TextFormat:this.textFormat,Bookmark:this.bookmark,PreserveFormatting:this.preserveFormatting};
};
return e;
})(b.FieldAdapter);
b.IncludeTextFieldDialog=(function(d){__extends(e,d);
function e(f,g){d.call(this,f,g);
this.DialogInfo={DialogType:b.HTMLDialogType.IncludeTextFieldDialog,FieldType:b.FieldType.IncludeTextField,ElementID:"includeTextFieldDialog",Width:300,FileName:"Dialogs/MailMerge/IncludeTextFieldDialog.html",TitleResourceName:"INCLUDETEXT_DIALOG_TITLE",};
}e.prototype.setValues=function(f){a("#txtFilename").val(f.Filename);
a("#txtBookmark").val(f.Bookmark);
document.getElementById("selectTextFormat").selectedIndex=f.TextFormat;
document.getElementById("chkPresFmt").checked=f.PreserveFormatting;
};
e.prototype.getValues=function(){var f={Filename:a("#txtFilename").val(),Bookmark:a("#txtBookmark").val(),TextFormat:document.getElementById("selectTextFormat").selectedIndex,PreserveFormatting:document.getElementById("chkPresFmt").checked};
return f;
};
e.prototype.applyStringResources=function(f){a("#INCLUDETEXT_GROUP_FIELD_OPTIONS > legend").text(f.INCLUDETEXT_GROUP_FIELD_OPTIONS);
a("#INCLUDETEXT_LABEL_FILENAME").text(f.INCLUDETEXT_LABEL_FILENAME);
a("#INCLUDETEXT_LABEL_BOOKMARK").text(f.INCLUDETEXT_LABEL_BOOKMARK);
a("#INCLUDETEXT_LABEL_TEXT_FORMAT").text(f.INCLUDETEXT_LABEL_TEXT_FORMAT);
a("#INCLUDETEXT_LIST_FORMAT_NONE").text(f.INCLUDETEXT_LIST_FORMAT_NONE);
a("#INCLUDETEXT_LIST_FORMAT_UPPER").text(f.INCLUDETEXT_LIST_FORMAT_UPPER);
a("#INCLUDETEXT_LIST_FORMAT_LOWER").text(f.INCLUDETEXT_LIST_FORMAT_LOWER);
a("#INCLUDETEXT_LIST_FORMAT_FIRST_CAP").text(f.INCLUDETEXT_LIST_FORMAT_FIRST_CAP);
a("#INCLUDETEXT_LIST_FORMAT_TITLE_CASE").text(f.INCLUDETEXT_LIST_FORMAT_TITLE_CASE);
a("#INCLUDETEXT_CHECK_BOX_PRESERVE_FORMAT").text(f.INCLUDETEXT_CHECK_BOX_PRESERVE_FORMAT);
this.setDefaultBtnTexts(f);
};
e.prototype.dialogReady=function(){var f=document.getElementById("selectTextFormat");
if(f.selectedIndex<0){f.selectedIndex=0;
}};
return e;
})(b.FieldDialog);
return c;
}(TXTextControl||{},j$1_10_2));
var TXTextControl=(function(c,a){var b=c._private=c._private||{};
b.DateFieldDialog=(function(d){__extends(e,d);
function e(f,g){d.call(this,f,g);
this.DialogInfo={DialogType:b.HTMLDialogType.DateFieldDialog,FieldType:b.FieldType.DateField,ElementID:"dateFieldDialog",Width:280,FileName:"Dialogs/MailMerge/DateFieldDialog.html",TitleResourceName:"DATEFIELD_DIALOG_TITLE",};
}e.prototype.setValues=function(f){a("#txtDateFormat").val(f.Format);
a("#chkPresFmt").prop("checked",f.PreserveFormatting);
};
e.prototype.getValues=function(){var f={Format:a("#txtDateFormat").val(),PreserveFormatting:document.getElementById("chkPresFmt").checked,};
return f;
};
e.prototype.applyStringResources=function(h){var f=["dd.MM.yyyy","dddd, d. MMMM yyyy","d. MMMM yyyy","dd.MM.yy","yyyy-MM-dd","yy-MM-dd","dd. MMM. yyyy","dd/MM/yy","MMMM yy","MMM-yy","dd.MM.yyyy HH:mm","dd.MM.yyyy HH:mm:ss","h:mm tt","h:mm:ss tt","HH:mm","HH:mm:ss",];
a("#DATEFIELD_LABEL_DATE_FORMATS").text(h.DATEFIELD_LABEL_DATE_FORMATS);
a("#DATEFIELD_CHECK_BOX_PRESERVE_FORMAT").text(h.DATEFIELD_CHECK_BOX_PRESERVE_FORMAT);
var g=document.getElementById("selDateFormats");
f.forEach(function(k){var i=h[k];
if(i){var j=document.createElement("option");
g.appendChild(j);
j.value=k;
j.text=i;
}});
this.setDefaultBtnTexts(h);
};
e.prototype.dialogReady=function(){var f=document.getElementById("selDateFormats");
var g=document.getElementById("txtDateFormat");
if(f.selectedIndex<0){f.selectedIndex=0;
}f.addEventListener("change",function(){var h=f.options[f.selectedIndex];
g.value=h.value;
});
};
return e;
})(b.FieldDialog);
return c;
}(TXTextControl||{},j$1_10_2));
var TXTextControl=(function(c,a){var b=c._private=c._private||{};
b.NextIfFieldDialog=(function(d){__extends(e,d);
function e(f,g){d.call(this,f,g);
this.DialogInfo={DialogType:b.HTMLDialogType.NextIfFieldDialog,FieldType:b.FieldType.NextIfField,ElementID:"ifFieldDialog",Width:385,FileName:"Dialogs/MailMerge/IfFieldDialog.html",TitleResourceName:"NEXTIF_FIELD_DIALOG_TITLE",};
}e.prototype.setValues=function(f){a("#txtFieldName").val(f.Expression1);
a("#txtCompareTo").val(f.Expression2);
document.getElementById("selIfFldOperators").selectedIndex=f.Operator;
};
e.prototype.getValues=function(){var f={Expression1:a("#txtFieldName").val(),Expression2:a("#txtCompareTo").val(),Operator:document.getElementById("selIfFldOperators").selectedIndex,};
return f;
};
e.prototype.applyStringResources=function(f){a("#IF_FIELD_GROUP_BOX > legend").text(f.IF_FIELD_GROUP_BOX);
a("#IF_FIELD_LABEL_NAME").text(f.IF_FIELD_LABEL_NAME);
a("#IF_FIELD_LABEL_COMPARISON").text(f.IF_FIELD_LABEL_COMPARISON);
a("#IF_FIELD_COMBO_BOX_COMPARISON_EQUALS").text(f.IF_FIELD_COMBO_BOX_COMPARISON_EQUALS);
a("#IF_FIELD_COMBO_BOX_COMPARISON_NOT_EQUAL").text(f.IF_FIELD_COMBO_BOX_COMPARISON_NOT_EQUAL);
a("#IF_FIELD_COMBO_BOX_COMPARISON_LESS").text(f.IF_FIELD_COMBO_BOX_COMPARISON_LESS);
a("#IF_FIELD_COMBO_BOX_COMPARISON_GREATER").text(f.IF_FIELD_COMBO_BOX_COMPARISON_GREATER);
a("#IF_FIELD_COMBO_BOX_COMPARISON_GREATER_OR_EQUAL").text(f.IF_FIELD_COMBO_BOX_COMPARISON_GREATER_OR_EQUAL);
a("#IF_FIELD_COMBO_BOX_COMPARISON_LESS_OR_EQUAL").text(f.IF_FIELD_COMBO_BOX_COMPARISON_LESS_OR_EQUAL);
a("#IF_FIELD_LABEL_COMPARE_TO").text(f.IF_FIELD_LABEL_COMPARE_TO);
a("#IF_FIELD_LABEL_INSERT_THIS").remove();
a("#txtInsertThis").remove();
a("#IF_FIELD_LABEL_OTHERWISE").remove();
a("#txtOtherwise").remove();
this.setDefaultBtnTexts(f);
};
return e;
})(b.FieldDialog);
return c;
}(TXTextControl||{},j$1_10_2));
var TXTextControl=(function(c,a){var b=c._private=c._private||{};
b.MaxPreviewRowsDialog=(function(d){__extends(e,d);
function e(f){d.call(this);
this.DialogInfo={DialogType:b.HTMLDialogType.MaxPreviewRowsDialog,ElementID:"maxPreviewRowsDialog",Width:"auto",Height:120,FileName:"Dialogs/MailMerge/MaxPreviewRowsDialog.html",TitleResourceName:"MAXPREVROWS_DIALOG_TITLE",};
this.value=f;
}e.prototype.closing=function(f){if(this.dialogData.dialogResult){this.value=parseInt(a("#spinNum").val(),10);
this.dialogData.value=this.value;
}};
e.prototype.applyStringResources=function(f){a("#MAXPREVROWS_LABEL_NUM_RESULTS").text(f.MAXPREVROWS_LABEL_NUM_RESULTS);
this.setDefaultBtnTexts(f);
};
e.prototype.dialogReady=function(){a("#spinNum").spinner({max:100,min:1});
a("#spinNum").val(this.value);
};
return e;
})(b.HTMLDialog);
return c;
}(TXTextControl||{},j$1_10_2));
var TXTextControl=(function(d,a){var b=d._private=d._private||{},c={Table:0,Paragraph:1,};
b.InsertMergeBlockDialog=(function(e){__extends(h,e);
function h(m,l){e.call(this);
this.DialogInfo={DialogType:b.HTMLDialogType.InsertMergeBlockDialog,ElementID:"insertMergeBlockDialog",Width:"auto",FileName:"Dialogs/MailMerge/InsertMergeBlockDialog.html",TitleResourceName:"INSERT_MERGE_BLOCK_DIALOG_TITLE"};
this.blockName=m;
this.dbScheme=l;
}function g(){var m=[];
var l=document.querySelectorAll("div#tblColContainer input[type=checkbox]");
[].forEach.call(l,function(n){if(n.checked){m.push(n.dataset.columnName);
}});
return m;
}h.prototype.getValues=function(){var l={type:document.getElementById("radioTableRow").checked?c.Table:c.Paragraph,name:this.blockName,headerRow:document.getElementById("chkAddHeaderRow").checked,columnNames:g()};
return l;
};
function f(n){var m=document.getElementById("btnMoveUp");
var l=document.getElementById("btnMoveDown");
m.disabled=(n.previousElementSibling===null);
l.disabled=(n.nextElementSibling===null);
}function i(m){var o=m.currentTarget;
var n=o.parentElement;
for(var p=0;
p<n.children.length;
++p){var l=n.children[p];
l.classList.remove("selected");
}o.classList.add("selected");
f(o);
var q=g().length?"enable":"disable";
a("#btnOK_"+this.dialogContainerID).button(q);
}h.prototype.createColumnCheckBoxes=function(l){var n=0,o=this,m=document.getElementById("tblColContainer");
l.forEach(function(q){var s=document.createElement("div");
s.style.cssFloat="left";
s.style.clear="left";
s.style.width="100%";
s.addEventListener("click",i.bind(o));
m.appendChild(s);
var p="chkColName"+n++,r=document.createElement("input");
r.id=p;
r.setAttribute("type","checkbox");
r.dataset.columnName=q.ColumnName;
r.title=q.ColumnName;
r.style.cssFloat="left";
r.style.clear="left";
s.appendChild(r);
var t=document.createElement("label");
t.setAttribute("for",p);
t.textContent=q.ColumnName;
t.title=q.ColumnName;
t.style.cssFloat="left";
s.appendChild(t);
});
};
h.prototype.OKHandler=function(m){var l=this.getValues();
if(l.columnNames.length>0){b.sendCommand(b.Command.InsertItem,b.ItemType.MergeBlock,0,0,l);
}this.close(m);
};
h.prototype.btnMoveUpClick=function(l){var n=document.querySelector("#tblColContainer > div.selected");
if(n===null){return;
}var o=n.previousElementSibling;
var m=document.getElementById("tblColContainer");
m.removeChild(n);
m.insertBefore(n,o);
f(n);
};
h.prototype.btnMoveDownClick=function(l){var n=document.querySelector("#tblColContainer > div.selected");
if(n===null){return;
}var o=n.nextElementSibling;
var m=document.getElementById("tblColContainer");
m.removeChild(n);
m.insertBefore(n,o.nextElementSibling);
f(n);
};
function k(m){var l=document.getElementById("chkAddHeaderRow");
l.disabled=!m.currentTarget.checked;
}function j(m){var l=document.getElementById("chkAddHeaderRow");
l.disabled=m.currentTarget.checked;
}h.prototype.dialogReady=function(){var l=this,m=this.dbScheme.Tables.find(function(n){return(n.TableName.toLowerCase()===l.blockName.toLowerCase());
});
this.createColumnCheckBoxes(m.Columns);
a("#btnOK_"+this.dialogContainerID).button("disable");
a("#btnMoveUp").click(l.btnMoveUpClick.bind(l));
a("#btnMoveDown").click(l.btnMoveDownClick.bind(l));
document.getElementById("radioTableRow").addEventListener("click",k);
document.getElementById("radioPlainPar").addEventListener("click",j);
};
h.prototype.applyStringResources=function(l){a("#INSERT_MERGE_BLOCK_DIALOG_LBL_SEL_TBL_COL").text(l.INSERT_MERGE_BLOCK_DIALOG_LBL_SEL_TBL_COL);
a("#INSERT_MERGE_BLOCK_DIALOG_LBL_PLAIN_PAR").text(l.INSERT_MERGE_BLOCK_DIALOG_LBL_PLAIN_PAR);
a("#INSERT_MERGE_BLOCK_DIALOG_LBL_TBL_ROW").text(l.INSERT_MERGE_BLOCK_DIALOG_LBL_TBL_ROW);
a("#INSERT_MERGE_BLOCK_DIALOG_LBL_HDR_ROW").text(l.INSERT_MERGE_BLOCK_DIALOG_LBL_HDR_ROW);
this.setDefaultBtnTexts(l);
};
return h;
})(b.HTMLDialog);
return d;
}(TXTextControl||{},j$1_10_2));
var TXTextControl=(function(c,a){var b=c._private=c._private||{};
b.EditDataRelationsDialog=(function(d){__extends(e,d);
function e(f){d.call(this);
this.DialogInfo={DialogType:b.HTMLDialogType.EditDataRelationsDialog,ElementID:"editDataRelationsDialog",Width:"auto",FileName:"Dialogs/MailMerge/EditDataRelationsDialog.html",TitleResourceName:"EDIT_DATA_RELS_DIALOG_TITLE"};
this.relations=f;
this.deletedRelations=[];
}e.prototype.closing=function(){if(this.dialogData.dialogResult){this.dialogData.relations=this.relations;
this.dialogData.deletedRelations=this.deletedRelations;
}};
e.prototype.addDataRelation=function(){var g=this,f=new b.CreateDataRelationDialog(b.dbScheme);
f.showModal(function(h){if(!h){return;
}g.relations.push(h);
g.populateSelect();
});
};
e.prototype.deleteSelectedRelation=function(){var f=document.getElementById("selDataRelations"),l=f.options[f.selectedIndex],j=this.relations;
for(var g=0;
g<j.length;
++g){var h=j[g],k=h.RelationName||b.getRelDesc(h);
if(k===l.value){this.deletedRelations.push(l.value);
j.splice(g,1);
this.populateSelect();
return;
}}};
e.prototype.populateSelect=function(){var g=this,f=document.getElementById("selDataRelations");
f.innerHTML="";
this.relations.forEach(function(i){var h=document.createElement("option"),j=b.getRelDesc(i);
h.value=h.text=i.RelationName||j;
h.title=j;
f.appendChild(h);
});
f.selectedIndex=0;
};
e.prototype.dialogReady=function(){var h=this;
this.populateSelect();
function f(i){h.addDataRelation();
}function g(i){h.deleteSelectedRelation();
}a("#EDIT_DATA_RELS_DIALOG_BTN_ADD").click(f);
a("#EDIT_DATA_RELS_DIALOG_BTN_DELETE").click(g);
};
e.prototype.applyStringResources=function(f){a("#EDIT_DATA_RELS_DIALOG_LBL_SEL_DATA_REL").text(f.EDIT_DATA_RELS_DIALOG_LBL_SEL_DATA_REL);
a("#EDIT_DATA_RELS_DIALOG_BTN_ADD").text(f.EDIT_DATA_RELS_DIALOG_BTN_ADD);
a("#EDIT_DATA_RELS_DIALOG_BTN_DELETE").text(f.EDIT_DATA_RELS_DIALOG_BTN_DELETE);
this.setDefaultBtnTexts(f);
};
return e;
})(b.HTMLDialog);
return c;
}(TXTextControl||{},j$1_10_2));
var TXTextControl=(function(c,a){var b=c._private=c._private||{};
b.CreateDataRelationDialog=(function(d){__extends(e,d);
function e(f){d.call(this);
this.DialogInfo={DialogType:b.HTMLDialogType.CreateDataRelationDialog,ElementID:"createDataRelationDialog",Width:"auto",FileName:"Dialogs/MailMerge/CreateDataRelationDialog.html",TitleResourceName:"CREATE_DATA_REL_DIALOG_TITLE",};
this.dbScheme=f;
this.callback=null;
this.newRelation={RelationName:"",ParentTableName:"",ChildTableName:"",ParentColumnName:"",ChildColumnName:""};
}e.prototype.dialogReady=function(){var h=this,g=document.getElementById("selMainTable"),f=document.getElementById("selChildTable");
g.onchange=function(){h.newRelation.ParentTableName=this.value;
h.populateColumnNameContainer(document.getElementById("mainTblColContainer"),this.value,"parent");
};
f.onchange=function(){h.newRelation.ChildTableName=this.value;
h.populateColumnNameContainer(document.getElementById("childTblColContainer"),this.value,"child");
};
this.dbScheme.Tables.forEach(function(j){var i=document.createElement("option");
i.value=i.text=i.title=j.TableName;
g.appendChild(i);
f.appendChild(i.cloneNode(true));
});
this.populateColumnNameContainers(this.dbScheme.Tables[0].TableName);
this.newRelation.ParentTableName=this.newRelation.ChildTableName=this.dbScheme.Tables[0].TableName;
this.newRelation.ParentColumnName=this.newRelation.ChildColumnName=this.dbScheme.Tables[0].Columns[0].ColumnName;
};
e.prototype.populateColumnNameContainers=function(f){this.populateColumnNameContainer(document.getElementById("mainTblColContainer"),f,"parent");
this.populateColumnNameContainer(document.getElementById("childTblColContainer"),f,"child");
};
e.prototype.populateColumnNameContainer=function(f,j,k){var h=this,g=0;
f.innerHTML="";
var i=this.dbScheme.Tables.find(function(l){return l.TableName.toLowerCase()===j.toLowerCase();
});
if(!i){console.assert(i);
return;
}i.Columns.forEach(function(l){var o=f.id+"_opt_"+g++,n=document.createElement("input");
n.id=o;
n.setAttribute("type","radio");
n.setAttribute("name","group_"+k);
n.dataset.columnName=l.ColumnName;
n.dataset.tableRole=k;
n.title=l.ColumnName;
n.style.cssFloat="left";
n.style.clear="left";
f.appendChild(n);
n.addEventListener("click",function(p){h.columnSelected(this.dataset.columnName,this.dataset.tableRole);
});
if(g==1){n.checked=true;
h.columnSelected(l.ColumnName,k);
}var m=document.createElement("label");
m.setAttribute("for",o);
m.textContent=l.ColumnName;
m.title=l.ColumnName;
m.style.cssFloat="left";
f.appendChild(m);
});
};
e.prototype.columnSelected=function(f,g){switch(g){case"parent":this.newRelation.ParentColumnName=f;
break;
case"child":this.newRelation.ChildColumnName=f;
break;
}};
b.getRelDesc=function(f){if(!f){return"NO RELATION GIVEN";
}return f.ParentTableName+'["'+f.ParentColumnName+'"] -> '+f.ChildTableName+'["'+f.ChildColumnName+'"]';
};
e.prototype.OKHandler=function(f){if(this.callback&&this.relationIsValid(this.newRelation)){var g=document.getElementById("txtRelName");
if(g.value){this.newRelation.RelationName=g.value;
}else{this.newRelation.RelationName=b.getRelDesc(this.newRelation);
}this.callback(this.newRelation);
}this.close(f);
};
e.prototype.close=function(f){a(f).dialog("destroy").remove();
a("#"+this.dialogContainerID).remove();
};
e.prototype.showModal=function(f){var h=document.getElementById("txTemplateDesignerContainer"),i=document.createElement("div");
i.id=this.dialogContainerID;
h.appendChild(i);
var j=b.getTXFileDir();
var g=a("#"+this.dialogContainerID);
g.load(j+this.DialogInfo.FileName,this.loadedBound);
this.callback=f;
};
e.prototype.applyStringResources=function(f){a("#CREATE_DATA_REL_DIALOG_LBL_MAIN_TBL").text(f.CREATE_DATA_REL_DIALOG_LBL_MAIN_TBL);
a("#CREATE_DATA_REL_DIALOG_LBL_MAIN_COL").text(f.CREATE_DATA_REL_DIALOG_LBL_MAIN_COL);
a("#CREATE_DATA_REL_DIALOG_LBL_CHILD_TBL").text(f.CREATE_DATA_REL_DIALOG_LBL_CHILD_TBL);
a("#CREATE_DATA_REL_DIALOG_LBL_CHILD_COL").text(f.CREATE_DATA_REL_DIALOG_LBL_CHILD_COL);
a("#CREATE_DATA_REL_DIALOG_LBL_REL_NAME").text(f.CREATE_DATA_REL_DIALOG_LBL_REL_NAME);
a("#txtRelName").attr("placeholder",f.CREATE_DATA_REL_DIALOG_INP_REL_NAME_PLACEHLD);
this.setDefaultBtnTexts(f);
};
e.prototype.relationIsValid=function(f){return(f.ParentTableName!=="")&&(f.ChildTableName!=="")&&(f.ParentColumnName!=="")&&(f.ChildColumnName!=="");
};
return e;
})(b.HTMLDialog);
return c;
}(TXTextControl||{},j$1_10_2));
var TXTextControl=(function(c,a){var b=c._private=c._private||{};
b.EditMergeBlocksDialog=(function(d){__extends(e,d);
function e(f){d.call(this);
this.DialogInfo={DialogType:b.HTMLDialogType.EditMergeBlocksDialog,ElementID:"editMergeBlocksDialog",Width:"auto",FileName:"Dialogs/MailMerge/EditMergeBlocksDialog.html",TitleResourceName:"EDIT_MERGE_BLOCKS_DIALOG_TITLE"};
this.blocks=f;
this.deletedBlocks=[];
this.renamedBlocks=[];
}e.prototype.closing=function(){this.dialogData.deletedBlocks=this.deletedBlocks;
this.dialogData.renamedBlocks=this.renamedBlocks;
};
e.prototype.populateSelect=function(){var f=document.getElementById("selMergeBlocks");
f.innerHTML="";
this.blocks.forEach(function(g){var h=(g.NewName!=="")?g.NewName:g.Name;
var i=document.createElement("option");
i.value=i.text=i.title=h;
f.appendChild(i);
});
f.selectedIndex=0;
};
e.prototype.goToSelectedBlock=function(){var g=document.getElementById("selMergeBlocks"),h=g.options[g.selectedIndex],f=this.blocks.find(function(i){return i.Name===h.value;
});
b.sendCommand(b.Command.GoToItem,b.ItemType.MergeBlock,0,0,f.Name);
};
e.prototype.renameSelectedBlock=function(){var n=this,k=document.getElementById("selMergeBlocks"),m=k.options[k.selectedIndex],g=this.blocks.find(function(i){if(i.NewName!==""){return i.NewName===m.value;
}else{return i.Name===m.value;
}});
if(g.NewName!==""){for(var l=0;
l<this.renamedBlocks.length;
++l){var f=this.renamedBlocks[l];
if(f.NewName===g.NewName){this.renamedBlocks.splice(l,1);
break;
}}}var h=(g.NewName!=="")?g.NewName:g.Name,j=new b.InputBoxDialog(b.variousMessages.txtRenameMergeBlock,h);
j.showModal(function(i){if(i!==""){g.NewName=i;
n.renamedBlocks.push(cloneObject(g));
n.populateSelect();
}});
};
e.prototype.deleteSelectedBlock=function(){var j=document.getElementById("selMergeBlocks"),l=j.options[j.selectedIndex],h=this.blocks;
for(var k=0;
k<h.length;
++k){var f=h[k],g=(f.NewName!=="")?f.NewName:f.Name;
if(g===l.value){this.deletedBlocks.push(f.Name);
h.splice(k,1);
this.populateSelect();
return;
}}};
e.prototype.dialogReady=function(){var i=this;
this.populateSelect();
function g(j){i.goToSelectedBlock();
}function h(j){i.renameSelectedBlock();
}function f(j){i.deleteSelectedBlock();
}a("#EDIT_MERGE_BLOCKS_DIALOG_BTN_GOTO").click(g);
a("#EDIT_MERGE_BLOCKS_DIALOG_BTN_RENAME").click(h);
a("#EDIT_MERGE_BLOCKS_DIALOG_BTN_DELETE").click(f);
};
e.prototype.applyStringResources=function(f){a("#EDIT_MERGE_BLOCKS_DIALOG_LBL_SEL_BLOCKS").text(f.EDIT_MERGE_BLOCKS_DIALOG_LBL_SEL_BLOCKS);
a("#EDIT_MERGE_BLOCKS_DIALOG_BTN_GOTO").text(f.EDIT_MERGE_BLOCKS_DIALOG_BTN_GOTO);
a("#EDIT_MERGE_BLOCKS_DIALOG_BTN_RENAME").text(f.EDIT_MERGE_BLOCKS_DIALOG_BTN_RENAME);
a("#EDIT_MERGE_BLOCKS_DIALOG_BTN_DELETE").text(f.EDIT_MERGE_BLOCKS_DIALOG_BTN_DELETE);
this.setDefaultBtnTexts(f);
};
return e;
})(b.HTMLDialog);
return c;
}(TXTextControl||{},j$1_10_2));
var TXTextControl=(function(c,a){var b=c._private=c._private||{};
b.SetChartDataRelationDialog=(function(d){__extends(h,d);
function h(i){d.call(this);
this.DialogInfo={DialogType:b.HTMLDialogType.SetChartDataRelationDialog,ElementID:"setChartDataRelationDialog",Width:"auto",FileName:"Dialogs/MailMerge/SetChartDataRelationDialog.html",TitleResourceName:"SET_CHART_DATA_REL_DLG_TITLE"};
this.dataSource=i.DataSource;
this.currentChartRelation=i.CurrentChartRelation;
this.mainTable=null;
}function f(j){var i=j.target;
var k=i.options[i.selectedIndex].value;
this.mainTable=this.dataSource.Tables.find(function(l){return l.TableName===k;
});
this.updateChildTableDropDown(k);
}function e(l){var i=l.target;
var k=i.options[i.selectedIndex].value;
var j=this.mainTable.ChildTables.find(function(m){return m.TableName===k;
});
g(j);
}function g(k){var i=document.getElementById("txDialog_cbAxisLabels");
var j=document.getElementById("txDialog_cbValues");
i.innerHTML="";
j.innerHTML="";
k.Columns.forEach(function(l){var m=document.createElement("option");
var n=document.createElement("option");
m.innerHTML=n.innerHTML=l.ColumnName;
m.value=n.value=l.ColumnName;
i.appendChild(m);
j.appendChild(n);
});
}h.prototype.updateChildTableDropDown=function(k){var i=document.getElementById("txDialog_cbChildTable");
var l=this.dataSource.Tables.find(function(m){return m.TableName===k;
});
if(!l){return;
}i.innerHTML="";
var j=document.createDocumentFragment();
l.ChildTables.forEach(function(n){var m=document.createElement("option");
m.innerHTML=n.TableName;
m.value=n.TableName;
j.appendChild(m);
});
i.appendChild(j);
g(l.ChildTables[0]);
};
h.prototype.populateComboboxes=function(){var l=document.getElementById("txDialog_cbMainTable");
var k=document.getElementById("txDialog_cbChildTable");
var m=document.createDocumentFragment();
this.dataSource.Tables.forEach(function(q){var i=document.createElement("option");
i.innerHTML=q.TableName;
i.value=q.TableName;
m.appendChild(i);
});
l.appendChild(m);
var j=false;
var o=this.dataSource.MasterTable.TableName;
for(var n=0;
n<l.options.length;
++n){var p=l.options[n].value;
if(o===p){l.selectedIndex=n;
j=true;
break;
}}if(!j){o=this.dataSource.Tables[0].TableName;
}o=l.options[l.selectedIndex].value;
this.mainTable=this.dataSource.Tables.find(function(i){return i.TableName===o;
});
this.updateChildTableDropDown(o);
l.addEventListener("change",f.bind(this));
k.addEventListener("change",e.bind(this));
};
h.prototype.closing=function(){if(this.dialogData.dialogResult){var j=document.getElementById("txDialog_cbChildTable");
var i=document.getElementById("txDialog_cbAxisLabels");
var k=document.getElementById("txDialog_cbValues");
this.dialogData.chartName=j.options[j.selectedIndex].value;
this.dialogData.chartAreaName=i.options[i.selectedIndex].value;
this.dialogData.seriesName=k.options[k.selectedIndex].value;
}};
h.prototype.dialogReady=function(){this.populateComboboxes();
};
h.prototype.applyStringResources=function(i){a("#txDialog_lblMainTbl").text(i.SET_CHART_DATA_REL_DLG_LBL_MAIN_TBL);
a("#txDialog_lblChildTbl").text(i.SET_CHART_DATA_REL_DLG_LBL_CHILD_TBL);
a("#txDialog_lblAxisLbls").text(i.SET_CHART_DATA_REL_DLG_LBL_AXIS_LBLS);
a("#txDialog_lblValues").text(i.SET_CHART_DATA_REL_DLG_LBL_VALUES);
this.setDefaultBtnTexts(i);
};
return h;
})(b.HTMLDialog);
return c;
}(TXTextControl||{},j$1_10_2));
var TXTextControl=(function(c,a){var b=c._private=c._private||{};
b.txDialog=null;
b.TxDialog=(function(){function d(g,e,f,h){this.dialogType=f;
this.initialImage=g;
this.caption=e;
this.dialogContainer=null;
this.depth=h?h.depth+1:0;
this.parentDialog=h||null;
this.childDialog=null;
this.viewer=null;
this.caretStateBuffer=null;
this.caretStateChangedBound=this.caretStateChanged.bind(this);
this.imageReceivedBound=this.imageReceived.bind(this);
this.imageRegionsUpdatedBound=this.imageRegionsUpdated.bind(this);
this.dialogClosedBound=this.dialogClosed.bind(this);
this.loadedBound=this.loaded.bind(this);
}d.prototype.close=function(e,f){f=f||false;
if(!this.parentDialog){document.removeEventListener("dialogCaretStateChanged",this.caretStateChangedBound);
document.removeEventListener("txDialogImageReceived",this.imageReceivedBound);
document.removeEventListener("txDialogImageRegionsUpdated",this.imageRegionsUpdatedBound);
document.removeEventListener("txDialogClosed",this.dialogClosedBound);
}if(!f){b.sendCommand(b.Command.CloseDialog,this.depth);
}a(e).dialog("destroy").remove();
this.dialogContainer.remove();
b.mouseOwner=null;
if(!this.parentDialog){b.txDialog=null;
if(!b.isTouchDevice){b.textViewer.focus();
}}else{this.parentDialog.childDialog=null;
if(!b.isTouchDevice){this.parentDialog.focus();
}}};
d.prototype.dialogReady=function(){var g=document.getElementById("txDialogContent");
g.id=g.id+"_"+this.depth;
this.viewer=new b.ComponentViewer(g,b.ComponentType.TxDialog,this.dialogType,this.depth);
this.viewer.setImage(this.initialImage,true);
delete this.initialImage;
if(this.caretStateBuffer){this.viewer.setCaretState(this.caretStateBuffer);
this.caretStateBuffer=null;
}var f=a("#txDialog"),i=f.css("margin-left"),e={width:f.css("border-left-width"),color:f.css("border-left-color"),style:f.css("border-left-style")};
f.css("border-bottom-width",e.width);
f.css("border-bottom-style",e.style);
f.css("border-bottom-color",e.color);
f.css("margin-bottom",i);
var h=document.getElementById("txDialog");
h.id=h.id+"_"+this.depth;
a("div.txui-dialog button.txui-dialog-titlebar-close").blur();
if(!b.isTouchDevice){this.viewer.focus();
}};
d.prototype.dialogize=function(){var e=this;
a("#txDialog").dialog({modal:true,resizable:false,width:"auto",height:"auto",title:this.caption,buttons:{},close:function(){e.close(this);
},}).keypress(function(f){if(f.keyCode==a.ui.keyCode.ENTER){}});
this.dialogReady();
};
d.prototype.showChildDialog=function(f,e){if(this.childDialog){this.childDialog.showChildDialog(f,e);
}else{this.childDialog=new d(f,e,b.TXDialogType.ChildDialog,this);
this.childDialog.showModal();
}};
d.prototype.caretStateChanged=function(f){var g=f.detail;
if(this.depth<g.nestingDepth){this.childDialog.caretStateChanged(f);
}else{if(g.dialogType==this.dialogType){if(this.viewer){this.viewer.setCaretState(g.caretState);
}else{this.caretStateBuffer=g.caretState;
}}}};
d.prototype.dialogClosed=function(f){var g=f.detail;
if(this.depth<g.nestingDepth){if(this.childDialog){this.childDialog.dialogClosed(f);
}}else{if(g.dialogType==this.dialogType){this.close(a("#txDialog_"+this.depth),true);
}}};
d.prototype.imageReceived=function(f){var g=f.detail;
if(this.depth<g.nestingDepth){this.childDialog.imageReceived(f);
}else{if(g.dialogType==this.dialogType){if(this.viewer){this.viewer.setImage(g.data);
}}}};
d.prototype.imageRegionsUpdated=function(f){var g=f.detail;
if(this.depth<g.nestingDepth){this.childDialog.imageRegionsUpdated(f);
}else{if(g.dialogType==this.dialogType){this.viewer.updateImageRegions(g.tiles);
}}};
d.prototype.loaded=function(){this.dialogize();
if(!this.parentDialog){document.addEventListener("dialogCaretStateChanged",this.caretStateChangedBound);
document.addEventListener("txDialogImageReceived",this.imageReceivedBound);
document.addEventListener("txDialogImageRegionsUpdated",this.imageRegionsUpdatedBound);
document.addEventListener("txDialogClosed",this.dialogClosedBound);
}};
d.prototype.getActiveViewer=function(){if(!this.childDialog){return this.viewer;
}else{return this.childDialog.getActiveViewer();
}};
d.prototype.focus=function(){if(!this.childDialog){this.viewer.focus();
}else{this.childDialog.focus();
}};
d.prototype.blur=function(){if(!this.childDialog){this.viewer.blur();
}else{this.childDialog.blur();
}};
d.prototype.showModal=function(){var g="txDlgContainer_"+this.depth,e=document.getElementById("txTemplateDesignerContainer"),f=document.createElement("div");
f.id=g;
e.appendChild(f);
var h=b.getTXFileDir();
this.dialogContainer=a("#"+g);
this.dialogContainer.load(h+"Dialogs/TxDialog.html",this.loadedBound);
};
return d;
})();
return c;
}(TXTextControl||{},j$1_10_2));
var TXTextControl=(function(d,a){var b=d._private=d._private||{};
b.ColorPalette=[4278190080,4288230144,4281545472,4278203136,4278203238,4278190208,4281545625,4281545523,4286578688,4294927872,4286611456,4278222848,4278222976,4278190335,4284901017,4286611584,4294901760,4294940928,4288269312,4281571686,4281584844,4281558783,4286578816,4288256409,4294902015,4294953984,4294967040,4278255360,4278255615,4278242559,4288230246,4290822336,4294941132,4294954137,4294967193,4291624908,4291624959,4288269567,4291598847,4294967295];
function c(f,e){var i=document.createElement("li");
var h=document.createElement("div");
i.style.position="relative";
i.style.width="16px";
i.style.height="16px";
i.style.cssFloat="left";
i.style.clear=e?"left":"none";
i.style.padding="2px";
i.style.marginLeft=e?"3px":"2px";
i.style.display="block";
i.style.overflow="hidden";
var g=document.createElement("a");
h.style.position="relative";
h.style.width="14px";
h.style.height="14px";
h.style.border="1px solid lightgray";
h.style.overflow="hidden";
h.style.background=h.style.color=b.toCSSColor(f);
h.textContent=".";
g.appendChild(h);
i.appendChild(g);
var j=b.toColorObject(f);
i.txColor=j;
i.dataset.tag=JSON.stringify(j);
return i;
}b.makeSmallColorButtons=function(){var g,h,e=[];
for(h=0;
h<5;
++h){for(g=0;
g<8;
++g){var k=(8*h)+g;
var f=b.ColorPalette[k];
e.push(c(f,(g==0)));
}}return e;
};
b.MinColorPickerMenuWidth=180;
b.generateColorPalette=function(h,j){var g,e;
j=j||0;
if(!h){return;
}h.style.minWidth=b.MinColorPickerMenuWidth+"px";
j=Math.min(h.children.length-1,j);
e=b.makeSmallColorButtons();
for(g=(e.length-1);
g>=0;
--g){var f=e[g];
h.insertBefore(f,h.children[j]);
}};
b.toCSSColor=function(g){var e=b.toColorObject(g),f="rgba("+e.r+", "+e.g+", "+e.b+", "+(e.a/255)+")";
return f;
};
b.toColorObject=function(f){var e={a:(f>>>24),r:(f>>>16)&255,g:(f>>>8)&255,b:f&255};
return e;
};
return d;
}(TXTextControl||{},j$1_10_2));
var TXTextControl=(function(ax,a){var m=ax._private=ax._private||{},s,r,b,h,d,c,k,n,j,i,o,t,e=null,l=null,f=10,g="",q="#000000",p="#FFFFFF";
m.InputFormatProperty={AllFrameLines:0,Bold:1,BottomDistance:2,BottomFrameLine:3,BoxFrame:4,BulletCharacter:5,BulletedList:6,Centered:7,FontFamily:8,FontSize:9,HangingIndent:10,InnerHorizontalFrameLines:11,InnerVerticalFrameLines:12,Italic:13,Justified:14,LeftAligned:15,LeftFrameLine:16,LeftIndent:17,LineSpacing:18,NumberedList:19,NumberedListFormat:20,NumberFormats:21,RightAligned:22,RightFrameLine:23,RightIndent:24,LeftToRight:25,RightToLeft:26,Strikeout:27,StructuredList:28,StructuredListFormat:29,StyleName:30,StyleNames:31,Subscript:32,Superscript:33,TextBackColor:34,TextColor:35,TopDistance:36,TopFrameLine:37,Underline:38,UnderlineStyle:39,UnderlineStyles:40,BottomAligned:41,FrameFillColor:42,FrameLineColor:43,FrameLineWidth:44,TopAligned:45,VerticallyCentered:46};
m.TxProperty=Object.freeze({SelectObjects:1});
m.lastInputFormat={topDist:0,botDist:0,leftInd:0,rightInd:0};
m.ClipboardFormatButton={FormattedText:1,UnformattedText:2,Image:3,TextFrame:4,Chart:5,Barcode:6,Drawing:7};
m.lastClipbBtnState={client:{copy:false,paste:false},server:{copy:false,paste:false}};
m.attachHomeTabEventHandlers=function(){var aI;
var aE;
A();
s=a("#textHighlightColorDropDown").menu().hide();
r=a("#textColorDropDown").menu().hide();
b=a("#backColorDropDown").menu().hide();
h=a("#frameColorDropDown").menu().hide();
c=a("#bordersDropDown").menu().hide();
d=a("#bulletListDropDown").menu().hide();
k=a("#numberedListDropDown").menu().hide();
n=a("#structuredListDropDown").menu().hide();
j=a("#lineSpacingDropDown").menu().hide();
i=a("#frameLineWidthDropDown").menu().hide();
o=a("#stylesDropDown").menu().hide();
t=a("#ulStylesDropDown").menu().hide();
if(m.isTouchDevice){l=a("#pasteDropDown").menu().hide();
}else{e=a("#clipboardFormatDropDown").menu().hide();
}s.on("menuselect",ad);
r.on("menuselect",ac);
b.on("menuselect",D);
h.on("menuselect",V);
c.on("menuselect",E);
d.on("menuselect",H);
k.on("menuselect",Y);
n.on("menuselect",aa);
j.on("menuselect",X);
i.on("menuselect",W);
o.on("menuselect",ab);
t.on("menuselect",ae);
if(m.isTouchDevice){l.on("menuselect",Z);
}else{e.on("menuselect",I);
}document.addEventListener("fontListReceived",y);
document.addEventListener("fontSizesReceived",z);
document.addEventListener("inputFormatReceived",C);
document.addEventListener("styleNameChanged",ak);
document.addEventListener("styleNamesChanged",al);
document.addEventListener("underlineStyleChanged",ay);
document.addEventListener("clipboardFormatsReceived",u);
var aF=document.getElementById("selectFont");
aF.addEventListener("click",aj);
aF.addEventListener("change",function(){var aJ=this.value;
if(aJ){m.sendCommand(m.Command.InputFormat,m.InputFormatProperty.FontFamily,0,0,aJ);
}if(!m.isTouchDevice){m.textViewer.focus();
}});
var aG=document.getElementById("selectFontSize");
aG.addEventListener("click",aj);
aG.addEventListener("change",function(){var aK=this.value;
if(aK){var aJ=parseInt(aK,10);
m.sendCommand(m.Command.InputFormat,m.InputFormatProperty.FontSize,aJ);
}if(!m.isTouchDevice){m.textViewer.focus();
}});
a("#btnUndo").click(function(){if(!a(this).hasClass("txui-state-disabled")){m.sendCommand(m.Command.Undo);
}});
a("#btnRedo").click(function(){if(!a(this).hasClass("txui-state-disabled")){m.sendCommand(m.Command.Redo);
}});
a("#btnFind").click(function(){m.sendCommand(m.Command.ShowDialog,m.DialogCategory.TXDialog,m.TXDialogType.FindDialog);
});
a("#btnReplace").click(function(){m.sendCommand(m.Command.ShowDialog,m.DialogCategory.TXDialog,m.TXDialogType.ReplaceDialog);
});
a("#btnSelectAll").click(function(){m.sendCommand(m.Command.SelectAll);
});
var aD=document.getElementById("btnSelectObjects");
aD.addEventListener("click",function(aJ){var aK=document.getElementById("tglBtnSelectObjects");
if(aK.classList.contains("ribbon-button-selected")){aI=0;
}else{aI=1;
}m.sendCommand(m.Command.SetTxProperty,m.TxProperty.SelectObjects,aI);
});
a("#btnCut").click(function(){if(!a(this).hasClass("txui-state-disabled")){m.sendCommand(m.Command.Cut);
}});
a("#btnCopy").click(function(){if(!a(this).hasClass("txui-state-disabled")){m.sendCommand(m.Command.Copy);
}});
if(m.isTouchDevice){a("#btnPaste").click(R);
}else{a("#btnPaste").click(Q);
}if(!m.isTouchDevice){var aH=document.getElementById("tglBtnLocalClipboard");
aH.addEventListener("click",am);
}a("#btnFontGrow").click(function(){m.sendCommand(m.Command.GrowFont);
});
a("#btnFontShrink").click(function(){m.sendCommand(m.Command.ShrinkFont);
});
a("#tglBtnBold").click(function(){if(a(this).hasClass("ribbon-button-selected")){aI=0;
}else{aI=1;
}m.sendCommand(m.Command.InputFormat,m.InputFormatProperty.Bold,aI);
});
a("#tglBtnItalic").click(function(){if(a(this).hasClass("ribbon-button-selected")){aI=0;
}else{aI=1;
}m.sendCommand(m.Command.InputFormat,m.InputFormatProperty.Italic,aI);
});
a("#drpDnBtnUnderlineStyles").click(U);
a("#tglBtnStrikethrough").click(function(){if(a(this).hasClass("ribbon-button-selected")){aI=0;
}else{aI=1;
}m.sendCommand(m.Command.InputFormat,m.InputFormatProperty.Strikeout,aI);
});
a("#tglBtnSubscript").click(function(){if(a(this).hasClass("ribbon-button-selected")){aI=0;
}else{aI=1;
}m.sendCommand(m.Command.InputFormat,m.InputFormatProperty.Subscript,aI);
});
a("#tglBtnSuperscript").click(function(){if(a(this).hasClass("ribbon-button-selected")){aI=0;
}else{aI=1;
}m.sendCommand(m.Command.InputFormat,m.InputFormatProperty.Superscript,aI);
});
a("#drpDnBtnTextHighlightColor").click(G);
a("#drpDnBtnTextColor").click(F);
a("#drpDnBtnBulletList").click(L);
a("#drpDnBtnNumberedList").click(P);
a("#drpDnBtnStructuredList").click(S);
a("#btnIndentDecrease").click(function(){m.sendCommand(m.Command.DecreaseIndent);
});
a("#btnIndentIncrease").click(function(){m.sendCommand(m.Command.IncreaseIndent);
});
a("#tglBtnTextDirLTR").click(function(){if(!a(this).hasClass("ribbon-button-selected")){m.sendCommand(m.Command.InputFormat,m.InputFormatProperty.RightToLeft,0);
}});
a("#tglBtnTextDirRTL").click(function(){if(!a(this).hasClass("ribbon-button-selected")){m.sendCommand(m.Command.InputFormat,m.InputFormatProperty.RightToLeft,1);
}});
a("#btnTabs").click(function(){m.sendCommand(m.Command.ShowDialog,m.DialogCategory.TXDialog,m.TXDialogType.TabDialog);
});
a("#tglBtnControlChars").click(function(){if(a(this).hasClass("ribbon-button-selected")){aI=0;
a(this).removeClass("ribbon-button-selected");
}else{aI=1;
a(this).addClass("ribbon-button-selected");
}m.sendCommand(m.Command.DisplayVisualElement,m.VisualElement.ControlChars,aI);
});
a("#tglBtnAlignLeft").click(function(){if(a(this).hasClass("ribbon-button-selected")){aI=0;
}else{aI=1;
}m.sendCommand(m.Command.InputFormat,m.InputFormatProperty.LeftAligned,aI);
});
a("#tglBtnAlignCenter").click(function(){if(a(this).hasClass("ribbon-button-selected")){aI=0;
}else{aI=1;
}m.sendCommand(m.Command.InputFormat,m.InputFormatProperty.Centered,aI);
});
a("#tglBtnAlignRight").click(function(){if(a(this).hasClass("ribbon-button-selected")){aI=0;
}else{aI=1;
}m.sendCommand(m.Command.InputFormat,m.InputFormatProperty.RightAligned,aI);
});
a("#tglBtnAlignJust").click(function(){if(a(this).hasClass("ribbon-button-selected")){aI=0;
}else{aI=1;
}m.sendCommand(m.Command.InputFormat,m.InputFormatProperty.Justified,aI);
});
a("#drpDnBtnLineSpacing").click(O);
a("#drpDnBtnBorders").click(K);
a("#drpDnBtnStyles").click(T);
a("#drpDnBtnFrameLineWidth").click(N);
a("#drpDnBtnBackColor").click(J);
a("#drpDnBtnFrameColor").click(M);
};
function A(){var aD=document.getElementById("textHighlightColorDropDown");
m.generateColorPalette(aD,1);
aD=document.getElementById("textColorDropDown");
m.generateColorPalette(aD,1);
aD=document.getElementById("backColorDropDown");
m.generateColorPalette(aD,1);
aD=document.getElementById("frameColorDropDown");
m.generateColorPalette(aD,1);
}m.isFontListPresent=false;
function y(aD){var aE=aD.detail.fontNames;
aE.forEach(function(aG){var aF=document.createElement("option");
aF.text=aG;
a("#selectFont").append(aF);
});
m.isFontListPresent=true;
}function z(aD){var aF=aD.detail.fontSizes,aE=a("#selectFontSize");
aE.empty();
aF.forEach(function(aH){var aG=document.createElement("option");
aG.text=aH;
aE.append(aG);
});
}function C(aD){var aF=aD.detail;
if(aF.hasOwnProperty("Bold")){B(m.InputFormatProperty.Bold,aF.Bold);
}if(aF.hasOwnProperty("Italic")){B(m.InputFormatProperty.Italic,aF.Italic);
}if(aF.hasOwnProperty("Underline")){B(m.InputFormatProperty.Underline,aF.Underline);
}if(aF.hasOwnProperty("UnderlineStyle")){B(m.InputFormatProperty.UnderlineStyle,aF.UnderlineStyle);
}if(aF.hasOwnProperty("Strikeout")){B(m.InputFormatProperty.Strikeout,aF.Strikeout);
}if(aF.hasOwnProperty("LeftAligned")){B(m.InputFormatProperty.LeftAligned,aF.LeftAligned);
}if(aF.hasOwnProperty("Centered")){B(m.InputFormatProperty.Centered,aF.Centered);
}if(aF.hasOwnProperty("RightAligned")){B(m.InputFormatProperty.RightAligned,aF.RightAligned);
}if(aF.hasOwnProperty("Justified")){B(m.InputFormatProperty.Justified,aF.Justified);
}if(aF.hasOwnProperty("RightToLeft")){B(m.InputFormatProperty.RightToLeft,aF.RightToLeft);
}if(aF.hasOwnProperty("FontFamily")){B(m.InputFormatProperty.FontFamily,0,aF.FontFamily);
}if(aF.hasOwnProperty("FontSize")){B(m.InputFormatProperty.FontSize,aF.FontSize);
}if(aF.hasOwnProperty("StyleName")){B(m.InputFormatProperty.StyleName,0,aF.StyleName);
}if(aF.hasOwnProperty("StyleNames")){B(m.InputFormatProperty.StyleNames,aF.StyleNames);
}if(aF.hasOwnProperty("BulletedList")){B(m.InputFormatProperty.BulletedList,aF.BulletedList);
}if(aF.hasOwnProperty("BulletCharacter")){B(m.InputFormatProperty.BulletCharacter,0,aF.BulletCharacter||"");
}if(aF.hasOwnProperty("NumberedList")){B(m.InputFormatProperty.NumberedList,aF.NumberedList);
}if(aF.hasOwnProperty("NumberedListFormat")){B(m.InputFormatProperty.NumberedListFormat,aF.NumberedListFormat);
}if(aF.hasOwnProperty("StructuredList")){B(m.InputFormatProperty.StructuredList,aF.StructuredList);
}if(aF.hasOwnProperty("StructuredListFormat")){B(m.InputFormatProperty.StructuredListFormat,aF.StructuredListFormat);
}if(aF.hasOwnProperty("LeftFrameLine")){B(m.InputFormatProperty.LeftFrameLine,aF.LeftFrameLine);
}if(aF.hasOwnProperty("TopFrameLine")){B(m.InputFormatProperty.TopFrameLine,aF.TopFrameLine);
}if(aF.hasOwnProperty("RightFrameLine")){B(m.InputFormatProperty.RightFrameLine,aF.RightFrameLine);
}if(aF.hasOwnProperty("BottomFrameLine")){B(m.InputFormatProperty.BottomFrameLine,aF.BottomFrameLine);
}if(aF.hasOwnProperty("BoxFrame")){B(m.InputFormatProperty.BoxFrame,aF.BoxFrame);
}if(aF.hasOwnProperty("AllFrameLines")){B(m.InputFormatProperty.AllFrameLines,aF.AllFrameLines);
}if(aF.hasOwnProperty("InnerHorizontalFrameLines")){B(m.InputFormatProperty.InnerHorizontalFrameLines,aF.InnerHorizontalFrameLines);
}if(aF.hasOwnProperty("InnerVerticalFrameLines")){B(m.InputFormatProperty.InnerVerticalFrameLines,aF.InnerVerticalFrameLines);
}if(aF.hasOwnProperty("TextColor")){B(m.InputFormatProperty.TextColor,aF.TextColor);
}if(aF.hasOwnProperty("TextBackColor")){B(m.InputFormatProperty.TextBackColor,aF.TextBackColor);
}if(aF.hasOwnProperty("Subscript")){B(m.InputFormatProperty.Subscript,aF.Subscript);
}if(aF.hasOwnProperty("Superscript")){B(m.InputFormatProperty.Superscript,aF.Superscript);
}if(aF.hasOwnProperty("LineSpacing")){B(m.InputFormatProperty.LineSpacing,aF.LineSpacing);
}if(aF.hasOwnProperty("TopDistance")){B(m.InputFormatProperty.TopDistance,aF.TopDistance);
}if(aF.hasOwnProperty("BottomDistance")){B(m.InputFormatProperty.BottomDistance,aF.BottomDistance);
}if(aF.hasOwnProperty("LeftIndent")){B(m.InputFormatProperty.LeftIndent,aF.LeftIndent);
}if(aF.hasOwnProperty("RightIndent")){B(m.InputFormatProperty.RightIndent,aF.RightIndent);
}if(aF.hasOwnProperty("BottomAligned")){B(m.InputFormatProperty.BottomAligned,aF.BottomAligned);
}if(aF.hasOwnProperty("FrameFillColor")){B(m.InputFormatProperty.FrameFillColor,aF.FrameFillColor);
}if(aF.hasOwnProperty("FrameLineColor")){B(m.InputFormatProperty.FrameLineColor,aF.FrameLineColor);
}if(aF.hasOwnProperty("FrameLineWidth")){B(m.InputFormatProperty.FrameLineWidth,aF.FrameLineWidth);
}if(aF.hasOwnProperty("TopAligned")){B(m.InputFormatProperty.TopAligned,aF.TopAligned);
}if(aF.hasOwnProperty("VerticallyCentered")){B(m.InputFormatProperty.VerticallyCentered,aF.VerticallyCentered);
}if(aF.hasOwnProperty("PageSize")&&aF.PageSize){var aE=new CustomEvent("pageSizeChanged",{detail:aF.PageSize});
document.dispatchEvent(aE);
}if(!m.isRibbonFadedIn&&m.isFontListPresent&&m.areRibbonIconsLoaded){m.fadeInRibbon();
}}function ah(aF,aH){var aD=document.getElementById(aF);
if(!aD){return;
}if(aD.tagName!=="SELECT"){return;
}for(var aE=0;
aE<aD.options.length;
++aE){var aG=aD.options[aE];
if(aG.value===aH){aG.selected=true;
break;
}}}function aj(aD){aD.stopPropagation();
}function B(aH,aN,aM){var aG;
var aF=null;
switch(aH){case m.InputFormatProperty.Bold:aF=[a("#tglBtnBold")];
break;
case m.InputFormatProperty.Italic:aF=[a("#tglBtnItalic")];
break;
case m.InputFormatProperty.UnderlineStyle:aG=new CustomEvent("underlineStyleChanged",{detail:aN});
document.dispatchEvent(aG);
break;
case m.InputFormatProperty.Strikeout:aF=[a("#tglBtnStrikethrough")];
break;
case m.InputFormatProperty.LeftAligned:aF=[a("#tglBtnAlignLeft")];
break;
case m.InputFormatProperty.Centered:aF=[a("#tglBtnAlignCenter")];
break;
case m.InputFormatProperty.RightAligned:aF=[a("#tglBtnAlignRight")];
break;
case m.InputFormatProperty.Justified:aF=[a("#tglBtnAlignJust")];
break;
case m.InputFormatProperty.RightToLeft:var aE=a("#tglBtnTextDirRTL");
var aD=a("#tglBtnTextDirLTR");
if(aN){aE.addClass("ribbon-button-selected");
aD.removeClass("ribbon-button-selected");
}else{aE.removeClass("ribbon-button-selected");
aD.addClass("ribbon-button-selected");
}break;
case m.InputFormatProperty.FontFamily:aM=aM||"";
ah("selectFont",aM);
break;
case m.InputFormatProperty.FontSize:aN=aN||0;
f=aN/20;
ah("selectFontSize",""+f);
break;
case m.InputFormatProperty.StyleName:aG=new CustomEvent("styleNameChanged",{detail:aM});
document.dispatchEvent(aG);
break;
case m.InputFormatProperty.StyleNames:aG=new CustomEvent("styleNamesChanged",{detail:aN});
document.dispatchEvent(aG);
break;
case m.InputFormatProperty.BulletedList:aF=[a("#drpDnBtnBulletList")];
break;
case m.InputFormatProperty.BulletCharacter:an(aM);
break;
case m.InputFormatProperty.NumberedList:aF=[a("#drpDnBtnNumberedList")];
break;
case m.InputFormatProperty.NumberedListFormat:at(aN);
break;
case m.InputFormatProperty.StructuredList:aF=[a("#drpDnBtnStructuredList")];
break;
case m.InputFormatProperty.StructuredListFormat:au(aN);
break;
case m.InputFormatProperty.LeftFrameLine:aF=[a("#tglBtnBorderLeft"),a("#tglBtnTblFrameLeft")];
break;
case m.InputFormatProperty.TopFrameLine:aF=[a("#tglBtnBorderTop"),a("#tglBtnTblFrameTop")];
break;
case m.InputFormatProperty.RightFrameLine:aF=[a("#tglBtnBorderRight"),a("#tglBtnTblFrameRight")];
break;
case m.InputFormatProperty.BottomFrameLine:aF=[a("#tglBtnBorderBottom"),a("#tglBtnTblFrameBottom")];
break;
case m.InputFormatProperty.BoxFrame:aF=[a("#drpDnBtnBorders"),a("#tglBtnBorderOutside"),a("#tglBtnTblFrameOutside")];
break;
case m.InputFormatProperty.AllFrameLines:aF=[a("#tglBtnBorderAll"),a("#tglBtnTblFrameAll")];
break;
case m.InputFormatProperty.InnerHorizontalFrameLines:aF=[a("#tglBtnBorderInsideHor"),a("#tglBtnTblFrameInsideHor")];
break;
case m.InputFormatProperty.InnerVerticalFrameLines:aF=[a("#tglBtnBorderInsideVert"),a("#tglBtnTblFrameInsideVert")];
break;
case m.InputFormatProperty.TextColor:if(aN){q=v(aN);
}else{q="#000000";
}aw(aN);
aC(aN);
break;
case m.InputFormatProperty.TextBackColor:if(aN){p=v(aN);
}else{p="#FFFFFF";
}av(aN);
aB(aN);
break;
case m.InputFormatProperty.Subscript:aF=[a("#tglBtnSubscript")];
break;
case m.InputFormatProperty.Superscript:aF=[a("#tglBtnSuperscript")];
break;
case m.InputFormatProperty.LineSpacing:ar(aN);
break;
case m.InputFormatProperty.TopDistance:var aJ=document.getElementById("numParIndBefore");
if(!aJ){break;
}if(aN===null){aJ.value=null;
break;
}aN=parseFloat(m.twips2mm(aN).toFixed(1));
m.lastInputFormat.topDist=aN;
if(isInteger(aN)){aJ.value=Math.round(aN);
}else{aJ.value=aN.toFixed(1);
}break;
case m.InputFormatProperty.BottomDistance:var aI=document.getElementById("numParIndAfter");
if(!aI){break;
}if(aN===null){aI.value=null;
break;
}aN=parseFloat(m.twips2mm(aN).toFixed(1));
m.lastInputFormat.botDist=aN;
if(isInteger(aN)){aI.value=Math.round(aN);
}else{aI.value=aN.toFixed(1);
}break;
case m.InputFormatProperty.LeftIndent:var aK=document.getElementById("numParIndLeft");
if(!aK){break;
}if(aN===null){aK.value=null;
break;
}aN=parseFloat(m.twips2mm(aN).toFixed(1));
m.lastInputFormat.leftInd=aN;
if(isInteger(aN)){aK.value=Math.round(aN);
}else{aK.value=aN.toFixed(1);
}break;
case m.InputFormatProperty.RightIndent:var aL=document.getElementById("numParIndRight");
if(!aL){break;
}if(aN===null){aL.value=null;
break;
}aN=parseFloat(m.twips2mm(aN).toFixed(1));
m.lastInputFormat.rightInd=aN;
if(isInteger(aN)){aL.value=Math.round(aN);
}else{aL.value=aN.toFixed(1);
}break;
case m.InputFormatProperty.FrameFillColor:ao(aN);
az(aN);
m.updateTableBackgroundColorMenu(aN);
break;
case m.InputFormatProperty.FrameLineColor:ap(aN);
aA(aN);
m.updateTableFrameLineColorMenu(aN);
break;
case m.InputFormatProperty.FrameLineWidth:aq(aN);
m.updateTableFrameLineWidthMenu(aN);
break;
}if(aF){aF.forEach(function(aO){if(aN){aO.addClass("ribbon-button-selected");
}else{aO.removeClass("ribbon-button-selected");
}});
}switch(aH){case m.InputFormatProperty.LeftAligned:case m.InputFormatProperty.Centered:case m.InputFormatProperty.RightAligned:case m.InputFormatProperty.Justified:case m.InputFormatProperty.TopAligned:case m.InputFormatProperty.VerticallyCentered:case m.InputFormatProperty.BottomAligned:m.updateTableAlignButtonState(aH,aN);
break;
}}function ak(aD){var aE=aD.detail;
g=aE;
ag();
}function al(aD){var aE=aD.detail;
af(aE);
a("#stylesDropDown").menu("refresh");
}function ay(aD){var aE=aD.detail,aF=false;
a("#ulStylesDropDown div.ribbon-button-checkmark").removeClass("ribbon-button-selected");
switch(aE){case m.FontUnderlineStyle.Single:a("#tglBtnULStyleSingle").addClass("ribbon-button-selected");
aF=true;
break;
case m.FontUnderlineStyle.Doubled:a("#tglBtnULStyleDoubled").addClass("ribbon-button-selected");
aF=true;
break;
case m.FontUnderlineStyle.SingleWordsOnly:a("#tglBtnULStyleSingleWO").addClass("ribbon-button-selected");
aF=true;
break;
case m.FontUnderlineStyle.DoubledWordsOnly:a("#tglBtnULStyleDoubledWO").addClass("ribbon-button-selected");
aF=true;
break;
}if(aF){a("#drpDnBtnUnderlineStyles").addClass("ribbon-button-selected");
}else{a("#drpDnBtnUnderlineStyles").removeClass("ribbon-button-selected");
}}function u(aD){var aE=aD.detail;
var aG;
var aF=document.querySelectorAll("#clipboardFormatDropDown > li");
[].forEach.call(aF,function(aH){aH.classList.add("txui-state-disabled");
});
aF=document.querySelectorAll("#clipboardFormatDropDown > li[data-format-names]");
[].forEach.call(aF,function(aH){aG=aH.dataset.formatNames.split(/[\s,]+/);
if(aE.some(function(aI){return aG.some(function(aJ){return aJ===aI;
});
})){aH.classList.remove("txui-state-disabled");
}});
}function R(aE){m.fileMenu.hide();
m.hideAllMenus_homeTab();
var aD=document.getElementById("pasteDropDown");
m.calcMenuWidths(aD);
l.show().position({my:"left top",at:"left bottom",of:aE.currentTarget});
a(document).one("click",function(){l.hide();
});
return false;
}function Q(aE){m.fileMenu.hide();
m.hideAllMenus_homeTab();
var aD=document.getElementById("clipboardFormatDropDown");
m.calcMenuWidths(aD);
m.sendCommand(m.Command.GetClipboardFormats);
e.show().position({my:"left top",at:"left bottom",of:aE.currentTarget});
a(document).one("click",function(){e.hide();
});
return false;
}function Z(aE,aF){switch(aF.item.context.id){case"mnuItemServerPaste":m.sendCommand(m.Command.Paste);
break;
case"mnuItemClientPaste":var aD=new m.ClientPasteDialog();
aD.showModal();
break;
}}function am(aE){var aD=null;
switch(m.clipboardMode){case m.ClipboardMode.Server:aD=m.ClipboardMode.Client;
break;
case m.ClipboardMode.Client:aD=m.ClipboardMode.Server;
break;
}if(aD!==null){m.sendCommand(m.Command.ClipboardMode,aD);
}}function G(aD){m.fileMenu.hide();
m.hideAllMenus_homeTab();
var aE=document.getElementById("textHighlightColorDropDown");
m.calcMenuWidths(aE);
s.show().position({my:"left top",at:"left bottom",of:aD.currentTarget});
a(document).one("click",function(){s.hide();
});
return false;
}function ad(aF,aG){var aE=aG.item.context;
if(aE.hasOwnProperty("txColor")){var aD=aE.txColor;
m.sendCommand(m.Command.InputFormat,m.InputFormatProperty.TextBackColor,0,0,{color:aD,isAuto:false});
}else{switch(aE.id){case"mnuItemTextHighlightColorAutomatic":m.sendCommand(m.Command.InputFormat,m.InputFormatProperty.TextBackColor,0,0,{color:null,isAuto:true});
break;
case"mnuItemTextHighlightColorMoreColors":m.sendCommand(m.Command.ShowDialog,m.DialogCategory.TXDialog,m.TXDialogType.TextBackColorDialog);
break;
}}}function F(aD){m.fileMenu.hide();
m.hideAllMenus_homeTab();
var aE=document.getElementById("textColorDropDown");
m.calcMenuWidths(aE);
r.show().position({my:"left top",at:"left bottom",of:aD.currentTarget});
a(document).one("click",function(){r.hide();
});
return false;
}function ac(aF,aG){var aE=aG.item.context;
if(aE.hasOwnProperty("txColor")){var aD=aE.txColor;
m.sendCommand(m.Command.InputFormat,m.InputFormatProperty.TextColor,0,0,{color:aD,isAuto:false});
}else{switch(aE.id){case"mnuItemTextColorAutomatic":m.sendCommand(m.Command.InputFormat,m.InputFormatProperty.TextColor,0,0,{color:null,isAuto:true});
break;
case"mnuItemTextColorMoreColors":m.sendCommand(m.Command.ShowDialog,m.DialogCategory.TXDialog,m.TXDialogType.ForeColorDialog);
break;
}}}function J(aD){m.fileMenu.hide();
m.hideAllMenus_homeTab();
var aE=document.getElementById("backColorDropDown");
m.calcMenuWidths(aE);
b.show().position({my:"left top",at:"left bottom",of:aD.currentTarget});
a(document).one("click",function(){b.hide();
});
return false;
}function D(aF,aG){var aE=aG.item.context;
if(aE.hasOwnProperty("txColor")){var aD=aE.txColor;
m.sendCommand(m.Command.InputFormat,m.InputFormatProperty.FrameFillColor,0,0,{color:aD,isAuto:false});
}else{switch(aE.id){case"mnuItemBackColorAutomatic":m.sendCommand(m.Command.InputFormat,m.InputFormatProperty.FrameFillColor,0,0,{color:null,isAuto:true});
break;
case"mnuItemBackColorMoreColors":m.sendCommand(m.Command.ShowDialog,m.DialogCategory.TXDialog,m.TXDialogType.FrameFillColorDialog);
break;
}}}function M(aD){m.fileMenu.hide();
m.hideAllMenus_homeTab();
var aE=document.getElementById("frameColorDropDown");
m.calcMenuWidths(aE);
h.show().position({my:"left top",at:"left bottom",of:aD.currentTarget});
a(document).one("click",function(){h.hide();
});
return false;
}function V(aF,aG){var aE=aG.item.context;
if(aE.hasOwnProperty("txColor")){var aD=aE.txColor;
m.sendCommand(m.Command.InputFormat,m.InputFormatProperty.FrameLineColor,0,0,{color:aD,isAuto:false});
}else{switch(aE.id){case"mnuItemFrameColorAutomatic":m.sendCommand(m.Command.InputFormat,m.InputFormatProperty.FrameLineColor,0,0,{color:null,isAuto:true});
break;
case"mnuItemFrameColorMoreColors":m.sendCommand(m.Command.ShowDialog,m.DialogCategory.TXDialog,m.TXDialogType.FrameLineColorDialog);
break;
}}}function K(aD){m.fileMenu.hide();
m.hideAllMenus_homeTab();
var aE=document.getElementById("bordersDropDown");
m.calcMenuWidths(aE);
c.show().position({my:"left top",at:"left bottom",of:aD.currentTarget});
a(document).one("click",function(){c.hide();
});
return false;
}function E(aE,aG){var aD=null,aF;
switch(aG.item.context.id){case"mnuItemBorderLeft":aD=a("#tglBtnBorderLeft");
aF=m.InputFormatProperty.LeftFrameLine;
break;
case"mnuItemBorderTop":aD=a("#tglBtnBorderTop");
aF=m.InputFormatProperty.TopFrameLine;
break;
case"mnuItemBorderRight":aD=a("#tglBtnBorderRight");
aF=m.InputFormatProperty.RightFrameLine;
break;
case"mnuItemBorderBottom":aD=a("#tglBtnBorderBottom");
aF=m.InputFormatProperty.BottomFrameLine;
break;
case"mnuItemBorderOutside":aD=a("#tglBtnBorderOutside");
aF=m.InputFormatProperty.BoxFrame;
break;
case"mnuItemBorderAll":aD=a("#tglBtnBorderAll");
aF=m.InputFormatProperty.AllFrameLines;
break;
case"mnuItemBorderInsideHor":aD=a("#tglBtnBorderInsideHor");
aF=m.InputFormatProperty.InnerHorizontalFrameLines;
break;
case"mnuItemBorderInsideVert":aD=a("#tglBtnBorderInsideVert");
aF=m.InputFormatProperty.InnerVerticalFrameLines;
break;
}if(aD){if(aD.hasClass("ribbon-button-selected")){m.sendCommand(m.Command.InputFormat,aF,0);
}else{m.sendCommand(m.Command.InputFormat,aF,1);
}}}function L(aE){m.fileMenu.hide();
m.hideAllMenus_homeTab();
var aD=document.getElementById("bulletListDropDown");
m.calcMenuWidths(aD);
d.show().position({my:"left top",at:"left bottom",of:aE.currentTarget});
a(document).one("click",function(){d.hide();
});
return false;
}function H(aF,aG){var aD=null,aE;
switch(aG.item.context.id){case"mnuItemBulletListDisc":aD=a("#tglBtnBulletListDisc");
aE="\u00B7";
break;
case"mnuItemBulletListDash":aD=a("#tglBtnBulletListDash");
aE="-";
break;
case"mnuItemBulletListAsterisk":aD=a("#tglBtnBulletListAsterisk");
aE="*";
break;
case"mnuItemBulletListDiamond":aD=a("#tglBtnBulletListDiamond");
aE="\u00A8";
break;
case"mnuItemBulletListArrow":aD=a("#tglBtnBulletListArrow");
aE="\u00AE";
break;
case"mnuItemListFormatBullet":m.sendCommand(m.Command.ShowDialog,m.DialogCategory.TXDialog,m.TXDialogType.ListFormatDialog);
break;
}if(aD){if(aD.hasClass("ribbon-button-selected")){m.sendCommand(m.Command.InputFormat,m.InputFormatProperty.BulletedList,0);
}else{m.sendCommand(m.Command.InputFormat,m.InputFormatProperty.BulletedList,1);
m.sendCommand(m.Command.InputFormat,m.InputFormatProperty.BulletCharacter,0,0,aE);
}}}function P(aE){m.fileMenu.hide();
m.hideAllMenus_homeTab();
var aD=document.getElementById("numberedListDropDown");
m.calcMenuWidths(aD);
k.show().position({my:"left top",at:"left bottom",of:aE.currentTarget});
a(document).one("click",function(){k.hide();
});
return false;
}function Y(aE,aG){var aD=null,aF;
switch(aG.item.context.id){case"mnuItemNumberedList_123":aD=a("#tglBtnNumberedList_123");
aF=m.NumberFormat.ArabicNumbers;
break;
case"mnuItemNumberedList_abc":aD=a("#tglBtnNumberedList_abc");
aF=m.NumberFormat.Letters;
break;
case"mnuItemNumberedList_ABC":aD=a("#tglBtnNumberedList_ABC");
aF=m.NumberFormat.CapitalLetters;
break;
case"mnuItemNumberedList_III":aD=a("#tglBtnNumberedList_III");
aF=m.NumberFormat.RomanNumbers;
break;
case"mnuItemNumberedList_iii":aD=a("#tglBtnNumberedList_iii");
aF=m.NumberFormat.SmallRomanNumbers;
break;
case"mnuItemFormatListNumbered":m.sendCommand(m.Command.ShowDialog,m.DialogCategory.TXDialog,m.TXDialogType.ListFormatDialog);
break;
}if(aD){if(aD.hasClass("ribbon-button-selected")){m.sendCommand(m.Command.InputFormat,m.InputFormatProperty.NumberedList,0);
}else{m.sendCommand(m.Command.InputFormat,m.InputFormatProperty.NumberedList,1);
m.sendCommand(m.Command.InputFormat,m.InputFormatProperty.NumberedListFormat,aF);
}}}function S(aE){m.fileMenu.hide();
m.hideAllMenus_homeTab();
var aD=document.getElementById("structuredListDropDown");
m.calcMenuWidths(aD);
n.show().position({my:"left top",at:"left bottom",of:aE.currentTarget});
a(document).one("click",function(){n.hide();
});
return false;
}function aa(aE,aG){var aD=null,aF;
switch(aG.item.context.id){case"mnuItemStructuredList_123":aD=a("#tglBtnStructuredList_123");
aF=m.NumberFormat.ArabicNumbers;
break;
case"mnuItemStructuredList_abc":aD=a("#tglBtnStructuredList_abc");
aF=m.NumberFormat.Letters;
break;
case"mnuItemStructuredList_ABC":aD=a("#tglBtnStructuredList_ABC");
aF=m.NumberFormat.CapitalLetters;
break;
case"mnuItemStructuredList_III":aD=a("#tglBtnStructuredList_III");
aF=m.NumberFormat.RomanNumbers;
break;
case"mnuItemStructuredList_iii":aD=a("#tglBtnStructuredList_iii");
aF=m.NumberFormat.SmallRomanNumbers;
break;
case"mnuItemFormatListStructured":m.sendCommand(m.Command.ShowDialog,m.DialogCategory.TXDialog,m.TXDialogType.ListFormatDialog);
break;
}if(aD){if(aD.hasClass("ribbon-button-selected")){m.sendCommand(m.Command.InputFormat,m.InputFormatProperty.StructuredList,0);
}else{m.sendCommand(m.Command.InputFormat,m.InputFormatProperty.StructuredList,1);
m.sendCommand(m.Command.InputFormat,m.InputFormatProperty.StructuredListFormat,aF);
}}}function O(aE){m.fileMenu.hide();
m.hideAllMenus_homeTab();
var aD=document.getElementById("lineSpacingDropDown");
m.calcMenuWidths(aD);
j.show().position({my:"left top",at:"left bottom",of:aE.currentTarget});
a(document).one("click",function(){j.hide();
});
return false;
}function X(aD,aF){var aE=0;
switch(aF.item.context.id){case"mnuItemLineSpacing_1_0":aE=100;
break;
case"mnuItemLineSpacing_1_15":aE=115;
break;
case"mnuItemLineSpacing_1_5":aE=150;
break;
case"mnuItemLineSpacing_2_0":aE=200;
break;
case"mnuItemLineSpacing_2_5":aE=250;
break;
case"mnuItemLineSpacing_3_0":aE=300;
break;
}if(aE){m.sendCommand(m.Command.InputFormat,m.InputFormatProperty.LineSpacing,aE);
}}function U(aE){m.fileMenu.hide();
m.hideAllMenus_homeTab();
var aD=document.getElementById("ulStylesDropDown");
m.calcMenuWidths(aD);
t.show().position({my:"left top",at:"left bottom",of:aE.currentTarget});
a(document).one("click",function(){t.hide();
});
return false;
}function ae(aD,aH){var aE=aH.item.context.id;
var aG=a("#"+aE+" div.ribbon-button-checkmark");
var aF=aG.hasClass("ribbon-button-selected");
var aI=m.FontUnderlineStyle.None;
switch(aE){case"mnuItemULStyleSingle":if(!aF){aI=m.FontUnderlineStyle.Single;
}break;
case"mnuItemULStyleDoubled":if(!aF){aI=m.FontUnderlineStyle.Doubled;
}break;
case"mnuItemULStyleSingleWO":if(!aF){aI=m.FontUnderlineStyle.SingleWordsOnly;
}break;
case"mnuItemULStyleDoubledWO":if(!aF){aI=m.FontUnderlineStyle.DoubledWordsOnly;
}break;
}if(aI){m.sendCommand(m.Command.InputFormat,m.InputFormatProperty.UnderlineStyle,aI);
}}function T(aE){m.fileMenu.hide();
m.hideAllMenus_homeTab();
var aD=document.getElementById("stylesDropDown");
aD.style.height="";
var aG=m.clientSize.Height-m.ribbonBarHeight-m.StatusBarHeight-m.ScrollbarWidth;
m.calcMenuWidths(aD);
o.show().position({my:"left top",at:"left bottom",of:aE.currentTarget});
var aH=a("#stylesDropDown"),aF=aH.height();
if(aF>aG){aH.css("overflow-y","scroll");
}else{aH.css("overflow-y","");
}aH.height(Math.min(aG,aF));
a(document).one("click",function(){o.hide();
});
return false;
}function ab(aD,aE){switch(aE.item.context.id){case"mnuItemManageStyles":m.sendCommand(m.Command.ShowDialog,m.DialogCategory.TXDialog,m.TXDialogType.FormattingStylesDialog);
break;
default:ai(aE.item.context.dataset.styleName);
break;
}}function I(aD,aF){var aE=null;
switch(aF.item.context.id){case"mnuItemClipFmt_FormattedText":aE=m.ClipboardFormatButton.FormattedText;
break;
case"mnuItemClipFmt_UnformattedText":aE=m.ClipboardFormatButton.UnformattedText;
break;
case"mnuItemClipFmt_Image":aE=m.ClipboardFormatButton.Image;
break;
case"mnuItemClipFmt_TextFrame":aE=m.ClipboardFormatButton.TextFrame;
break;
case"mnuItemClipFmt_Chart":aE=m.ClipboardFormatButton.Chart;
break;
case"mnuItemClipFmt_Barcode":aE=m.ClipboardFormatButton.Barcode;
break;
case"mnuItemClipFmt_Drawing":aE=m.ClipboardFormatButton.Drawing;
break;
}if(aE!=null){m.sendCommand(m.Command.Paste,aE);
}}function N(aD){m.fileMenu.hide();
m.hideAllMenus_homeTab();
var aE=document.getElementById("frameLineWidthDropDown");
m.calcMenuWidths(aE);
i.show().position({my:"left top",at:"left bottom",of:aD.currentTarget});
a(document).one("click",function(){i.hide();
});
return false;
}function W(aD,aF){var aE=aF.item.context;
var aG=0;
switch(aE.id){case"mnuItemFrameLineWidth_0_25":aG=0.25*20;
break;
case"mnuItemFrameLineWidth_0_5":aG=0.5*20;
break;
case"mnuItemFrameLineWidth_0_75":aG=0.75*20;
break;
case"mnuItemFrameLineWidth_1_0":aG=1*20;
break;
case"mnuItemFrameLineWidth_1_5":aG=1.5*20;
break;
case"mnuItemFrameLineWidth_2_25":aG=2.25*20;
break;
case"mnuItemFrameLineWidth_3_0":aG=3*20;
break;
case"mnuItemFrameLineWidth_4_5":aG=4.5*20;
break;
case"mnuItemFrameLineWidth_6_0":aG=6*20;
break;
}if(aG){m.sendCommand(m.Command.InputFormat,m.InputFormatProperty.FrameLineWidth,aG);
}}function ag(){var aE=a("#stylesDropDown > li > a > div.ribbon-button.ribbon-button-selected");
if(aE){aE.removeClass("ribbon-button-selected");
}var aD=a('#stylesDropDown > li[data-style-name="'+g+'"] > a > div.ribbon-button');
if(aD){aD.addClass("ribbon-button-selected");
}}function ai(aD){m.sendCommand(m.Command.InputFormat,m.InputFormatProperty.StyleName,0,0,aD);
}function af(aE){var aD=document.getElementById("mnuItemManageStyles").cloneNode(true),aF=document.getElementById("stylesDropDown");
aF.innerHTML="";
aE.forEach(function(aL){var aK=document.createElement("li");
aF.appendChild(aK);
aK.style.overflowX="hidden";
aK.dataset.styleName=aL;
aK.setAttribute("title",aL);
var aG=document.createElement("a");
aK.appendChild(aG);
aG.style.width="1000px";
var aH=document.createElement("div");
aG.appendChild(aH);
aH.className="ribbon-button ribbon-button-tiny ribbon-button-checkmark";
var aI=document.createElement("img");
aH.appendChild(aI);
aI.setAttribute("src",m.imageResources.small.checkmark);
aH=document.createElement("div");
aG.appendChild(aH);
aH.className="small-menu-item-caption-container";
aH.style.overflowX="hidden";
var aJ=document.createElement("p");
aH.appendChild(aJ);
aJ.textContent=aL;
});
aF.appendChild(aD);
}function an(aE){aE=aE||"";
var aD=null;
a("#bulletListDropDown div.ribbon-button-42px").removeClass("ribbon-button-selected");
switch(aE){case"\u00B7":aD=a("#tglBtnBulletListDisc");
break;
case"-":aD=a("#tglBtnBulletListDash");
break;
case"*":aD=a("#tglBtnBulletListAsterisk");
break;
case"\u00A8":aD=a("#tglBtnBulletListDiamond");
break;
case"\u00AE":aD=a("#tglBtnBulletListArrow");
break;
}if(aD){aD.addClass("ribbon-button-selected");
}}function at(aE){var aD=null;
aE=aE||0;
a("#numberedListDropDown div.ribbon-button-numbered-list").removeClass("ribbon-button-selected");
switch(aE){case m.NumberFormat.ArabicNumbers:aD=a("#tglBtnNumberedList_123");
break;
case m.NumberFormat.Letters:aD=a("#tglBtnNumberedList_abc");
break;
case m.NumberFormat.CapitalLetters:aD=a("#tglBtnNumberedList_ABC");
break;
case m.NumberFormat.RomanNumbers:aD=a("#tglBtnNumberedList_III");
break;
case m.NumberFormat.SmallRomanNumbers:aD=a("#tglBtnNumberedList_iii");
break;
}if(aD){aD.addClass("ribbon-button-selected");
}}function au(aE){var aD=null;
aE=aE||0;
a("#structuredListDropDown div.ribbon-button-numbered-list").removeClass("ribbon-button-selected");
switch(aE){case m.NumberFormat.ArabicNumbers:aD=a("#tglBtnStructuredList_123");
break;
case m.NumberFormat.Letters:aD=a("#tglBtnStructuredList_abc");
break;
case m.NumberFormat.CapitalLetters:aD=a("#tglBtnStructuredList_ABC");
break;
case m.NumberFormat.RomanNumbers:aD=a("#tglBtnStructuredList_III");
break;
case m.NumberFormat.SmallRomanNumbers:aD=a("#tglBtnStructuredList_iii");
break;
}if(aD){aD.addClass("ribbon-button-selected");
}}function ar(aE){var aD=null;
aE=aE||0;
a("#lineSpacingDropDown div.ribbon-button-checkmark").removeClass("ribbon-button-selected");
switch(aE){case 100:aD=a("#tglBtnLineSpacing_1_0");
break;
case 115:aD=a("#tglBtnLineSpacing_1_15");
break;
case 150:aD=a("#tglBtnLineSpacing_1_5");
break;
case 200:aD=a("#tglBtnLineSpacing_2_0");
break;
case 250:aD=a("#tglBtnLineSpacing_2_5");
break;
case 300:aD=a("#tglBtnLineSpacing_3_0");
break;
}if(aD){aD.addClass("ribbon-button-selected");
}}function aq(aE){var aD=null;
aE=aE||0;
a("#frameLineWidthDropDown div.small-menu-item-image-wrapper").removeClass("ribbon-button-selected");
switch(aE){case 0.25*20:aD=a("#tglBtnFrameLineWidth_0_25");
break;
case 0.5*20:aD=a("#tglBtnFrameLineWidth_0_5");
break;
case 0.75*20:aD=a("#tglBtnFrameLineWidth_0_75");
break;
case 1*20:aD=a("#tglBtnFrameLineWidth_1_0");
break;
case 1.5*20:aD=a("#tglBtnFrameLineWidth_1_5");
break;
case 2.25*20:aD=a("#tglBtnFrameLineWidth_2_25");
break;
case 3*20:aD=a("#tglBtnFrameLineWidth_3_0");
break;
case 4.5*20:aD=a("#tglBtnFrameLineWidth_4_5");
break;
case 6*20:aD=a("#tglBtnFrameLineWidth_6_0");
break;
}if(aD){aD.addClass("ribbon-button-selected");
}}function aC(aD){var aE=document.querySelector("#drpDnBtnTextColor > img");
if(aE){m.update16x16ColorButtonIcon(aE,aD);
}}function aB(aD){var aE=document.querySelector("#drpDnBtnTextHighlightColor > img");
if(aE){m.update16x16ColorButtonIcon(aE,aD);
}}function aw(aE){var aD=document.getElementById("tglBtnTextColorAutomatic");
if((aE!==null)&&(aE.Name==="WindowText")){aD.classList.add("ribbon-button-selected");
}else{aD.classList.remove("ribbon-button-selected");
}}function av(aE){var aD=document.getElementById("tglBtnTextHighlightColorAutomatic");
if((aE!==null)&&(aE.Name==="Transparent")){aD.classList.add("ribbon-button-selected");
}else{aD.classList.remove("ribbon-button-selected");
}}function az(aD){var aE=document.querySelector("#drpDnBtnBackColor > img");
if(aE){m.update16x16ColorButtonIcon(aE,aD);
}aE=document.querySelector("#drpDnBtnTblBgColor img");
if(aE){m.update16x16ColorButtonIcon(aE,aD);
}}function aA(aD){var aE=document.querySelector("#drpDnBtnFrameColor > img");
if(aE){m.update16x16ColorButtonIcon(aE,aD);
}aE=document.querySelector("#drpDnBtnTblLineColor img");
if(aE){m.update16x16ColorButtonIcon(aE,aD);
}}function ao(aE){var aD=document.getElementById("tglBtnBackColorAutomatic");
if((aE!==null)&&(aE.Name==="Transparent")){aD.classList.add("ribbon-button-selected");
}else{aD.classList.remove("ribbon-button-selected");
}}function ap(aE){var aD=document.getElementById("tglBtnFrameColorAutomatic");
if((aE!==null)&&(aE.Name==="WindowText")){aD.classList.add("ribbon-button-selected");
}else{aD.classList.remove("ribbon-button-selected");
}}function x(aD){aD.beginPath();
aD.clearRect(0,12,16,4);
aD.rect(0.5,12.5,15,3);
aD.lineWidth=1;
aD.strokeStyle="#646464";
aD.stroke();
}m.update16x16ColorButtonIcon=function(aH,aF){if(!aH.complete){return;
}if((aH.naturalHeight<16)||(aH.naturalWidth<16)){return;
}var aE=aF?"rgba("+aF.R+","+aF.G+","+aF.B+","+aF.A+")":"";
var aD=document.createElement("canvas");
aD.width=aH.naturalWidth;
aD.height=aH.naturalHeight;
var aG=aD.getContext("2d");
aG.drawImage(aH,0,0);
if(aF&&aF.A){aG.beginPath();
aG.rect(0,12,16,4);
aG.fillStyle=aE;
aG.fill();
if((aF.R==255)&&(aF.G==255)&&(aF.B==255)){x(aG);
}}else{x(aG);
}aH.src=aD.toDataURL();
};
function w(aD,aF){var aE=Number(aD).toString(16);
aF=aF||2;
while(aE.length<aF){aE="0"+aE;
}return aE;
}function v(aD){return"#"+w(aD.R)+w(aD.G)+w(aD.B);
}m.limitMenuHeight=function(aG){var aD=document.getElementById(aG);
aD.style.height="";
var aE=aD.clientHeight;
var aF=m.clientSize.Height-m.ribbonBarHeight-m.StatusBarHeight-m.ScrollbarWidth;
if(aF<aE){aD.style.height=aF+"px";
}};
m.hideAllMenus_homeTab=function(){s.hide();
r.hide();
b.hide();
h.hide();
d.hide();
c.hide();
k.hide();
n.hide();
j.hide();
o.hide();
t.hide();
i.hide();
if(l){l.hide();
}if(e){e.hide();
}};
return ax;
}(TXTextControl||{},j$1_10_2));
var TXTextControl=(function(Y,a){var n=Y._private=Y._private||{};
var l,h,b,g,c,f,e,i,m,k,j,d;
n.BarcodeType={QRCode:1,Code128:2,EAN13:3,UPCA:4,EAN8:5,Interleaved2of5:6,Postnet:7,Code39:8,AztecCode:9,IntelligentMail:10,Datamatrix:11,PDF417:12,MicroPDF:13,Codabar:14,FourState:15,Code11:16,Code93:17,PLANET:18,RoyalMail:19,Maxicode:20,};
n.insertShapesMenuContent={};
n.insertChartMenuContent={};
n.ChartTemplateType={};
n.attachInsertTabEventHandlers=function(){l=a("#insertTableDropDown").menu().hide();
h=a("#insertImageDropDown").menu().hide();
b=a("#insertBarcodeDropDown").menu().hide();
g=a("#insertHyperlinkDropDown").menu().hide();
c=a("#insertBookmarkDropDown").menu().hide();
f=a("#insertHeaderDropDown").menu().hide();
e=a("#insertFooterDropDown").menu().hide();
i=a("#insertPageNumberDropDown").menu().hide();
m=a("#insertTextFrameDropDown").menu().hide();
k=a("#insertSymbolDropDown").menu().hide();
l.on("menuselect",U);
h.on("menuselect",M);
b.on("menuselect",A);
g.on("menuselect",K);
c.on("menuselect",C);
f.on("menuselect",I);
e.on("menuselect",G);
i.on("menuselect",O);
m.on("menuselect",W);
k.on("menuselect",S);
document.addEventListener("txItemReceived",Z);
document.addEventListener("headerFooterActivated",u);
document.addEventListener("headerFooterDeactivated",v);
a("#btnBlankPage").click(function(){n.sendCommand(n.Command.InsertBlankPage);
});
a("#btnPageBreak").click(function(){n.sendCommand(n.Command.InsertBreak,n.BreakType.Page);
});
a("#btnInsertFile").click(function(){w();
});
a("#drpDnBtnInsertTable").click(T);
a("#drpDnBtnInsertHyperlink").click(J);
a("#drpDnBtnInsertBarcode").click(z);
a("#drpDnBtnInsertImage").click(L);
a("#drpDnBtnInsertShape").click(P);
a("#drpDnBtnInsertBookmark").click(B);
a("#drpDnBtnInsertHeader").click(H);
a("#drpDnBtnInsertFooter").click(F);
a("#drpDnBtnInsertPageNum").click(N);
a("#drpDnBtnInsertTextFrame").click(V);
a("#drpDnBtnInsertSymbol").click(R);
a("#drpDnBtnInsertChart").click(D);
};
function q(ab){var ac=document.querySelector("#mnuItemTableWizard .txTblWizHdrSecondPart");
ac.textContent="";
var aa=ab.querySelectorAll("td.glowing");
[].forEach.call(aa,function(ad){ad.classList.remove("glowing");
});
}function X(af,ag,ab){q(af);
for(var ad=0;
ad<ab;
++ad){var ae=af.rows[ad];
for(var ac=0;
ac<ag;
++ac){var aa=ae.cells[ac];
aa.classList.add("glowing");
}}}function r(ab,aa){n.sendCommand(n.Command.TableCommand,n.TableCommand.Create,ab,aa);
}n.generateDynamicInsertTabContent=function(){var af=document.getElementById("txInsertTableGrid");
var ae=document.querySelector("#mnuItemTableWizard .txInsertTableWizard");
var ag=document.querySelector("#mnuItemTableWizard .txTblWizHdrSecondPart");
ae.addEventListener("mouseout",function(ah){var ai=document.elementFromPoint(ah.clientX,ah.clientY);
if(!ai||((ai.tagName!=="TD")&&(ai.tagName!=="TABLE")&&(ai.tagName!=="TR"))){q(af);
}});
for(var ac=1;
ac<=8;
++ac){var ad=document.createElement("tr");
af.appendChild(ad);
for(var ab=1;
ab<=10;
++ab){var aa=document.createElement("td");
ad.appendChild(aa);
aa.txCol=ab;
aa.txRow=ac;
aa.addEventListener("click",function(ah){r(ah.target.txCol,ah.target.txRow);
q(af);
});
aa.addEventListener("mouseover",function(ah){X(af,ah.target.txCol,ah.target.txRow);
ag.textContent=ah.target.txCol+"x"+ah.target.txRow;
});
}}};
function x(){n.openFile(n.FileType.Image);
}function y(){n.sendCommand(n.Command.InsertItem,n.ItemType.ImagePlaceholder);
}function w(){var aa=new n.OpenFileDialog(n.Command.InsertDocumentFile,n.FileType.Document);
aa.showModal();
}function Z(aa){var ac=aa.detail.itemType;
var ab=aa.detail.item;
if(ab===null){return;
}switch(ac){case n.ItemType.HypertextLink:case n.ItemType.DocumentLink:a("#mnuItemEditHyperlink").removeClass("txui-state-disabled");
a("#mnuItemDeleteHyperlink").removeClass("txui-state-disabled");
break;
case n.ItemType.DocumentTarget:a("#mnuItemDeleteBookmark").removeClass("txui-state-disabled");
a("#mnuItemEditBookmark").removeClass("txui-state-disabled");
break;
}}function u(){a("#mnuItemInsertPageNum").removeClass("txui-state-disabled");
}function v(){a("#mnuItemInsertPageNum").addClass("txui-state-disabled");
}n.applyShapesMenuContent=function(){var aa=n.insertShapesMenuContent;
t(aa);
delete n.insertShapesMenuContent;
j=a("#insertShapesDropDown").menu().hide();
j.on("menuselect",Q);
};
function t(ac){var ab=document.getElementById("insertShapesDropDown");
p(ac,ab);
var aa=document.querySelector("#mnuItemDrawingMarkerLines div.small-menu-item-image-wrapper");
aa.classList.add("ribbon-button");
}function p(ab,aa){aa.innerHTML="";
if(!aa.id){aa.style.maxHeight="200px";
aa.style.overflowY="auto";
}ab.forEach(function(ai){var af=document.createElement("li");
if(ai.HtmlElemID){af.id=ai.HtmlElemID;
}if(ai.ShapeType>-1){af.dataset.shapeType=ai.ShapeType;
}aa.appendChild(af);
var ac=document.createElement("a");
if(ai.WithSeparator){ac.style.borderTop="1px solid lightgray";
}af.appendChild(ac);
var ad=document.createElement("div");
ad.classList.add("small-menu-item-image-wrapper");
if(ai.ImageDataURL){var ae=document.createElement("img");
ae.src=ai.ImageDataURL;
ad.appendChild(ae);
}ac.appendChild(ad);
ad=document.createElement("div");
ad.classList.add("small-menu-item-caption-container");
ac.appendChild(ad);
var ag=document.createElement("p");
ag.textContent=ai.Text;
ad.appendChild(ag);
if(ai.hasOwnProperty("Items")&&ai.Items.length){var ah=document.createElement("ul");
ah.classList.add("dropDownMenu");
p(ai.Items,ah);
af.appendChild(ah);
}});
}n.applyChartMenuContent=function(){var aa=n.insertChartMenuContent;
s(aa);
delete n.insertChartMenuContent;
d=a("#insertChartDropDown").menu().hide();
d.on("menuselect",E);
};
function s(ab){var aa=document.getElementById("insertChartDropDown");
o(ab,aa);
}function o(ab,aa){aa.innerHTML="";
if(!aa.id){aa.style.maxHeight="200px";
aa.style.overflowY="auto";
}ab.forEach(function(ai){var af=document.createElement("li");
if(ai.htmlElemID){af.id=ai.htmlElemID;
}if(ai.chartType>-1){af.dataset.chartType=ai.chartType;
}aa.appendChild(af);
var ac=document.createElement("a");
af.appendChild(ac);
var ad=document.createElement("div");
ad.classList.add("large-menu-item-image-container");
if(ai.imageDataURL){var ae=document.createElement("img");
ae.src=ai.imageDataURL;
ad.appendChild(ae);
}ac.appendChild(ad);
ad=document.createElement("div");
ad.classList.add("large-menu-item-caption-container");
ac.appendChild(ad);
var ag=document.createElement("p");
ag.textContent=ai.text;
ad.appendChild(ag);
if(ai.hasOwnProperty("items")&&ai.items.length){var ah=document.createElement("ul");
ah.classList.add("dropDownMenu");
o(ai.items,ah);
af.appendChild(ah);
}});
}function T(aa){n.fileMenu.hide();
n.hideAllMenus_insertTab();
var ab=document.getElementById("insertTableDropDown");
n.calcMenuWidths(ab);
l.show().position({my:"left top",at:"left bottom",of:aa.currentTarget});
a(document).one("click",function(){l.hide();
});
return false;
}function U(aa,ab){switch(ab.item.context.id){case"mnuItemInsertTable":n.sendCommand(n.Command.ShowDialog,n.DialogCategory.TXDialog,n.TXDialogType.InsertTableDialog);
break;
}}function L(ab){n.fileMenu.hide();
n.hideAllMenus_insertTab();
var aa=document.getElementById("insertImageDropDown");
n.calcMenuWidths(aa);
h.show().position({my:"left top",at:"left bottom",of:ab.currentTarget});
a(document).one("click",function(){h.hide();
});
return false;
}function M(aa,ab){switch(ab.item.context.id){case"mnuItemInsertImage":x();
break;
case"mnuItemInsertImagePlacehld":y();
break;
}}function E(ab,ae){var aa=ae.item.context;
var ad=aa.dataset.chartType;
if(ad){var ac=parseInt(ad,10);
n.sendCommand(n.Command.InsertItem,n.ItemType.Chart,ac);
}}function D(ab){n.fileMenu.hide();
n.hideAllMenus_insertTab();
var aa=document.getElementById("insertChartDropDown");
n.calcMenuWidths(aa);
d.show().position({my:"left top",at:"left bottom",of:ab.currentTarget});
a(document).on("click",function(ac){if(!(n.isInsideElementWithID(ac.target,"insertChartDropDown")&&n.isPartOfMenuItemWithSubMenu(ac.target))){d.hide();
a(document).off(ac);
}});
return false;
}function P(ab){n.fileMenu.hide();
n.hideAllMenus_insertTab();
var aa=document.getElementById("insertShapesDropDown");
n.calcMenuWidths(aa);
j.show().position({my:"left top",at:"left bottom",of:ab.currentTarget});
a(document).on("click",function(ac){if(!(n.isInsideElementWithID(ac.target,"insertShapesDropDown")&&n.isPartOfMenuItemWithSubMenu(ac.target))){j.hide();
a(document).off(ac);
}});
return false;
}function Q(ac,af){var ab=af.item.context;
var ae=ab.dataset.shapeType;
if(ae){var ad=parseInt(ae,10);
n.sendCommand(n.Command.InsertItem,n.ItemType.Shape,ad);
}else{if(ab.id){switch(ab.id){case"mnuItemNewDrawingCanvas":n.sendCommand(n.Command.InsertItem,n.ItemType.DrawingCanvas);
break;
case"mnuItemDrawingMarkerLines":var aa=document.querySelector("#mnuItemDrawingMarkerLines div.small-menu-item-image-wrapper");
if(aa.classList.contains("ribbon-button-selected")){aa.classList.remove("ribbon-button-selected");
n.sendCommand(n.Command.DisplayVisualElement,n.VisualElement.DrawingMarkerLines,0);
}else{aa.classList.add("ribbon-button-selected");
n.sendCommand(n.Command.DisplayVisualElement,n.VisualElement.DrawingMarkerLines,1);
}break;
}}}}function z(ab){n.fileMenu.hide();
n.hideAllMenus_insertTab();
var aa=document.getElementById("insertBarcodeDropDown");
n.calcMenuWidths(aa);
b.show().position({my:"left top",at:"left bottom",of:ab.currentTarget});
n.limitMenuHeight("insertBarcodeDropDown");
a(document).one("click",function(){b.hide();
});
return false;
}function A(ab,ac){var aa;
switch(ac.item.context.id){case"mnuItemInsertQRCode":aa=n.BarcodeType.QRCode;
break;
case"mnuItemInsertAztecCode":aa=n.BarcodeType.AztecCode;
break;
case"mnuItemInsertDatamatrix":aa=n.BarcodeType.Datamatrix;
break;
case"mnuItemInsertPDF417":aa=n.BarcodeType.PDF417;
break;
case"mnuItemInsertMicroPDF":aa=n.BarcodeType.MicroPDF;
break;
case"mnuItemInsertMaxicode":aa=n.BarcodeType.Maxicode;
break;
case"mnuItemInsertCode128":aa=n.BarcodeType.Code128;
break;
case"mnuItemInsertEAN13":aa=n.BarcodeType.EAN13;
break;
case"mnuItemInsertUPCA":aa=n.BarcodeType.UPCA;
break;
case"mnuItemInsertEAN8":aa=n.BarcodeType.EAN8;
break;
case"mnuItemInsertInterleaved2of5":aa=n.BarcodeType.Interleaved2of5;
break;
case"mnuItemInsertPostnet":aa=n.BarcodeType.Postnet;
break;
case"mnuItemInsertCode39":aa=n.BarcodeType.Code39;
break;
case"mnuItemInsertIntelligentMail":aa=n.BarcodeType.IntelligentMail;
break;
case"mnuItemInsertCodabar":aa=n.BarcodeType.Codabar;
break;
case"mnuItemInsertFourState":aa=n.BarcodeType.FourState;
break;
case"mnuItemInsertCode11":aa=n.BarcodeType.Code11;
break;
case"mnuItemInsertCode93":aa=n.BarcodeType.Code93;
break;
case"mnuItemInsertPLANET":aa=n.BarcodeType.PLANET;
break;
case"mnuItemInsertRoyalMail":aa=n.BarcodeType.RoyalMail;
break;
}if(aa){n.sendCommand(n.Command.InsertItem,n.ItemType.Barcode,aa);
}}function J(ab){n.fileMenu.hide();
n.hideAllMenus_insertTab();
a("#mnuItemEditHyperlink").addClass("txui-state-disabled");
a("#mnuItemDeleteHyperlink").addClass("txui-state-disabled");
n.sendCommand(n.Command.GetItem,n.ItemType.Link);
var aa=document.getElementById("insertHyperlinkDropDown");
n.calcMenuWidths(aa);
g.show().position({my:"left top",at:"left bottom",of:ab.currentTarget});
a(document).one("click",function(){g.hide();
});
return false;
}function K(ab,ac){switch(ac.item.context.id){case"mnuItemInsertHyperlink":case"mnuItemEditHyperlink":var aa=new n.HyperlinkDialog();
aa.showModal();
break;
case"mnuItemDeleteHyperlink":n.sendCommand(n.Command.DeleteItem,n.ItemType.Link);
break;
}}function B(ab){n.fileMenu.hide();
n.hideAllMenus_insertTab();
a("#mnuItemDeleteBookmark").addClass("txui-state-disabled");
a("#mnuItemEditBookmark").addClass("txui-state-disabled");
n.sendCommand(n.Command.GetItem,n.ItemType.DocumentTarget);
var aa=document.getElementById("insertBookmarkDropDown");
n.calcMenuWidths(aa);
c.show().position({my:"left top",at:"left bottom",of:ab.currentTarget});
a(document).one("click",function(){c.hide();
});
return false;
}function C(ab,ac){switch(ac.item.context.id){case"mnuItemEditBookmark":case"mnuItemInsertBookmark":n.sendCommand(n.Command.InsertItem,n.ItemType.DocumentTarget);
break;
case"mnuItemDeleteBookmark":n.sendCommand(n.Command.DeleteItem,n.ItemType.DocumentTarget);
break;
case"mnuItemShowBookmarkMarkers":var aa=a("#tglBtnShowBookmarkMarkers");
if(aa.hasClass("ribbon-button-selected")){n.sendCommand(n.Command.DisplayVisualElement,n.VisualElement.BookmarkMarkers,0);
aa.removeClass("ribbon-button-selected");
}else{n.sendCommand(n.Command.DisplayVisualElement,n.VisualElement.BookmarkMarkers,1);
aa.addClass("ribbon-button-selected");
}break;
}}function H(ab){n.fileMenu.hide();
n.hideAllMenus_insertTab();
var aa=document.getElementById("insertHeaderDropDown");
n.calcMenuWidths(aa);
f.show().position({my:"left top",at:"left bottom",of:ab.currentTarget});
a(document).one("click",function(){f.hide();
});
return false;
}function I(aa,ab){switch(ab.item.context.id){case"mnuItemEditHeader":n.sendCommand(n.Command.InsertItem,n.ItemType.HeaderFooter,n.HeaderFooterType.Header);
break;
case"mnuItemRemoveHeader":n.sendCommand(n.Command.DeleteItem,n.ItemType.HeaderFooter,n.HeaderFooterType.Header);
break;
}}function F(ab){n.fileMenu.hide();
n.hideAllMenus_insertTab();
var aa=document.getElementById("insertFooterDropDown");
n.calcMenuWidths(aa);
e.show().position({my:"left top",at:"left bottom",of:ab.currentTarget});
a(document).one("click",function(){e.hide();
});
return false;
}function G(aa,ab){switch(ab.item.context.id){case"mnuItemEditFooter":n.sendCommand(n.Command.InsertItem,n.ItemType.HeaderFooter,n.HeaderFooterType.Footer);
break;
case"mnuItemRemoveFooter":n.sendCommand(n.Command.DeleteItem,n.ItemType.HeaderFooter,n.HeaderFooterType.Footer);
break;
}}function N(ab){n.fileMenu.hide();
n.hideAllMenus_insertTab();
var aa=document.getElementById("insertPageNumberDropDown");
n.calcMenuWidths(aa);
i.show().position({my:"left top",at:"left bottom",of:ab.currentTarget});
a(document).one("click",function(){i.hide();
});
return false;
}function O(aa,ab){switch(ab.item.context.id){case"mnuItemInsertPageNum":n.textViewer.focus();
n.sendCommand(n.Command.InsertItem,n.ItemType.PageNumber);
break;
case"mnuItemPageNumRemove":n.sendCommand(n.Command.DeleteItem,n.ItemType.PageNumber,n.HeaderFooterType.All);
break;
}}function V(ab){n.fileMenu.hide();
n.hideAllMenus_insertTab();
var aa=document.getElementById("insertTextFrameDropDown");
n.calcMenuWidths(aa);
m.show().position({my:"left top",at:"left bottom",of:ab.currentTarget});
a(document).one("click",function(){m.hide();
});
return false;
}function W(ab,ac){switch(ac.item.context.id){case"mnuItemInsertTextFrame":n.sendCommand(n.Command.InsertItem,n.ItemType.TextFrame);
break;
case"mnuItemShowTextFrameMarkerLines":var aa=a("#tglBtnShowTextFrameMarkerLines");
if(aa.hasClass("ribbon-button-selected")){n.sendCommand(n.Command.DisplayVisualElement,n.VisualElement.TextFrameMarkerLines,0);
aa.removeClass("ribbon-button-selected");
}else{n.sendCommand(n.Command.DisplayVisualElement,n.VisualElement.TextFrameMarkerLines,1);
aa.addClass("ribbon-button-selected");
}break;
}}function R(aa){n.fileMenu.hide();
n.hideAllMenus_insertTab();
k.show().position({my:"left top",at:"left bottom",of:aa.currentTarget});
a(document).one("click",function(){k.hide();
});
return false;
}function S(ac,ae){var ab=ae.item.context;
if(ab.id==="mnuItemMoreSymbols"){n.sendCommand(n.Command.ShowDialog,n.DialogCategory.TXDialog,n.TXDialogType.InsertSymbolDialog);
}else{ab=ab.children[0];
var ad=ab.text||null;
if(ad){n.textViewer.focus();
var aa=ad.charCodeAt(0);
n.sendCommand(n.Command.ComponentEvent,n.UserInputEventType.KeyPress,n.ComponentType.TextView,0,{key:aa});
}}}n.hideAllMenus_insertTab=function(){l.hide();
h.hide();
b.hide();
g.hide();
c.hide();
f.hide();
e.hide();
i.hide();
m.hide();
k.hide();
j.hide();
d.hide();
};
return Y;
}(TXTextControl||{},j$1_10_2));
var TXTextControl=(function(L,a){var j=L._private=L._private||{};
j.SectionFormatDialogTab={MarginsAndPaper:0,HeadersAndFooters:1,Columns:2,Borders:3};
j.SectionFormatProperty={BreakKind:0,ColumnDistances:1,ColumnLineColor:2,ColumnLineWidth:3,Columns:4,ColumnWidths:5,EqualColumnWidth:6,Landscape:7,PageBorder:8,PageMargins:9,PageSize:10,RestartPageNumbering:11};
var I={Left:1,Top:2,Right:4,Bottom:8,All:15};
var l=null;
var h,d,c,g,b,e,f,i;
j.attachPageLayoutTabEventHandlers=function(){k();
h=a("#pageOrientationDropDown").menu().hide();
d=a("#pageColumnsDropDown").menu().hide();
c=a("#pageBreaksDropDown").menu().hide();
g=a("#pageFrameLineWidthDropDown").menu().hide();
b=a("#pageBgColorDropDown").menu().hide();
e=a("#pageFrameColorDropDown").menu().hide();
f=a("#pageFrameDropDown").menu().hide();
i=a("#paperSizesDropDown").menu().hide();
h.on("menuselect",D);
d.on("menuselect",v);
c.on("menuselect",t);
g.on("menuselect",B);
b.on("menuselect",r);
e.on("menuselect",x);
f.on("menuselect",z);
i.on("menuselect",F);
a("#btnPageSetup").click(function(){j.hideAllMenus_pageLayoutTab();
j.sendCommand(j.Command.ShowDialog,j.DialogCategory.TXDialog,j.TXDialogType.SectionFormatDialog,j.SectionFormatDialogTab.MarginsAndPaper);
return false;
});
a("#btnPageBorders").click(function(){j.hideAllMenus_pageLayoutTab();
j.sendCommand(j.Command.ShowDialog,j.DialogCategory.TXDialog,j.TXDialogType.SectionFormatDialog,j.SectionFormatDialogTab.Borders);
return false;
});
a("#drpDnBtnPageOrientation").click(C);
a("#drpDnBtnPageColumns").click(u);
a("#drpDnBtnPageBreaks").click(s);
a("#drpDnBtnPageFrameWidth").click(A);
a("#drpDnBtnPageBgColor").click(q);
a("#drpDnBtnPageFrameColor").click(w);
a("#drpDnBtnPageFrame").click(y);
a("#drpDnBtnPaperSize").click(E);
document.getElementById("numParIndLeft").addEventListener("change",o);
document.getElementById("numParIndRight").addEventListener("change",p);
document.getElementById("numParIndBefore").addEventListener("change",n);
document.getElementById("numParIndAfter").addEventListener("change",m);
document.addEventListener("supportedPaperSizesChanged",K);
document.addEventListener("pageSizeChanged",J);
document.addEventListener("pageBackgroundColorReceived",G);
document.addEventListener("pageBorderReceived",H);
};
function K(M){j.populatePaperSizeMenu();
}function J(M){if(!j.supportedPaperSizes.length){return;
}var Q=M.detail;
var N=document.getElementById("paperSizesDropDown");
if(!N.children.length){return;
}[].forEach.call(N.children,function(T){T.classList.remove("menu-item-selected");
});
for(var P=0;
P<j.supportedPaperSizes.length;
++P){var R=j.supportedPaperSizes[P];
var S=(R.Width/14.4),O=(R.Height/14.4);
S=Math.round(S*100)/100;
O=Math.round(O*100)/100;
if((S==Q.Width)&&(O==Q.Height)){N.children[P].classList.add("menu-item-selected");
break;
}}}function G(O){var N=O.detail.color;
var M=document.getElementById("tglBtnPageBgColorAutomatic");
if(M){if(!N){M.classList.add("ribbon-button-selected");
}else{M.classList.remove("ribbon-button-selected");
}}}function H(O){var M=O.detail;
l=M;
var P=[];
var N=document.querySelectorAll("#pageFrameLineWidthDropDown div.ribbon-button-tiny, #pageFrameDropDown div.ribbon-button-tiny");
[].forEach.call(N,function(Q){Q.classList.remove("ribbon-button-selected");
});
if(M.VisibleBorders&I.Left){P.push(document.getElementById("tglBtnPageFrameLeft"));
}if(M.VisibleBorders&I.Top){P.push(document.getElementById("tglBtnPageFrameTop"));
}if(M.VisibleBorders&I.Right){P.push(document.getElementById("tglBtnPageFrameRight"));
}if(M.VisibleBorders&I.Bottom){P.push(document.getElementById("tglBtnPageFrameBottom"));
}if(M.VisibleBorders==I.All){P.push(document.getElementById("tglBtnPageFrameAll"));
}if(M.Color.Name=="WindowText"){P.push(document.getElementById("tglBtnPageFrameColorAutomatic"));
}if(M.VisibleBorders==0){P.push(document.getElementById("tglBtnNoPageFrameLine"));
}switch(M.Width){case 0.25*20:P.push(document.getElementById("tglBtnPageFrameLineWidth_0_25"));
break;
case 0.5*20:P.push(document.getElementById("tglBtnPageFrameLineWidth_0_5"));
break;
case 0.75*20:P.push(document.getElementById("tglBtnPageFrameLineWidth_0_75"));
break;
case 1*20:P.push(document.getElementById("tglBtnPageFrameLineWidth_1_0"));
break;
case 1.5*20:P.push(document.getElementById("tglBtnPageFrameLineWidth_1_5"));
break;
case 2.25*20:P.push(document.getElementById("tglBtnPageFrameLineWidth_2_25"));
break;
case 3*20:P.push(document.getElementById("tglBtnPageFrameLineWidth_3_0"));
break;
case 4.5*20:P.push(document.getElementById("tglBtnPageFrameLineWidth_4_5"));
break;
case 6*20:P.push(document.getElementById("tglBtnPageFrameLineWidth_6_0"));
break;
}P.forEach(function(Q){Q.classList.add("ribbon-button-selected");
});
}if(typeof String.prototype.endsWith!=="function"){String.prototype.endsWith=function(M){return this.substr(-M.length)===M;
};
}j.populatePaperSizeMenu=function(){if(j.supportedPaperSizes.length==0){return;
}var Q=document.getElementById("paperSizesDropDown");
Q.innerHTML="";
for(var S=0;
S<j.supportedPaperSizes.length;
++S){var T=j.supportedPaperSizes[S];
var P=document.createElement("LI");
P.dataset.index=S;
var M=document.createElement("A");
var N=document.createElement("DIV");
N.classList.add("large-menu-item-long-caption-container");
N.style.marginLeft="5px";
var O=document.createElement("H1");
var R=document.createElement("P");
O.textContent=T.Name;
var V=(T.Width/56.693).toFixed(1);
var U=(T.Height/56.693).toFixed(1);
if(V.endsWith(".0")){V=V.substr(0,V.length-2);
}if(U.endsWith(".0")){U=U.substr(0,U.length-2);
}R.textContent=V+" x "+U+" mm";
N.appendChild(O);
N.appendChild(R);
M.appendChild(N);
P.appendChild(M);
Q.appendChild(P);
}a("#paperSizesDropDown").menu("refresh");
};
function C(N){j.fileMenu.hide();
j.hideAllMenus_pageLayoutTab();
var M=document.getElementById("pageOrientationDropDown");
j.calcMenuWidths(M);
h.show().position({my:"left top",at:"left bottom",of:N.currentTarget});
a(document).one("click",function(){h.hide();
});
return false;
}function D(M,N){switch(N.item.context.id){case"mnuItemPortrait":j.sendCommand(j.Command.SetLandscape,0);
break;
case"mnuItemLandscape":j.sendCommand(j.Command.SetLandscape,1);
break;
}}function u(N){j.fileMenu.hide();
j.hideAllMenus_pageLayoutTab();
var M=document.getElementById("pageColumnsDropDown");
j.calcMenuWidths(M);
d.show().position({my:"left top",at:"left bottom",of:N.currentTarget});
a(document).one("click",function(){d.hide();
});
return false;
}function v(M,N){switch(N.item.context.id){case"mnuItemOneColumn":j.sendCommand(j.Command.SectionFormatProperty,j.SectionFormatProperty.Columns,1);
break;
case"mnuItemTwoColumns":j.sendCommand(j.Command.SectionFormatProperty,j.SectionFormatProperty.Columns,2);
break;
case"mnuItemThreeColumns":j.sendCommand(j.Command.SectionFormatProperty,j.SectionFormatProperty.Columns,3);
break;
case"mnuItemMoreColumns":j.sendCommand(j.Command.ShowDialog,j.DialogCategory.TXDialog,j.TXDialogType.SectionFormatDialog,j.SectionFormatDialogTab.Columns);
break;
}}function s(N){j.fileMenu.hide();
j.hideAllMenus_pageLayoutTab();
var M=document.getElementById("pageBreaksDropDown");
j.calcMenuWidths(M);
c.show().position({my:"left top",at:"left bottom",of:N.currentTarget});
a(document).one("click",function(){c.hide();
});
return false;
}function t(M,N){switch(N.item.context.id){case"mnuItemPageBreakPage":j.sendCommand(j.Command.InsertBreak,j.BreakType.Page);
break;
case"mnuItemPageBreakColumn":j.sendCommand(j.Command.InsertBreak,j.BreakType.Column);
break;
case"mnuItemPageBreakTextWrap":j.sendCommand(j.Command.InsertBreak,j.BreakType.NextLine);
break;
case"mnuItemSectionBreakPage":j.sendCommand(j.Command.InsertBreak,j.BreakType.SectionNextPage);
break;
case"mnuItemSectionBreakCont":j.sendCommand(j.Command.InsertBreak,j.BreakType.SectionContinuous);
break;
}}function A(O){j.fileMenu.hide();
j.hideAllMenus_pageLayoutTab();
var N=document.getElementById("pageFrameLineWidthDropDown");
j.calcMenuWidths(N);
var M=document.querySelectorAll("#pageFrameLineWidthDropDown div.ribbon-button-tiny");
[].forEach.call(M,function(P){P.classList.remove("ribbon-button-selected");
});
j.sendCommand(j.Command.SectionFormatProperty,j.SectionFormatProperty.PageBorder);
g.show().position({my:"left top",at:"left bottom",of:O.currentTarget});
a(document).one("click",function(){g.hide();
});
return false;
}function B(M,O){var N=O.item.context;
var P=0;
switch(N.id){case"mnuItemPageFrameLineWidth_NoLine":if(l&&l.VisibleBorders){j.sendCommand(j.Command.SectionFormatProperty,j.SectionFormatProperty.PageBorder,0,0,{lineToggleFlags:0});
}break;
case"mnuItemPageFrameLineWidth_0_25":P=0.25*20;
break;
case"mnuItemPageFrameLineWidth_0_5":P=0.5*20;
break;
case"mnuItemPageFrameLineWidth_0_75":P=0.75*20;
break;
case"mnuItemPageFrameLineWidth_1_0":P=1*20;
break;
case"mnuItemPageFrameLineWidth_1_5":P=1.5*20;
break;
case"mnuItemPageFrameLineWidth_2_25":P=2.25*20;
break;
case"mnuItemPageFrameLineWidth_3_0":P=3*20;
break;
case"mnuItemPageFrameLineWidth_4_5":P=4.5*20;
break;
case"mnuItemPageFrameLineWidth_6_0":P=6*20;
break;
}if(P>0){j.sendCommand(j.Command.SectionFormatProperty,j.SectionFormatProperty.PageBorder,0,0,{lineWidth:P});
}}function q(N){j.fileMenu.hide();
j.hideAllMenus_pageLayoutTab();
if(!b){return;
}var O=document.getElementById("pageBgColorDropDown");
j.calcMenuWidths(O);
var M=document.getElementById("tglBtnPageBgColorAutomatic");
M.classList.remove("ribbon-button-selected");
j.sendCommand(j.Command.PageBackgroundColor);
b.show().position({my:"left top",at:"left bottom",of:N.currentTarget});
a(document).on("click",function(P){b.hide();
});
return false;
}function r(N,P){var O=P.item.context;
if(O.hasOwnProperty("txColor")){var M=O.txColor;
j.sendCommand(j.Command.PageBackgroundColor,0,0,0,{color:M,isAuto:false});
}else{switch(O.id){case"mnuItemPageBgColorAutomatic":j.sendCommand(j.Command.PageBackgroundColor,0,0,0,{color:null,isAuto:true});
break;
case"mnuItemPageBgMoreColors":j.sendCommand(j.Command.ShowDialog,j.DialogCategory.TXDialog,j.TXDialogType.PageColorDialog);
break;
}}}function w(N){j.fileMenu.hide();
j.hideAllMenus_pageLayoutTab();
if(!e){return;
}var O=document.getElementById("pageFrameColorDropDown");
j.calcMenuWidths(O);
var M=document.getElementById("tglBtnPageFrameColorAutomatic");
M.classList.remove("ribbon-button-selected");
j.sendCommand(j.Command.SectionFormatProperty,j.SectionFormatProperty.PageBorder);
e.show().position({my:"left top",at:"left bottom",of:N.currentTarget});
a(document).on("click",function(P){e.hide();
});
return false;
}function x(N,Q){var O=Q.item.context;
var P={lineColor:null};
if(O.hasOwnProperty("txColor")){var M=O.txColor;
P.lineColor=M;
j.sendCommand(j.Command.SectionFormatProperty,j.SectionFormatProperty.PageBorder,0,0,P);
}else{switch(O.id){case"mnuItemPageFrameColorAutomatic":j.sendCommand(j.Command.SectionFormatProperty,j.SectionFormatProperty.PageBorder,0,0,P);
break;
case"mnuItemPageFrameMoreColors":j.sendCommand(j.Command.ShowDialog,j.DialogCategory.TXDialog,j.TXDialogType.SectionFormatDialog,j.SectionFormatDialogTab.Borders);
break;
}}}function y(N){j.fileMenu.hide();
j.hideAllMenus_pageLayoutTab();
if(!f){return;
}var O=document.getElementById("pageFrameDropDown");
j.calcMenuWidths(O);
var M=document.querySelectorAll("#pageFrameDropDown div.ribbon-button-tiny");
[].forEach.call(M,function(P){P.classList.remove("ribbon-button-selected");
});
j.sendCommand(j.Command.SectionFormatProperty,j.SectionFormatProperty.PageBorder);
f.show().position({my:"left top",at:"left bottom",of:N.currentTarget});
a(document).on("click",function(P){f.hide();
});
return false;
}function z(M,P){var N=P.item.context;
var O=l.VisibleBorders;
switch(N.id){case"mnuItemPageFrameLeft":if(O&I.Left){O&=~I.Left;
}else{O|=I.Left;
}break;
case"mnuItemPageFrameTop":if(O&I.Top){O&=~I.Top;
}else{O|=I.Top;
}break;
case"mnuItemPageFrameRight":if(O&I.Right){O&=~I.Right;
}else{O|=I.Right;
}break;
case"mnuItemPageFrameBottom":if(O&I.Bottom){O&=~I.Bottom;
}else{O|=I.Bottom;
}break;
case"mnuItemPageFrameAll":if(O==I.All){O=0;
}else{O=I.All;
}break;
}j.sendCommand(j.Command.SectionFormatProperty,j.SectionFormatProperty.PageBorder,0,0,{lineToggleFlags:O});
}function E(M){j.fileMenu.hide();
j.hideAllMenus_pageLayoutTab();
if(!i){return;
}var N=document.getElementById("paperSizesDropDown");
j.calcMenuWidths(N);
[].forEach.call(N.children,function(O){O.classList.remove("menu-item-selected");
});
j.sendCommand(j.Command.SectionFormatProperty,j.SectionFormatProperty.PageSize);
i.show().position({my:"left top",at:"left bottom",of:M.currentTarget});
j.limitMenuHeight("paperSizesDropDown");
a(document).on("click",function(O){i.hide();
});
return false;
}function F(M,R){var N=R.item.context;
var O=document.getElementById("paperSizesDropDown");
[].forEach.call(O.children,function(S){S.classList.remove("menu-item-selected");
});
N.classList.add("menu-item-selected");
var P=parseInt(N.dataset.index,10);
var Q=j.supportedPaperSizes[P];
j.sendCommand(j.Command.SectionFormatProperty,j.SectionFormatProperty.PageSize,0,0,Q);
}function k(){var M=document.getElementById("pageBgColorDropDown");
j.generateColorPalette(M,1);
M=document.getElementById("pageFrameColorDropDown");
j.generateColorPalette(M,1);
}function o(M){var N=parseFloat(M.target.value);
if(isNaN(N)){M.target.value=j.lastInputFormat.leftInd.toFixed(1);
}else{j.sendCommand(j.Command.InputFormat,j.InputFormatProperty.LeftIndent,Math.round(j.mm2twips(N)));
}}function p(M){var N=parseFloat(M.target.value);
if(isNaN(N)){M.target.value=j.lastInputFormat.rightInd.toFixed(1);
}else{j.sendCommand(j.Command.InputFormat,j.InputFormatProperty.RightIndent,Math.round(j.mm2twips(N)));
}}function n(M){var N=parseFloat(M.target.value);
if(isNaN(N)){M.target.value=j.lastInputFormat.topDist.toFixed(1);
}else{j.sendCommand(j.Command.InputFormat,j.InputFormatProperty.TopDistance,Math.round(j.mm2twips(N)));
}}function m(M){var N=parseFloat(M.target.value);
if(isNaN(N)){M.target.value=j.lastInputFormat.botDist.toFixed(1);
}else{j.sendCommand(j.Command.InputFormat,j.InputFormatProperty.BottomDistance,Math.round(j.mm2twips(N)));
}}j.hideAllMenus_pageLayoutTab=function(){h.hide();
c.hide();
d.hide();
g.hide();
b.hide();
e.hide();
f.hide();
i.hide();
};
return L;
}(TXTextControl||{},j$1_10_2));
var TXTextControl=(function(S,a){var g=S._private=S._private||{};
var h,d,c,b;
g.MenuTransformState=(function(){function T(){this.scrollEnabled=false;
this.deltaY=0;
this.maxDelta=0;
this.touchInProgress=false;
this.touchPrev=null;
this.deltaFactor=1;
this.direction=null;
}T.prototype.reset=function(){this.scrollEnabled=false;
this.deltaY=this.maxDelta=0;
this.touchInProgress=false;
this.touchPrev=null;
this.direction=null;
};
return T;
})();
var e=[];
g.dbScheme=null;
g.currentFieldData={fieldAdapter:null,mergeFieldType:null,textField:null};
g.MergeField=(function(T){__extends(U,T);
function U(name){T.call(this,true);
this.name=name||"MERGEFIELD";
this.text="«"+this.name+"»";
this.textFormat=0;
this.textBefore="";
this.textAfter="";
this.dateTimeFormat="";
this.numericFormat="";
}U.prototype.toUpperCamelCase=function(){return{Name:this.name,Text:this.text,TextFormat:this.textFormat,TextBefore:this.textBefore,TextAfter:this.textAfter,DateTimeFormat:this.dateTimeFormat,NumericFormat:this.numericFormat,PreserveFormatting:this.preserveFormatting};
};
return U;
})(g.FieldAdapter);
g.MailMergeNavButton={First:0,Previous:1,Next:2,Last:3,};
g.DataSourceManagerEvent={PossibleMergeFieldColumnsChanged:{id:1,name:"dataSourceManager_possibleMergeFieldColumnsChanged"},PossibleMergeBlockTablesChanged:{id:2,name:"dataSourceManager_possibleMergeBlockTablesChanged"},MasterDataTableInfoChanged:{id:3,name:"dataSourceManager_masterDataTableInfoChanged"},IsMergingPossibleChanged:{id:4,name:"dataSourceManager_isMergingPossibleChanged"},DataTablesChanged:{id:5,name:"dataSourceManager_dataTablesChanged"},DataRelationsChanged:{id:6,name:"dataSourceManager_dataRelationsChanged"},DataProviderNameChanged:{id:7,name:"dataSourceManager_dataProviderNameChanged"},ConnectionStringChanged:{id:8,name:"dataSourceManager_connectionStringChanged"}};
g.attachMailingsTabEventHandlers=function(){d=a("#insertSpecialFieldDropDown").menu().hide();
b=a("#insertMergeBlockDropDown").menu().hide();
c=a("#insertMergeFieldDropDown").menu().hide();
d.on("menuselect",M);
b.on("menuselect",I);
c.on("menuselect",K);
document.addEventListener("dbSchemeReceived",t);
document.addEventListener("fieldDisplayModeChanged",v);
document.addEventListener("fieldDataReceived",u);
document.addEventListener("mergeFieldHighlightingChanged",G);
document.addEventListener("mergeBlockHighlightingChanged",F);
document.addEventListener(g.DataSourceManagerEvent.IsMergingPossibleChanged.name,p);
document.addEventListener(g.DataSourceManagerEvent.DataTablesChanged.name,o);
document.addEventListener(g.DataSourceManagerEvent.MasterDataTableInfoChanged.name,q);
document.addEventListener(g.DataSourceManagerEvent.PossibleMergeBlockTablesChanged.name,r);
document.addEventListener(g.DataSourceManagerEvent.PossibleMergeFieldColumnsChanged.name,s);
a("#btnLoadDBScheme").click(function(){g.openFile(g.FileType.DataBase);
});
a("#btnEditDataRelations").click(function(){g.sendCommand(g.Command.EditDataRelations);
});
a("#btnFieldProperties").click(function(){if(g.currentFieldData){g.showFieldDialog(g.currentFieldData.fieldAdapter,g.currentFieldData.mergeFieldType);
}});
a("#btnDeleteField").click(function(){g.sendCommand(g.Command.DeleteItem,g.ItemType.ApplicationField);
});
a("#btnEditMergeBlocks").click(function(){g.sendCommand(g.Command.EditMergeBlocks);
});
a("#tglBtnShowFieldCodes").click(function(){if(!a(this).hasClass("ribbon-button-selected")){g.sendCommand(g.Command.SetFieldDisplayMode,g.FieldDisplayMode.ShowFieldCodes);
}});
a("#tglBtnShowFieldText").click(function(){if(!a(this).hasClass("ribbon-button-selected")){g.sendCommand(g.Command.SetFieldDisplayMode,g.FieldDisplayMode.ShowFieldText);
}});
a("#btnPreviewMergeResults").click(function(){g.sendCommand(g.Command.SetAppMode,g.ApplicationMode.MailMergePreview);
});
a("#btnCloseReportingPreview").click(function(){this.classList.add("txui-state-disabled");
g.sendCommand(g.Command.SetAppMode,g.ApplicationMode.Normal);
});
a("#btnFirstRecord").click(function(){g.sendCommand(g.Command.MailMergePrevNav,g.MailMergeNavButton.First);
});
a("#btnPrevRecord").click(function(){g.sendCommand(g.Command.MailMergePrevNav,g.MailMergeNavButton.Previous);
});
a("#btnNextRecord").click(function(){g.sendCommand(g.Command.MailMergePrevNav,g.MailMergeNavButton.Next);
});
a("#btnLastRecord").click(function(){g.sendCommand(g.Command.MailMergePrevNav,g.MailMergeNavButton.Last);
});
var T=function(){g.sendCommand(g.Command.FinishAndMerge);
};
a("#btnFinishAndMerge").click(function(){if(g.documentDirty){g.fileSaveQuestion(T);
}else{T();
}});
e.insertMergeFieldDropDown=new g.MenuTransformState();
var U=document.getElementById("insertMergeFieldDropDown");
U.dataset.transformStateId="insertMergeFieldDropDown";
U.addEventListener("mousewheel",B);
U.addEventListener("DOMMouseScroll",B);
if(g.isTouchDevice){U.addEventListener("touchstart",E);
U.addEventListener("touchend",C);
U.addEventListener("touchcancel",C);
U.addEventListener("touchmove",D);
}a("#drpDnBtnSelectMasterTable").click(N);
a("#drpDnBtnInsertMergeField").click(J);
a("#drpDnBtnInsertSpecialField").click(L);
a("#drpDnBtnInsertMergeBlock").click(H);
};
function B(U){var V=x(U.currentTarget);
var T=((U.wheelDelta||-(U.detail*40))/4)*V.deltaFactor;
Q(U.currentTarget,T,V);
if(U.cancelable){U.preventDefault();
}U.stopPropagation();
}function E(T){var U=x(T.currentTarget);
U.touchInProgress=(T.touches.length==1);
if(U.touchInProgress){U.touchPrev=g.cloneTouch(T.touches[0]);
}T.stopPropagation();
}function C(T){var U=x(T.currentTarget);
U.touchInProgress=false;
U.touchPrev=null;
T.stopPropagation();
}function D(U){var V=x(U.currentTarget);
if(!V.touchInProgress){return;
}if(U.touches.length!=1){V.touchInProgress=false;
return;
}var T=U.changedTouches[0].clientY-V.touchPrev.clientY;
V.touchPrev=g.cloneTouch(U.changedTouches[0]);
Q(U.currentTarget,T,V);
if(U.cancelable){U.preventDefault();
}U.stopPropagation();
}function N(T){g.fileMenu.hide();
g.hideAllMenus_mailingsTab();
if(!h){return;
}h.show().position({my:"left top",at:"left bottom",of:T.currentTarget});
g.limitMenuHeight("selectMasterTableDropDown");
a(document).one("click",function(){h.hide();
});
return false;
}function P(){for(var U in e){if(e.hasOwnProperty(U)){e[U].reset();
}}var T=document.getElementById("insertMergeFieldDropDown");
T.style.transform="";
var V=T.querySelectorAll("ul");
[].forEach.call(V,function(W){W.style.transform="";
});
}function n(W,U){U=!!U;
var T=W.clientHeight;
var V=g.clientSize.Height-g.ribbonBarHeight-g.StatusBarHeight;
var X=x(W);
if((T>V)||U){X.scrollEnabled=true;
X.maxDelta=U?T:(T-V);
}else{X.reset();
}if(!U){var Y=W.querySelectorAll("ul");
[].forEach.call(Y,function(Z){Z.style.display="";
});
[].forEach.call(Y,function(Z){n(Z,true);
});
[].forEach.call(Y,function(Z){Z.style.display="none";
});
}}function x(T){if(!T){throw new Error('Argument "menu" is null.');
}var U=T.dataset.transformStateId;
if(!U){throw new Error("Menu transform / scroll state id not found in element dataset.");
}return e[U];
}function Q(W,T,X){var U=null;
if(!X.scrollEnabled){return;
}if(X.direction===null){V();
}if(X.direction===null){console.error("Merge field sub menu scroll direction could not be determined for unknown reasons.");
X.direction=-1;
}switch(X.direction){case 1:X.deltaY=Math.min(Math.max((X.deltaY+T),0),X.maxDelta);
break;
case -1:X.deltaY=Math.min(Math.max((X.deltaY+T),-X.maxDelta),0);
break;
}W.style.transform="translate(0px, "+X.deltaY+"px)";
function V(){if(W.id==="insertMergeFieldDropDown"){X.direction=-1;
}else{if(W.parentElement.parentElement){var aa=W.parentElement.parentElement;
if(aa.tagName==="UL"){var Z=W.getBoundingClientRect().bottom;
if(aa.id==="insertMergeFieldDropDown"){var Y=W.parentElement;
if(Y.tagName==="LI"){U=(Z-Y.getBoundingClientRect().bottom);
}}else{U=Z-aa.getBoundingClientRect().bottom;
}if(U!==null){X.direction=(U<=2)?1:-1;
}}}}}}function J(U){g.fileMenu.hide();
g.hideAllMenus_mailingsTab();
P();
var T=document.getElementById("insertMergeFieldDropDown");
g.calcMenuWidths(T);
c.show().position({my:"left top",at:"left bottom",of:U.currentTarget});
n(T);
a(document).on("click",function(V){if(!(g.isInsideElementWithID(V.target,"insertMergeFieldDropDown")&&g.isPartOfMenuItemWithSubMenu(V.target))){c.hide();
P();
a(document).off(V);
}});
return false;
}function L(U){g.fileMenu.hide();
g.hideAllMenus_mailingsTab();
var T=document.getElementById("insertSpecialFieldDropDown");
g.calcMenuWidths(T);
d.show().position({my:"left top",at:"left bottom",of:U.currentTarget});
g.limitMenuHeight("insertSpecialFieldDropDown");
a(document).one("click",function(){d.hide();
});
return false;
}function M(U,V){var T;
switch(V.item.context.id){case"mnuItemInsertIFField":T=new g.IfFieldDialog();
break;
case"mnuItemInsertInclTxtField":T=new g.IncludeTextFieldDialog();
break;
case"mnuItemInsertDateField":T=new g.DateFieldDialog();
break;
case"mnuItemInsertNextField":g.sendCommand(g.Command.InsertItem,g.ItemType.FieldAdapter,g.FieldType.NextField);
break;
case"mnuItemInsertNextIfField":T=new g.NextIfFieldDialog();
break;
}if(T){T.showModal();
}}function H(U){g.fileMenu.hide();
g.hideAllMenus_mailingsTab();
if(!b){return;
}var T=document.getElementById("insertMergeBlockDropDown");
g.calcMenuWidths(T);
b.show().position({my:"left top",at:"left bottom",of:U.currentTarget});
g.limitMenuHeight("insertMergeBlockDropDown");
a(document).one("click",function(){b.hide();
});
return false;
}function O(U,W){var T=W.item.context;
var V=z(T);
if(!V||(V.length==0)){return;
}g.selectMasterTable(V);
}function z(T){if(!T||!T.dataset.tableName){return"";
}return T.dataset.tableName;
}function y(T){var X="";
if(!T||(!T.dataset.columnName&&!T.dataset.tableName&&!T.dataset.childTableName)){return"";
}var U=T.parentElement;
while(U&&(U.nodeName.toLowerCase()!=="li")){U=U.parentElement;
}var V="";
if(T.dataset.columnName){V=T.dataset.columnName;
}else{if(T.dataset.tableName){V=T.dataset.tableName;
}else{if(T.dataset.childTableName){V=T.dataset.childTableName;
}}}var W=y(U);
if(W.length){X=W+"."+V;
}else{X=V;
}return X;
}g.insertMergeField=function(U){var T={Name:U,Text:"«"+U+"»"};
g.sendCommand(g.Command.InsertItem,g.ItemType.FieldAdapter,g.FieldType.MergeField,0,T);
};
g.insertMergeBlock=function(T){T=JSON.stringify(T);
g.sendCommand(g.Command.InsertItem,g.ItemType.MergeBlock,0,0,T);
};
function K(W,Z){var U=Z.item.context;
if(U.querySelectorAll("ul").length){return;
}var Y=y(U)||U.id;
if(!Y||(Y.length==0)){return;
}switch(Y){case"mnuItemInsertMergeField":var X=new g.MergeField();
var V=new g.MergeFieldDialog(X.toUpperCamelCase());
V.showModal();
break;
case"mnuItemHighlightMergeFields":var T=a("#tglBtnHighlightMergeFields");
if(T.hasClass("ribbon-button-selected")){g.sendCommand(g.Command.HighlightMergeFields,0);
}else{g.sendCommand(g.Command.HighlightMergeFields,1);
}break;
default:g.insertMergeField(Y);
}}function I(V,X){var U=X.item.context;
var W=z(U)||U.id;
if(!W||(W.length==0)){return;
}switch(W){case"mnuItemInsertMergeBlock":g.insertMergeBlock();
break;
case"mnuItemHighlightMergeBlocks":var T=a("#tglBtnHighlightMergeBlocks");
if(T.hasClass("ribbon-button-selected")){g.sendCommand(g.Command.HighlightMergeBlocks,0);
}else{g.sendCommand(g.Command.HighlightMergeBlocks,1);
}break;
default:g.insertMergeBlock(W);
}}function t(U){var V=U.detail;
var W=V.suppressMessage;
delete V.suppressMessage;
g.dbScheme=V;
var T=document.getElementById("btnEditDataRelations");
if(V.HasReadOnlyDataRelations){T.classList.add("txui-state-disabled");
}else{T.classList.remove("txui-state-disabled");
}if(g.dbScheme&&!W){g.showMsgDiv(g.variousMessages.databaseLoadedMessage.text,true);
}}function v(T){var U=T.detail.fieldDisplayMode;
switch(U){case g.FieldDisplayMode.ShowFieldText:a("#tglBtnShowFieldCodes").removeClass("ribbon-button-selected");
a("#tglBtnShowFieldText").addClass("ribbon-button-selected");
break;
case g.FieldDisplayMode.ShowFieldCodes:a("#tglBtnShowFieldCodes").addClass("ribbon-button-selected");
a("#tglBtnShowFieldText").removeClass("ribbon-button-selected");
break;
}}function u(T){g.currentFieldData.fieldAdapter=T.detail.field;
g.currentFieldData.mergeFieldType=T.detail.fieldType;
if(g.currentFieldData.fieldAdapter){a("#btnFieldProperties").removeClass("txui-state-disabled");
a("#btnDeleteField").removeClass("txui-state-disabled");
}else{a("#btnFieldProperties").addClass("txui-state-disabled");
a("#btnDeleteField").addClass("txui-state-disabled");
}}function G(T){var U=T.detail.highlight;
if(U){a("#tglBtnHighlightMergeFields").addClass("ribbon-button-selected");
}else{a("#tglBtnHighlightMergeFields").removeClass("ribbon-button-selected");
}}function F(T){var U=T.detail.highlight;
if(U){a("#tglBtnHighlightMergeBlocks").addClass("ribbon-button-selected");
}else{a("#tglBtnHighlightMergeBlocks").removeClass("ribbon-button-selected");
}}function p(W){var U;
var T=W.detail;
var V=["drpDnBtnSelectMasterTable","btnFinishAndMerge","btnPreviewMergeResults","drpDnBtnInsertMergeBlock"];
V.forEach(function(X){U=document.getElementById(X);
if(T.IsMergingPossible){U.classList.remove("txui-state-disabled");
}else{U.classList.add("txui-state-disabled");
}});
}function o(U){var T=U.detail;
var V=a("#selectMasterTableDropDown");
V.empty();
T.Tables.forEach(function(W){m(V[0],W,false,true);
});
if(!h){h=V.menu().hide();
h.on("menuselect",O);
}else{V.menu("refresh");
}g.calcMenuWidths(V[0]);
}function R(V){var U=a("#selectMasterTableDropDown div.ribbon-button");
U.removeClass("ribbon-button-selected");
var T=a('#selectMasterTableDropDown li[data-table-name="'+V.toLowerCase()+'"] div.ribbon-button');
T.addClass("ribbon-button-selected");
}function q(U){var T=U.detail;
R(T.Table.TableName);
}function r(U){var T=U.detail;
var V=a("#insertMergeBlockDropDown");
var W=[];
W.push(document.getElementById("mnuItemInsertMergeBlock"));
W.push(document.getElementById("mnuItemHighlightMergeBlocks"));
W.forEach(function(X){V[0].removeChild(X);
});
V.empty();
T.Tables.forEach(function(X){m(V[0],X,false,false);
});
W.forEach(function(X){V[0].appendChild(X);
});
V.menu("refresh");
}function j(Z,T){var Y=document.createElement("li");
Z.appendChild(Y);
Y.dataset.columnName=T.ColumnName.toLowerCase();
var U=document.createElement("a");
Y.appendChild(U);
var W=document.createElement("div");
U.appendChild(W);
W.classList.add("large-menu-item-image-container");
var X=document.createElement("img");
W.appendChild(X);
X.setAttribute("src",g.imageResources.large.mailmergeinsertfield);
var V=document.createElement("div");
U.appendChild(V);
V.classList.add("large-menu-item-caption-container");
var aa=document.createElement("p");
V.appendChild(aa);
aa.textContent=T.ColumnName;
}function k(V,U,T){U.forEach(function(W){j(V,W);
});
T.forEach(function(W){m(V,W,true,false);
});
}var f;
function s(U){var T=U.detail;
var W=[];
f=0;
var V=a("#insertMergeFieldDropDown");
W.push(document.getElementById("mnuItemInsertMergeField"));
W.push(document.getElementById("mnuItemHighlightMergeFields"));
W.forEach(function(X){V[0].removeChild(X);
});
V.empty();
k(V[0],T.Columns,T.ChildTables);
W.forEach(function(X){V[0].appendChild(X);
});
V.menu("refresh");
}function m(Z,ad,T,ac){var Y=document.createElement("li");
Z.appendChild(Y);
Y.dataset.tableName=ad.TableName.toLowerCase();
var U=document.createElement("a");
Y.appendChild(U);
var W=document.createElement("div");
U.appendChild(W);
W.classList.add("large-menu-item-image-container");
if(ac){W.classList.add("ribbon-button");
}var X=document.createElement("img");
W.appendChild(X);
X.setAttribute("src",g.imageResources.large.table);
var V=document.createElement("div");
U.appendChild(V);
V.classList.add("large-menu-item-caption-container");
var aa=document.createElement("p");
V.appendChild(aa);
aa.textContent=ad.TableName;
if(T){var ab=document.createElement("ul");
Y.appendChild(ab);
ab.classList.add("dropDownMenu");
l(ab);
i(ab,ad);
}}function i(T,U){U.Columns.forEach(function(V){var X=document.createElement("li");
T.appendChild(X);
X.dataset.columnName=V.ColumnName;
var W=document.createElement("a");
X.appendChild(W);
W.textContent=V.ColumnName;
});
U.ChildTables.forEach(function(V){var X=document.createElement("li");
T.appendChild(X);
X.dataset.childTableName=V.TableName.toLowerCase();
var W=document.createElement("a");
X.appendChild(W);
W.textContent=V.TableName;
var Y=document.createElement("ul");
X.appendChild(Y);
Y.classList.add("dropDownMenu");
l(Y);
i(Y,V);
});
}function l(T){var V=""+f++;
T.dataset.transformStateId=V;
var U=new g.MenuTransformState();
U.deltaFactor=0.5;
e[V]=U;
T.addEventListener("mousewheel",B);
T.addEventListener("DOMMouseScroll",B);
if(g.isTouchDevice){T.addEventListener("touchstart",E);
T.addEventListener("touchend",C);
T.addEventListener("touchcancel",C);
T.addEventListener("touchmove",D);
}}g.calcMenuWidths=function(V){var Z=[];
for(var W=0;
W<V.children.length;
++W){var U=V.children[W];
if(U.tagName==="LI"){for(var X=0;
X<U.children.length;
++X){var T=U.children[X];
if(T.tagName==="UL"){Z.push(T);
}}}}for(W=0;
W<Z.length;
++W){var Y=Z[W];
g.calcMenuWidths(Y);
}V.style.width=w(V)+"px";
};
function A(T){return(T.style.overflowY==="auto")||(T.style.overflowY==="scroll");
}function w(W){var af=0;
var ah;
var T=A(W)?27:10;
for(var ab=0;
ab<W.children.length;
++ab){var Z=W.children[ab];
if(!Z.children.length){continue;
}var X=Z.children[0];
if(X.nodeName!=="A"){continue;
}var V=getComputedStyle(X);
var U=X.cloneNode(true);
U.style.fontFamily=V.fontFamily;
U.style.fontSize=V.fontSize;
var ag=document.createElement("TABLE");
ag.style.position="fixed";
ag.style.left="-9999px";
ag.style.whiteSpace="nowrap";
ag.style.borderCollapse="collapse";
ag.style.fontSize=V.fontSize;
ag.style.fontFamily=V.fontFamily;
var ai=document.createElement("TR");
ag.appendChild(ai);
for(var ac=0;
ac<U.childNodes.length;
++ac){var ae=U.childNodes[ac].cloneNode(true);
switch(ae.nodeType){case Node.ELEMENT_NODE:if((ae.tagName==="DIV")&&(ae.classList.contains("menu-item-category-header"))){break;
}ah=document.createElement("TD");
var aa=ae.querySelectorAll("h1");
for(var ad=0;
ad<aa.length;
++ad){aa[ad].style.fontSize=V.fontSize;
aa[ad].style.fontWeight="bold";
}ah.appendChild(ae);
ai.appendChild(ah);
break;
case Node.TEXT_NODE:ah=document.createElement("TD");
ah.textContent=ae.data;
ai.appendChild(ah);
break;
}}var Y=document.getElementById("txTemplateDesignerContainer");
Y.appendChild(ag);
var aj=ag.clientWidth+T;
af=Math.max(af,aj);
Y.removeChild(ag);
}return af;
}g.hideAllMenus_mailingsTab=function(){if(c){c.hide();
}if(h){h.hide();
}if(b){b.hide();
}d.hide();
P();
};
return S;
}(TXTextControl||{},j$1_10_2));
var TXTextControl=(function(f,a){var b=f._private=f._private||{};
var c;
b.SpecialZoomFactor={PageWidth:-1,WholePage:-2,TextWidth:-3};
b.attachViewTabEventHandlers=function(){var h;
c=a("#zoomDropDown").menu().hide();
c.on("menuselect",e);
a("#drpDnBtnZoom").click(d);
a("#btnZoom100").click(function(){b.sendCommand(b.Command.Zoom,100);
});
a("#btnZoomPageWidth").click(function(){b.sendCommand(b.Command.Zoom,b.SpecialZoomFactor.PageWidth);
});
a("#btnZoomFullPage").click(function(){b.sendCommand(b.Command.Zoom,b.SpecialZoomFactor.WholePage);
});
a("#btnZoomTextWidth").click(function(){b.sendCommand(b.Command.Zoom,b.SpecialZoomFactor.TextWidth);
});
document.getElementById("chkRulerVert").addEventListener("change",function(i){b.showVerticalRuler(i.target.checked);
});
document.getElementById("chkRulerHor").addEventListener("change",function(i){b.showHorizontalRuler(i.target.checked);
});
document.getElementById("chkRulerHor").addEventListener("change",function(i){b.showHorizontalRuler(i.target.checked);
});
document.getElementById("chkStatusBar").addEventListener("change",function(i){b.showStatusBar(i.target.checked);
});
var g=document.getElementById("btnViewTableGridlines");
g.addEventListener("click",function(i){h=document.getElementById("tglBtnViewTableGridlines");
if(h.classList.contains("ribbon-button-selected")){b.sendCommand(b.Command.DisplayVisualElement,b.VisualElement.TableGridLines,0);
}else{b.sendCommand(b.Command.DisplayVisualElement,b.VisualElement.TableGridLines,1);
}});
g=document.getElementById("btnViewDrawingMarkerLines");
g.addEventListener("click",function(i){h=document.getElementById("tglBtnViewDrawingMarkerLines");
if(h.classList.contains("ribbon-button-selected")){b.sendCommand(b.Command.DisplayVisualElement,b.VisualElement.DrawingMarkerLines,0);
}else{b.sendCommand(b.Command.DisplayVisualElement,b.VisualElement.DrawingMarkerLines,1);
}});
g=document.getElementById("btnViewBookmarkMarkers");
g.addEventListener("click",function(i){h=document.getElementById("tglBtnViewBookmarkMarkers");
if(h.classList.contains("ribbon-button-selected")){b.sendCommand(b.Command.DisplayVisualElement,b.VisualElement.BookmarkMarkers,0);
}else{b.sendCommand(b.Command.DisplayVisualElement,b.VisualElement.BookmarkMarkers,1);
}});
g=document.getElementById("btnViewControlCharacters");
g.addEventListener("click",function(i){h=document.getElementById("tglBtnViewControlCharacters");
if(h.classList.contains("ribbon-button-selected")){b.sendCommand(b.Command.DisplayVisualElement,b.VisualElement.ControlChars,0);
}else{b.sendCommand(b.Command.DisplayVisualElement,b.VisualElement.ControlChars,1);
}});
g=document.getElementById("btnViewTextframeMarkerLines");
g.addEventListener("click",function(i){h=document.getElementById("tglBtnViewTextframeMarkerLines");
if(h.classList.contains("ribbon-button-selected")){b.sendCommand(b.Command.DisplayVisualElement,b.VisualElement.TextFrameMarkerLines,0);
}else{b.sendCommand(b.Command.DisplayVisualElement,b.VisualElement.TextFrameMarkerLines,1);
}});
g=document.getElementById("btnViewFrameAnchors");
g.addEventListener("click",function(i){h=document.getElementById("tglBtnViewFrameAnchors");
if(h.classList.contains("ribbon-button-selected")){b.sendCommand(b.Command.DisplayVisualElement,b.VisualElement.FrameAnchors,0);
}else{b.sendCommand(b.Command.DisplayVisualElement,b.VisualElement.FrameAnchors,1);
}});
};
function d(g){b.fileMenu.hide();
b.hideAllMenus_viewTab();
var h=document.getElementById("zoomDropDown");
b.calcMenuWidths(h);
c.show().position({my:"left top",at:"left bottom",of:g.currentTarget});
a(document).one("click",function(){c.hide();
});
return false;
}function e(g,h){switch(h.item.context.id){case"mnuItemZoom_25":b.sendCommand(b.Command.Zoom,25);
break;
case"mnuItemZoom_50":b.sendCommand(b.Command.Zoom,50);
break;
case"mnuItemZoom_75":b.sendCommand(b.Command.Zoom,75);
break;
case"mnuItemZoom_100":b.sendCommand(b.Command.Zoom,100);
break;
case"mnuItemZoom_150":b.sendCommand(b.Command.Zoom,150);
break;
case"mnuItemZoom_200":b.sendCommand(b.Command.Zoom,200);
break;
case"mnuItemZoom_400":b.sendCommand(b.Command.Zoom,400);
break;
}}b.hideAllMenus_viewTab=function(){c.hide();
};
return f;
}(TXTextControl||{},j$1_10_2));
var TXTextControl=(function(C,a){var c=C._private=C._private||{};
var d,b,e,i,g,f,h;
c.TableCommand={SelectElement:0,DeleteElement:1,InsertElement:2,CellAlignment:3,MergeCells:4,SplitCells:5,SplitTable:6,Create:7};
c.TableElement={Cell:0,Column:1,Row:2,WholeTable:3,};
c.VerticalAlignment={Top:0,Center:1,Bottom:2};
c.HorizontalAlignment={Left:1,Right:2,Center:3,Justify:4};
c.TableFormatDialogTab={FrameAndColor:0,SizeAndFormatting:1};
var j={vertical:c.VerticalAlignment.Top,horizontal:c.HorizontalAlignment.Left};
c.attachTableLayoutTabEventHandlers=function(){k();
d=a("#tableSelectDropDown").menu().hide();
b=a("#tableDeleteDropDown").menu().hide();
e=a("#tableSplitDropDown").menu().hide();
i=a("#tableFramesDropDown").menu().hide();
g=a("#tableFrameLineColorDropDown").menu().hide();
f=a("#tableFrameFillColorDropDown").menu().hide();
h=a("#tableFrameLineWidthDropDown").menu().hide();
d.on("menuselect",u);
b.on("menuselect",l);
e.on("menuselect",v);
i.on("menuselect",z);
g.on("menuselect",x);
f.on("menuselect",w);
h.on("menuselect",y);
a("#drpDnBtnTableSelect").click(p);
a("#drpDnBtnTableDelete").click(n);
a("#drpDnBtnSplitTable").click(m);
a("#drpDnBtnTableFrames").click(o);
a("#drpDnBtnTblLineColor").click(r);
a("#drpDnBtnTblBgColor").click(q);
a("#drpDnBtnTblLineWidth").click(s);
a("#tglBtnViewGridLines").click(function(){if(a(this).hasClass("ribbon-button-selected")){c.sendCommand(c.Command.DisplayVisualElement,c.VisualElement.TableGridLines,0);
a(this).removeClass("ribbon-button-selected");
}else{c.sendCommand(c.Command.DisplayVisualElement,c.VisualElement.TableGridLines,1);
a(this).addClass("ribbon-button-selected");
}});
a("#btnTableProperties").click(function(){c.sendCommand(c.Command.ShowDialog,c.DialogCategory.TXDialog,c.TXDialogType.TableFormatDialog,c.TableFormatDialogTab.FrameAndColor);
});
a("#ribbonGroupTblLayoutAlignment div.ribbon-button-tiny").click(A);
a("#ribbonGroupTblLayoutRowsCols div.ribbon-button-big").click(B);
a("#ribbonGroupTblLayoutMerge div.ribbon-button-big").click(t);
};
function k(){var E=document.getElementById("tableFrameLineColorDropDown");
c.generateColorPalette(E,1);
E=document.getElementById("tableFrameFillColorDropDown");
c.generateColorPalette(E,1);
}function p(F){c.fileMenu.hide();
c.hideAllMenus_tableLayoutTab();
if(!d){return;
}var E=document.getElementById("tableSelectDropDown");
c.calcMenuWidths(E);
d.show().position({my:"left top",at:"left bottom",of:F.currentTarget});
a(document).one("click",function(){d.hide();
});
return false;
}function u(E,G){var F=G.item.context.id;
switch(F){case"mnuItemSelectTableCell":c.sendCommand(c.Command.TableCommand,c.TableCommand.SelectElement,c.TableElement.Cell);
break;
case"mnuItemSelectTableColumn":c.sendCommand(c.Command.TableCommand,c.TableCommand.SelectElement,c.TableElement.Column);
break;
case"mnuItemSelectTableRow":c.sendCommand(c.Command.TableCommand,c.TableCommand.SelectElement,c.TableElement.Row);
break;
case"mnuItemSelectTable":c.sendCommand(c.Command.TableCommand,c.TableCommand.SelectElement,c.TableElement.WholeTable);
break;
}}function n(F){c.fileMenu.hide();
c.hideAllMenus_tableLayoutTab();
if(!b){return;
}var E=document.getElementById("tableDeleteDropDown");
c.calcMenuWidths(E);
b.show().position({my:"left top",at:"left bottom",of:F.currentTarget});
a(document).on("click",function(G){if(!(c.isInsideElementWithID(G.target,"tableDeleteDropDown")&&c.isPartOfMenuItemWithSubMenu(G.target))){b.hide();
a(document).off(G);
}});
return false;
}function l(E,G){var F=G.item.context.id;
switch(F){case"mnuItemMoveCellsToLeft":c.sendCommand(c.Command.TableCommand,c.TableCommand.DeleteElement,c.TableElement.Cell);
break;
case"mnuItemDeleteWholeColumn":case"mnuItemDeleteTableColumns":c.sendCommand(c.Command.TableCommand,c.TableCommand.DeleteElement,c.TableElement.Column);
break;
case"mnuItemDeleteWholeRow":case"mnuItemDeleteTableRows":c.sendCommand(c.Command.TableCommand,c.TableCommand.DeleteElement,c.TableElement.Row);
break;
case"mnuItemDeleteTable":c.sendCommand(c.Command.TableCommand,c.TableCommand.DeleteElement,c.TableElement.WholeTable);
break;
}}function m(F){c.fileMenu.hide();
c.hideAllMenus_tableLayoutTab();
if(!e){return;
}var E=document.getElementById("tableSplitDropDown");
c.calcMenuWidths(E);
e.show().position({my:"left top",at:"left bottom",of:F.currentTarget});
a(document).one("click",function(){e.hide();
});
return false;
}function v(E,G){var F=G.item.context.id;
switch(F){case"mnuItemTableSplitAbove":c.sendCommand(c.Command.TableCommand,c.TableCommand.SplitTable,c.TableAddPosition.Before);
break;
case"mnuItemTableSplitBelow":c.sendCommand(c.Command.TableCommand,c.TableCommand.SplitTable,c.TableAddPosition.After);
break;
}}function o(E){c.fileMenu.hide();
c.hideAllMenus_tableLayoutTab();
var F=document.getElementById("tableFramesDropDown");
c.calcMenuWidths(F);
i.show().position({my:"left top",at:"left bottom",of:E.currentTarget});
a(document).one("click",function(){i.hide();
});
return false;
}function z(F,H){var E=null,G;
switch(H.item.context.id){case"mnuItemTblFrameLeft":E=a("#tglBtnTblFrameLeft");
G=c.InputFormatProperty.LeftFrameLine;
break;
case"mnuItemTblFrameTop":E=a("#tglBtnTblFrameTop");
G=c.InputFormatProperty.TopFrameLine;
break;
case"mnuItemTblFrameRight":E=a("#tglBtnTblFrameRight");
G=c.InputFormatProperty.RightFrameLine;
break;
case"mnuItemTblFrameBottom":E=a("#tglBtnTblFrameBottom");
G=c.InputFormatProperty.BottomFrameLine;
break;
case"mnuItemTblFrameOutside":E=a("#tglBtnTblFrameOutside");
G=c.InputFormatProperty.BoxFrame;
break;
case"mnuItemTblFrameAll":E=a("#tglBtnTblFrameAll");
G=c.InputFormatProperty.AllFrameLines;
break;
case"mnuItemTblFrameInsideHor":E=a("#tglBtnTblFrameInsideHor");
G=c.InputFormatProperty.InnerHorizontalFrameLines;
break;
case"mnuItemTblFrameInsideVert":E=a("#tglBtnTblFrameInsideVert");
G=c.InputFormatProperty.InnerVerticalFrameLines;
break;
}if(E){if(E.hasClass("ribbon-button-selected")){c.sendCommand(c.Command.InputFormat,G,0);
}else{c.sendCommand(c.Command.InputFormat,G,1);
}}}function r(E){c.fileMenu.hide();
c.hideAllMenus_tableLayoutTab();
var F=document.getElementById("tableFrameLineColorDropDown");
c.calcMenuWidths(F);
g.show().position({my:"left top",at:"left bottom",of:E.currentTarget});
a(document).one("click",function(){g.hide();
});
return false;
}function x(F,H){var G=H.item.context;
if(G.hasOwnProperty("txColor")){var E=G.txColor;
c.sendCommand(c.Command.InputFormat,c.InputFormatProperty.FrameLineColor,0,0,{color:E,isAuto:false});
}else{switch(G.id){case"mnuItemTblFrameColorAutomatic":c.sendCommand(c.Command.InputFormat,c.InputFormatProperty.FrameLineColor,0,0,{color:null,isAuto:true});
break;
case"mnuItemTblFrameMoreColors":c.sendCommand(c.Command.ShowDialog,c.DialogCategory.TXDialog,c.TXDialogType.FrameLineColorDialog);
break;
}}}function q(E){c.fileMenu.hide();
c.hideAllMenus_tableLayoutTab();
var F=document.getElementById("tableFrameFillColorDropDown");
c.calcMenuWidths(F);
f.show().position({my:"left top",at:"left bottom",of:E.currentTarget});
a(document).one("click",function(){f.hide();
});
return false;
}function w(F,H){var G=H.item.context;
if(G.hasOwnProperty("txColor")){var E=G.txColor;
c.sendCommand(c.Command.InputFormat,c.InputFormatProperty.FrameFillColor,0,0,{color:E,isAuto:false});
}else{switch(G.id){case"mnuItemTblFrameFillColorAutomatic":c.sendCommand(c.Command.InputFormat,c.InputFormatProperty.FrameFillColor,0,0,{color:null,isAuto:true});
break;
case"mnuItemTblFrameFillMoreColors":c.sendCommand(c.Command.ShowDialog,c.DialogCategory.TXDialog,c.TXDialogType.FrameFillColorDialog);
break;
}}}function s(E){c.fileMenu.hide();
c.hideAllMenus_tableLayoutTab();
var F=document.getElementById("tableFrameLineWidthDropDown");
c.calcMenuWidths(F);
h.show().position({my:"left top",at:"left bottom",of:E.currentTarget});
a(document).one("click",function(){h.hide();
});
return false;
}function y(E,G){var F=G.item.context.id,H=0;
switch(F){case"mnuItemTblFrameLineWidth_0_25":H=0.25*20;
break;
case"mnuItemTblFrameLineWidth_0_5":H=0.5*20;
break;
case"mnuItemTblFrameLineWidth_0_75":H=0.75*20;
break;
case"mnuItemTblFrameLineWidth_1_0":H=1*20;
break;
case"mnuItemTblFrameLineWidth_1_5":H=1.5*20;
break;
case"mnuItemTblFrameLineWidth_2_25":H=2.25*20;
break;
case"mnuItemTblFrameLineWidth_3_0":H=3*20;
break;
case"mnuItemTblFrameLineWidth_4_5":H=4.5*20;
break;
case"mnuItemTblFrameLineWidth_6_0":H=6*20;
break;
}if(H){c.sendCommand(c.Command.InputFormat,c.InputFormatProperty.FrameLineWidth,H);
}}function A(E){var F=E.currentTarget.id;
switch(F){case"tglBtnCellAlignTopLeft":c.sendCommand(c.Command.TableCommand,c.TableCommand.CellAlignment,c.VerticalAlignment.Top,c.HorizontalAlignment.Left);
break;
case"tglBtnCellAlignTopCenter":c.sendCommand(c.Command.TableCommand,c.TableCommand.CellAlignment,c.VerticalAlignment.Top,c.HorizontalAlignment.Center);
break;
case"tglBtnCellAlignTopRight":c.sendCommand(c.Command.TableCommand,c.TableCommand.CellAlignment,c.VerticalAlignment.Top,c.HorizontalAlignment.Right);
break;
case"tglBtnCellAlignTopJustify":c.sendCommand(c.Command.TableCommand,c.TableCommand.CellAlignment,c.VerticalAlignment.Top,c.HorizontalAlignment.Justify);
break;
case"tglBtnCellAlignMiddleLeft":c.sendCommand(c.Command.TableCommand,c.TableCommand.CellAlignment,c.VerticalAlignment.Center,c.HorizontalAlignment.Left);
break;
case"tglBtnCellAlignMiddleCenter":c.sendCommand(c.Command.TableCommand,c.TableCommand.CellAlignment,c.VerticalAlignment.Center,c.HorizontalAlignment.Center);
break;
case"tglBtnCellAlignMiddleRight":c.sendCommand(c.Command.TableCommand,c.TableCommand.CellAlignment,c.VerticalAlignment.Center,c.HorizontalAlignment.Right);
break;
case"tglBtnCellAlignMiddleJustify":c.sendCommand(c.Command.TableCommand,c.TableCommand.CellAlignment,c.VerticalAlignment.Center,c.HorizontalAlignment.Justify);
break;
case"tglBtnCellAlignBottomLeft":c.sendCommand(c.Command.TableCommand,c.TableCommand.CellAlignment,c.VerticalAlignment.Bottom,c.HorizontalAlignment.Left);
break;
case"tglBtnCellAlignBottomCenter":c.sendCommand(c.Command.TableCommand,c.TableCommand.CellAlignment,c.VerticalAlignment.Bottom,c.HorizontalAlignment.Center);
break;
case"tglBtnCellAlignBottomRight":c.sendCommand(c.Command.TableCommand,c.TableCommand.CellAlignment,c.VerticalAlignment.Bottom,c.HorizontalAlignment.Right);
break;
case"tglBtnCellAlignBottomJustify":c.sendCommand(c.Command.TableCommand,c.TableCommand.CellAlignment,c.VerticalAlignment.Bottom,c.HorizontalAlignment.Justify);
break;
}}function B(E){var F=E.currentTarget.id;
switch(F){case"btnInsTblRowAbove":c.sendCommand(c.Command.TableCommand,c.TableCommand.InsertElement,c.TableElement.Row,c.TableAddPosition.Before);
break;
case"btnInsTblRowBelow":c.sendCommand(c.Command.TableCommand,c.TableCommand.InsertElement,c.TableElement.Row,c.TableAddPosition.After);
break;
case"btnInsTblColLeft":c.sendCommand(c.Command.TableCommand,c.TableCommand.InsertElement,c.TableElement.Column,c.TableAddPosition.Before);
break;
case"btnInsTblColRight":c.sendCommand(c.Command.TableCommand,c.TableCommand.InsertElement,c.TableElement.Column,c.TableAddPosition.After);
break;
}}function t(E){var F=E.currentTarget.id;
switch(F){case"btnMergeCells":c.sendCommand(c.Command.TableCommand,c.TableCommand.MergeCells);
break;
case"btnSplitCells":c.sendCommand(c.Command.TableCommand,c.TableCommand.SplitCells);
break;
}}c.processTableInfo=function(E){if(E.CanSplitCells){a("#btnSplitCells").removeClass("txui-state-disabled");
}else{a("#btnSplitCells").addClass("txui-state-disabled");
}if(E.CanMergeCells){a("#btnMergeCells").removeClass("txui-state-disabled");
}else{a("#btnMergeCells").addClass("txui-state-disabled");
}if(E.CanSplit){a("#drpDnBtnSplitTable").removeClass("txui-state-disabled");
}else{a("#drpDnBtnSplitTable").addClass("txui-state-disabled");
}if(E.RowsCanAdd){a("#btnInsTblRowAbove").removeClass("txui-state-disabled");
a("#btnInsTblRowBelow").removeClass("txui-state-disabled");
}else{a("#btnInsTblRowAbove").addClass("txui-state-disabled");
a("#btnInsTblRowBelow").addClass("txui-state-disabled");
}if(E.ColsCanAdd){a("#btnInsTblColLeft").removeClass("txui-state-disabled");
a("#btnInsTblColRight").removeClass("txui-state-disabled");
}else{a("#btnInsTblColLeft").addClass("txui-state-disabled");
a("#btnInsTblColRight").addClass("txui-state-disabled");
}if(E.RowsCanRemove){a("#mnuItemDeleteTableRows").removeClass("txui-state-disabled");
}else{a("#mnuItemDeleteTableRows").addClass("txui-state-disabled");
}if(E.ColsCanRemove){a("#mnuItemDeleteTableColumns").removeClass("txui-state-disabled");
}else{a("#mnuItemDeleteTableColumns").addClass("txui-state-disabled");
}};
c.updateTableAlignButtonState=function(E,F){switch(E){case c.InputFormatProperty.LeftAligned:if(F){j.horizontal=c.HorizontalAlignment.Left;
}else{if(F===null){j.horizontal=null;
}}break;
case c.InputFormatProperty.Centered:if(F){j.horizontal=c.HorizontalAlignment.Center;
}else{if(F===null){j.horizontal=null;
}}break;
case c.InputFormatProperty.RightAligned:if(F){j.horizontal=c.HorizontalAlignment.Right;
}else{if(F===null){j.horizontal=null;
}}break;
case c.InputFormatProperty.Justified:if(F){j.horizontal=c.HorizontalAlignment.Justify;
}else{if(F===null){j.horizontal=null;
}}break;
case c.InputFormatProperty.TopAligned:if(F){j.vertical=c.VerticalAlignment.Top;
}else{if(F===null){j.vertical=null;
}}break;
case c.InputFormatProperty.VerticallyCentered:if(F){j.vertical=c.VerticalAlignment.Center;
}else{if(F===null){j.vertical=null;
}}break;
case c.InputFormatProperty.BottomAligned:if(F){j.vertical=c.VerticalAlignment.Bottom;
}else{if(F===null){j.vertical=null;
}}break;
}D();
};
c.updateTableBackgroundColorMenu=function(F){var E=document.getElementById("tglBtnTblFrameFillColorAutomatic");
if(E){E.classList.remove("ribbon-button-selected");
if(F===null){return;
}if(F.Name==="Transparent"){E.classList.add("ribbon-button-selected");
}}};
c.updateTableFrameLineColorMenu=function(F){var E=document.getElementById("tglBtnTblFrameColorAutomatic");
if(E){E.classList.remove("ribbon-button-selected");
if(F===null){return;
}if(F.Name==="WindowText"){E.classList.add("ribbon-button-selected");
}}};
c.updateTableFrameLineWidthMenu=function(G){var E=null;
G=G||0;
var F=document.querySelectorAll("#tableFrameLineWidthDropDown div.small-menu-item-image-wrapper");
[].forEach.call(F,function(H){H.classList.remove("ribbon-button-selected");
});
switch(G){case 0.25*20:E=document.getElementById("tglBtnTblFrameLineWidth_0_25");
break;
case 0.5*20:E=document.getElementById("tglBtnTblFrameLineWidth_0_5");
break;
case 0.75*20:E=document.getElementById("tglBtnTblFrameLineWidth_0_75");
break;
case 1*20:E=document.getElementById("tglBtnTblFrameLineWidth_1_0");
break;
case 1.5*20:E=document.getElementById("tglBtnTblFrameLineWidth_1_5");
break;
case 2.25*20:E=document.getElementById("tglBtnTblFrameLineWidth_2_25");
break;
case 3*20:E=document.getElementById("tglBtnTblFrameLineWidth_3_0");
break;
case 4.5*20:E=document.getElementById("tglBtnTblFrameLineWidth_4_5");
break;
case 6*20:E=document.getElementById("tglBtnTblFrameLineWidth_6_0");
break;
}if(E){E.classList.add("ribbon-button-selected");
}};
function D(){a("#ribbonGroupTblLayoutAlignment div.ribbon-button-tiny").removeClass("ribbon-button-selected");
switch(j.vertical){case c.VerticalAlignment.Top:switch(j.horizontal){case c.HorizontalAlignment.Left:a("#tglBtnCellAlignTopLeft").addClass("ribbon-button-selected");
break;
case c.HorizontalAlignment.Center:a("#tglBtnCellAlignTopCenter").addClass("ribbon-button-selected");
break;
case c.HorizontalAlignment.Right:a("#tglBtnCellAlignTopRight").addClass("ribbon-button-selected");
break;
case c.HorizontalAlignment.Justify:a("#tglBtnCellAlignTopJustify").addClass("ribbon-button-selected");
break;
}break;
case c.VerticalAlignment.Center:switch(j.horizontal){case c.HorizontalAlignment.Left:a("#tglBtnCellAlignMiddleLeft").addClass("ribbon-button-selected");
break;
case c.HorizontalAlignment.Center:a("#tglBtnCellAlignMiddleCenter").addClass("ribbon-button-selected");
break;
case c.HorizontalAlignment.Right:a("#tglBtnCellAlignMiddleRight").addClass("ribbon-button-selected");
break;
case c.HorizontalAlignment.Justify:a("#tglBtnCellAlignMiddleJustify").addClass("ribbon-button-selected");
break;
}break;
case c.VerticalAlignment.Bottom:switch(j.horizontal){case c.HorizontalAlignment.Left:a("#tglBtnCellAlignBottomLeft").addClass("ribbon-button-selected");
break;
case c.HorizontalAlignment.Center:a("#tglBtnCellAlignBottomCenter").addClass("ribbon-button-selected");
break;
case c.HorizontalAlignment.Right:a("#tglBtnCellAlignBottomRight").addClass("ribbon-button-selected");
break;
case c.HorizontalAlignment.Justify:a("#tglBtnCellAlignBottomJustify").addClass("ribbon-button-selected");
break;
}break;
}}c.hideAllMenus_tableLayoutTab=function(){d.hide();
b.hide();
e.hide();
i.hide();
g.hide();
f.hide();
h.hide();
};
return C;
}(TXTextControl||{},j$1_10_2));
var TXTextControl=(function(ax,a){var l=ax._private=ax._private||{};
var k,h,j,i,p,n,m,q,o,e,c,b,f,d,g,r,t,s;
l.FrameInsertionMode={AsCharacter:1,DisplaceCompleteLines:4,DisplaceText:8,MoveWithText:65536,FixedOnPage:131072,BelowTheText:262146,AboveTheText:524290};
l.FrameProperty={InsertionMode:0,Name:1,ID:2,HorizontalAlignment:3,ZOrder:4,Width:5,Height:6};
l.FrameType={None:0,TextFrame:1,Drawing:2,Image:3,Chart:4,Barcode:5};
l.DrawingControlProperty={FillColor:1,Transparency:2,OutlineColor:3,OutlineWidth:4,Rotation:5,ToggleFlipVertical:6,ToggleFlipHorizontal:7};
l.BarcodeControlProperty={Transparency:1,ForeColor:2,BackColor:3,HorizontalAlign:4,VerticalAlign:5,Rotation:6};
l.TextFrameProperty={BackColor:1,BorderWidth:2,Transparency:3,};
l.ZOrder={BottomMost:-2147483648,Bottom:-2147483647,Down:-2147483646,Up:2147483645,Top:2147483646,TopMost:2147483647};
l.LastFrameInfo=null;
l.attachFrameFormatTabEventHandlers=function(){y();
k=a("#frameWrapTextDropDown").menu().hide();
h=a("#frameBringToFrontDropDown").menu().hide();
j=a("#frameSendToBackDropDown").menu().hide();
i=a("#framePositionDropDown").menu().hide();
p=a("#shapesRotateDropDown").menu().hide();
n=a("#shapesFrameLineColorDropDown").menu().hide();
m=a("#shapesFrameBgColorDropDown").menu().hide();
q=a("#shapesTransparencyDropDown").menu().hide();
o=a("#shapesFrameLineWidthDropDown").menu().hide();
e=a("#barcodesRotationDropDown").menu().hide();
c=a("#barcodesFgColorDropDown").menu().hide();
b=a("#barcodesBgColorDropDown").menu().hide();
f=a("#barcodesTransparencyDropDown").menu().hide();
d=a("#barcodesHorizAlignDropDown").menu().hide();
g=a("#barcodesVertAlignDropDown").menu().hide();
r=a("#textFramesBgColorDropDown").menu().hide();
t=a("#textFramesTransparencyDropDown").menu().hide();
s=a("#textFramesFrameLineWidthDropDown").menu().hide();
k.on("menuselect",ac);
h.on("menuselect",Z);
j.on("menuselect",ab);
i.on("menuselect",aa);
p.on("menuselect",ag);
n.on("menuselect",ae);
m.on("menuselect",ad);
q.on("menuselect",ah);
o.on("menuselect",af);
e.on("menuselect",E);
c.on("menuselect",C);
b.on("menuselect",B);
f.on("menuselect",F);
d.on("menuselect",D);
g.on("menuselect",G);
r.on("menuselect",ai);
t.on("menuselect",ak);
s.on("menuselect",aj);
a("#drpDnBtnFrameWrapText").click(Y);
a("#drpDnBtnFrameBringToFront").click(N);
a("#drpDnBtnFrameSendToBack").click(P);
a("#drpDnBtnFramePosition").click(O);
a("#drpDnBtnShapesRotate").click(Q);
a("#drpDnBtnShapesFrameLineColor").click(S);
a("#drpDnBtnShapesFrameBgColor").click(R);
a("#drpDnBtnShapesTransparency").click(U);
a("#drpDnBtnShapesFrameLineWidth").click(T);
a("#drpDnBtnBarcodesRotation").click(L);
a("#drpDnBtnBarcodesFgColor").click(K);
a("#drpDnBtnBarcodesBgColor").click(J);
a("#drpDnBtnBarcodesTransparency").click(M);
a("#drpDnBtnBarcodesAlignHoriz").click(H);
a("#drpDnBtnBarcodesAlignVert").click(I);
a("#drpDnBtnTextFrameBgColor").click(V);
a("#drpDnBtnTextFrameTransp").click(X);
a("#drpDnBtnTextFrameLineWidth").click(W);
document.getElementById("numFrameHeight").addEventListener("change",z);
document.getElementById("numFrameWidth").addEventListener("change",A);
document.getElementById("txtFrameName").addEventListener("change",aA);
document.getElementById("txtFrameID").addEventListener("change",az);
document.addEventListener("txItemReceived",ay);
document.addEventListener("drawingControlInfoReceived",u);
document.addEventListener("frameSized",x);
document.addEventListener("frameMoved",w);
document.addEventListener("frameInfoReceived",v);
};
function y(){var aD=document.getElementById("shapesFrameLineColorDropDown");
l.generateColorPalette(aD,1);
aD=document.getElementById("shapesFrameBgColorDropDown");
l.generateColorPalette(aD,1);
aD=document.getElementById("barcodesFgColorDropDown");
l.generateColorPalette(aD,1);
aD=document.getElementById("barcodesBgColorDropDown");
l.generateColorPalette(aD,1);
aD=document.getElementById("textFramesBgColorDropDown");
l.generateColorPalette(aD,1);
}function Y(aE){l.fileMenu.hide();
l.hideAllMenus_FrameFormatTab();
if(!k){return;
}var aF=document.getElementById("frameWrapTextDropDown");
l.calcMenuWidths(aF);
var aD=document.querySelectorAll("#frameWrapTextDropDown div.ribbon-button-tiny");
[].forEach.call(aD,function(aG){aG.classList.remove("ribbon-button-selected");
});
l.sendCommand(l.Command.GetItem,l.ItemType.Frame);
k.show().position({my:"left top",at:"left bottom",of:aE.currentTarget});
a(document).one("click",function(){k.hide();
});
return false;
}function ac(aD,aG){var aE=aG.item.context.id;
var aF=null;
switch(aE){case"mnuItemFrameWrapInlineWithText":aF=l.FrameInsertionMode.AsCharacter;
break;
case"mnuItemFrameWrapTopAndBottom":aF=l.FrameInsertionMode.DisplaceCompleteLines;
break;
case"mnuItemFrameWrapSquare":aF=l.FrameInsertionMode.DisplaceText;
break;
case"mnuItemFrameWrapBehindText":aF=l.FrameInsertionMode.BelowTheText;
break;
case"mnuItemFrameWrapInFrontOfText":aF=l.FrameInsertionMode.AboveTheText;
break;
case"mnuItemFrameWrapMoreOptions":l.sendCommand(l.Command.ShowDialog,l.DialogCategory.TXDialog,l.TXDialogType.ObjectAttributesDialog);
break;
}if(aF){l.sendCommand(l.Command.SetItemProperty,l.ItemType.Frame,l.FrameProperty.InsertionMode,aF);
}}function N(aD){l.fileMenu.hide();
l.hideAllMenus_FrameFormatTab();
if(!h){return;
}var aE=document.getElementById("frameBringToFrontDropDown");
l.calcMenuWidths(aE);
h.show().position({my:"left top",at:"left bottom",of:aD.currentTarget});
a(document).one("click",function(){h.hide();
});
return false;
}function Z(aD,aF){var aE=aF.item.context.id;
switch(aE){case"mnuItemFrameBringToFront":l.sendCommand(l.Command.SetItemProperty,l.ItemType.Frame,l.FrameProperty.ZOrder,l.ZOrder.Top);
break;
case"mnuItemFrameBringForward":l.sendCommand(l.Command.SetItemProperty,l.ItemType.Frame,l.FrameProperty.ZOrder,l.ZOrder.Up);
break;
case"mnuItemFrameBringInFrontOfText":l.sendCommand(l.Command.SetItemProperty,l.ItemType.Frame,l.FrameProperty.InsertionMode,l.FrameInsertionMode.AboveTheText);
break;
}}function P(aD){l.fileMenu.hide();
l.hideAllMenus_FrameFormatTab();
if(!j){return;
}var aE=document.getElementById("frameSendToBackDropDown");
l.calcMenuWidths(aE);
j.show().position({my:"left top",at:"left bottom",of:aD.currentTarget});
a(document).one("click",function(){j.hide();
});
return false;
}function ab(aD,aF){var aE=aF.item.context.id;
switch(aE){case"mnuItemFrameSendToBack":l.sendCommand(l.Command.SetItemProperty,l.ItemType.Frame,l.FrameProperty.ZOrder,l.ZOrder.Bottom);
break;
case"mnuItemFrameSendBackward":l.sendCommand(l.Command.SetItemProperty,l.ItemType.Frame,l.FrameProperty.ZOrder,l.ZOrder.Down);
break;
case"mnuItemFrameSendBehindText":l.sendCommand(l.Command.SetItemProperty,l.ItemType.Frame,l.FrameProperty.InsertionMode,l.FrameInsertionMode.BelowTheText);
break;
}}function O(aE){l.fileMenu.hide();
l.hideAllMenus_FrameFormatTab();
if(!i){return;
}var aF=document.getElementById("framePositionDropDown");
l.calcMenuWidths(aF);
var aD=document.querySelectorAll("#framePositionDropDown div.ribbon-button-tiny");
[].forEach.call(aD,function(aG){aG.classList.remove("ribbon-button-selected");
});
l.sendCommand(l.Command.GetItem,l.ItemType.Frame);
i.show().position({my:"left top",at:"left bottom",of:aE.currentTarget});
a(document).one("click",function(){i.hide();
});
return false;
}function aa(aD,aF){var aE=aF.item.context.id;
switch(aE){case"mnuItemFramePosLeft":l.sendCommand(l.Command.SetItemProperty,l.ItemType.Frame,l.FrameProperty.HorizontalAlignment,l.HorizontalAlignment.Left);
break;
case"mnuItemFramePosCenter":l.sendCommand(l.Command.SetItemProperty,l.ItemType.Frame,l.FrameProperty.HorizontalAlignment,l.HorizontalAlignment.Center);
break;
case"mnuItemFramePosRight":l.sendCommand(l.Command.SetItemProperty,l.ItemType.Frame,l.FrameProperty.HorizontalAlignment,l.HorizontalAlignment.Right);
break;
case"mnuItemFrameOtherPos":l.sendCommand(l.Command.ShowDialog,l.DialogCategory.TXDialog,l.TXDialogType.ObjectAttributesDialog);
break;
}}function Q(aD){l.fileMenu.hide();
l.hideAllMenus_FrameFormatTab();
if(!p){return;
}var aE=document.getElementById("shapesRotateDropDown");
l.calcMenuWidths(aE);
p.show().position({my:"left top",at:"left bottom",of:aD.currentTarget});
a(document).one("click",function(){p.hide();
});
return false;
}function ag(aE,aH){var aG=aH.item.context.id;
var aD=null;
var aF=null;
switch(aG){case"mnuItemShapesRotateRight90":aD=90;
break;
case"mnuItemShapesRotateLeft90":aD=-90;
break;
case"mnuItemShapesFlipHoriz":aF=l.DrawingControlProperty.ToggleFlipHorizontal;
break;
case"mnuItemShapesFlipVert":aF=l.DrawingControlProperty.ToggleFlipVertical;
break;
}if(aD!==null){l.sendCommand(l.Command.SetItemProperty,l.ItemType.DrawingFrame,l.DrawingControlProperty.Rotation,aD);
}if(aF!==null){l.sendCommand(l.Command.SetItemProperty,l.ItemType.DrawingFrame,aF);
}}function S(aE){l.fileMenu.hide();
l.hideAllMenus_FrameFormatTab();
if(!n){return;
}var aF=document.getElementById("shapesFrameLineColorDropDown");
l.calcMenuWidths(aF);
var aD=document.getElementById("tglBtnShapesFrameLineColorAutomatic");
aD.classList.remove("ribbon-button-selected");
l.sendCommand(l.Command.GetItem,l.ItemType.DrawingFrame);
n.show().position({my:"left top",at:"left bottom",of:aE.currentTarget});
a(document).one("click",function(){n.hide();
});
return false;
}function ae(aE,aG){var aF=aG.item.context;
if(aF.hasOwnProperty("txColor")){var aD=aF.txColor;
l.sendCommand(l.Command.SetItemProperty,l.ItemType.DrawingFrame,l.DrawingControlProperty.OutlineColor,0,{color:aD,isAuto:false});
}else{switch(aF.id){case"mnuItemShapesFrameLineColorAutomatic":l.sendCommand(l.Command.SetItemProperty,l.ItemType.DrawingFrame,l.DrawingControlProperty.OutlineColor,0,{color:null,isAuto:true});
break;
case"mnuItemShapesFrameLineColorMoreColors":l.sendCommand(l.Command.ShowDialog,l.DialogCategory.TXDialog,l.TXDialogType.ObjectAttributesDialog,2);
break;
}}}function R(aE){l.fileMenu.hide();
l.hideAllMenus_FrameFormatTab();
if(!m){return;
}var aF=document.getElementById("shapesFrameBgColorDropDown");
l.calcMenuWidths(aF);
var aD=document.getElementById("tglBtnFrameBgColorAutomatic");
aD.classList.remove("ribbon-button-selected");
l.sendCommand(l.Command.GetItem,l.ItemType.DrawingFrame);
m.show().position({my:"left top",at:"left bottom",of:aE.currentTarget});
a(document).one("click",function(){m.hide();
});
return false;
}function ad(aE,aG){var aF=aG.item.context;
if(aF.hasOwnProperty("txColor")){var aD=aF.txColor;
l.sendCommand(l.Command.SetItemProperty,l.ItemType.DrawingFrame,l.DrawingControlProperty.FillColor,0,{color:aD,isAuto:false});
}else{switch(aF.id){case"mnuItemShapesBgColorAutomatic":l.sendCommand(l.Command.SetItemProperty,l.ItemType.DrawingFrame,l.DrawingControlProperty.FillColor,0,{color:null,isAuto:true});
break;
case"mnuItemShapesBgColorMoreColors":l.sendCommand(l.Command.ShowDialog,l.DialogCategory.TXDialog,l.TXDialogType.ObjectAttributesDialog,2);
break;
}}}function U(aE){l.fileMenu.hide();
l.hideAllMenus_FrameFormatTab();
if(!q){return;
}var aF=document.getElementById("shapesTransparencyDropDown");
l.calcMenuWidths(aF);
var aD=document.querySelectorAll("#shapesTransparencyDropDown div.ribbon-button-tiny");
[].forEach.call(aD,function(aG){aG.classList.remove("ribbon-button-selected");
});
l.sendCommand(l.Command.GetItem,l.ItemType.DrawingFrame);
q.show().position({my:"left top",at:"left bottom",of:aE.currentTarget});
a(document).one("click",function(){q.hide();
});
return false;
}function ah(aD,aG){var aE=aG.item.context.id;
var aF=null;
switch(aE){case"mnuItemShapesTransparency_000":aF=0;
break;
case"mnuItemShapesTransparency_010":aF=10;
break;
case"mnuItemShapesTransparency_020":aF=20;
break;
case"mnuItemShapesTransparency_030":aF=30;
break;
case"mnuItemShapesTransparency_040":aF=40;
break;
case"mnuItemShapesTransparency_050":aF=50;
break;
case"mnuItemShapesTransparency_060":aF=60;
break;
case"mnuItemShapesTransparency_070":aF=70;
break;
case"mnuItemShapesTransparency_080":aF=80;
break;
case"mnuItemShapesTransparency_090":aF=90;
break;
case"mnuItemShapesTransparency_100":aF=100;
break;
}if(aF!==null){l.sendCommand(l.Command.SetItemProperty,l.ItemType.DrawingFrame,l.DrawingControlProperty.Transparency,aF);
}}function T(aE){l.fileMenu.hide();
l.hideAllMenus_FrameFormatTab();
if(!o){return;
}var aF=document.getElementById("shapesFrameLineWidthDropDown");
l.calcMenuWidths(aF);
var aD=document.querySelectorAll("#shapesFrameLineWidthDropDown div.ribbon-button-tiny");
[].forEach.call(aD,function(aG){aG.classList.remove("ribbon-button-selected");
});
l.sendCommand(l.Command.GetItem,l.ItemType.DrawingFrame);
o.show().position({my:"left top",at:"left bottom",of:aE.currentTarget});
a(document).one("click",function(){o.hide();
});
return false;
}function af(aD,aF){var aE=aF.item.context.id;
var aG=-1;
switch(aE){case"mnuItemShapesFrameLineWidth_NoLine":aG=0;
break;
case"mnuItemShapesFrameLineWidth_0_25":aG=0.25*20;
break;
case"mnuItemShapesFrameLineWidth_0_5":aG=0.5*20;
break;
case"mnuItemShapesFrameLineWidth_0_75":aG=0.75*20;
break;
case"mnuItemShapesFrameLineWidth_1_0":aG=20;
break;
case"mnuItemShapesFrameLineWidth_1_5":aG=1.5*20;
break;
case"mnuItemShapesFrameLineWidth_2_25":aG=2.25*20;
break;
case"mnuItemShapesFrameLineWidth_3_0":aG=3*20;
break;
case"mnuItemShapesFrameLineWidth_4_5":aG=4.5*20;
break;
case"mnuItemShapesFrameLineWidth_6_0":aG=6*20;
break;
}if(aG>=0){l.sendCommand(l.Command.SetItemProperty,l.ItemType.DrawingFrame,l.DrawingControlProperty.OutlineWidth,aG);
}}function L(aD){l.fileMenu.hide();
l.hideAllMenus_FrameFormatTab();
if(!e){return;
}var aE=document.getElementById("barcodesRotationDropDown");
l.calcMenuWidths(aE);
e.show().position({my:"left top",at:"left bottom",of:aD.currentTarget});
a(document).one("click",function(){e.hide();
});
return false;
}function E(aE,aG){var aF=aG.item.context.id;
var aD=null;
switch(aF){case"mnuItemBarcodeRotateRight90":aD=90;
break;
case"mnuItemBarcodeRotateLeft90":aD=-90;
break;
case"mnuItemBarcodeRotate180":aD=180;
break;
case"mnuItemBarcodeRotateOtherOpts":l.sendCommand(l.Command.ShowDialog,l.DialogCategory.TXDialog,l.TXDialogType.ObjectAttributesDialog,2);
break;
}if(aD!==null){l.sendCommand(l.Command.SetItemProperty,l.ItemType.Barcode,l.BarcodeControlProperty.Rotation,aD);
}}function K(aD){l.fileMenu.hide();
l.hideAllMenus_FrameFormatTab();
if(!c){return;
}var aE=document.getElementById("barcodesFgColorDropDown");
l.calcMenuWidths(aE);
c.show().position({my:"left top",at:"left bottom",of:aD.currentTarget});
a(document).one("click",function(){c.hide();
});
return false;
}function C(aE,aG){var aF=aG.item.context;
if(aF.hasOwnProperty("txColor")){var aD=aF.txColor;
l.sendCommand(l.Command.SetItemProperty,l.ItemType.Barcode,l.BarcodeControlProperty.ForeColor,0,{color:aD,isAuto:false});
}else{switch(aF.id){case"mnuItemBarcodesFgColorAutomatic":l.sendCommand(l.Command.SetItemProperty,l.ItemType.Barcode,l.BarcodeControlProperty.ForeColor,0,{color:null,isAuto:true});
break;
case"mnuItemBarcodesFgColorMoreColors":l.sendCommand(l.Command.ShowDialog,l.DialogCategory.TXDialog,l.TXDialogType.ObjectAttributesDialog,2);
break;
}}}function J(aD){l.fileMenu.hide();
l.hideAllMenus_FrameFormatTab();
if(!b){return;
}var aE=document.getElementById("barcodesBgColorDropDown");
l.calcMenuWidths(aE);
b.show().position({my:"left top",at:"left bottom",of:aD.currentTarget});
a(document).one("click",function(){b.hide();
});
return false;
}function B(aE,aG){var aF=aG.item.context;
if(aF.hasOwnProperty("txColor")){var aD=aF.txColor;
l.sendCommand(l.Command.SetItemProperty,l.ItemType.Barcode,l.BarcodeControlProperty.BackColor,0,{color:aD,isAuto:false});
}else{switch(aF.id){case"mnuItemBarcodesBgColorAutomatic":l.sendCommand(l.Command.SetItemProperty,l.ItemType.Barcode,l.BarcodeControlProperty.BackColor,0,{color:null,isAuto:true});
break;
case"mnuItemBarcodesBgColorMoreColors":l.sendCommand(l.Command.ShowDialog,l.DialogCategory.TXDialog,l.TXDialogType.ObjectAttributesDialog,2);
break;
}}}function M(aD){l.fileMenu.hide();
l.hideAllMenus_FrameFormatTab();
if(!f){return;
}var aE=document.getElementById("barcodesTransparencyDropDown");
l.calcMenuWidths(aE);
f.show().position({my:"left top",at:"left bottom",of:aD.currentTarget});
a(document).one("click",function(){f.hide();
});
return false;
}function F(aD,aG){var aE=aG.item.context.id;
var aF=null;
switch(aE){case"mnuItemBarcodesTransparency_000":aF=0;
break;
case"mnuItemBarcodesTransparency_010":aF=10;
break;
case"mnuItemBarcodesTransparency_020":aF=20;
break;
case"mnuItemBarcodesTransparency_030":aF=30;
break;
case"mnuItemBarcodesTransparency_040":aF=40;
break;
case"mnuItemBarcodesTransparency_050":aF=50;
break;
case"mnuItemBarcodesTransparency_060":aF=60;
break;
case"mnuItemBarcodesTransparency_070":aF=70;
break;
case"mnuItemBarcodesTransparency_080":aF=80;
break;
case"mnuItemBarcodesTransparency_090":aF=90;
break;
case"mnuItemBarcodesTransparency_100":aF=100;
break;
}if(aF!==null){l.sendCommand(l.Command.SetItemProperty,l.ItemType.Barcode,l.BarcodeControlProperty.Transparency,aF);
}}function H(aD){l.fileMenu.hide();
l.hideAllMenus_FrameFormatTab();
if(!d){return;
}var aE=document.getElementById("barcodesHorizAlignDropDown");
l.calcMenuWidths(aE);
d.show().position({my:"left top",at:"left bottom",of:aD.currentTarget});
a(document).one("click",function(){d.hide();
});
return false;
}function D(aE,aG){var aF=aG.item.context.id;
var aD=null;
switch(aF){case"mnuItemBarcodesAlignLeft":aD=l.HorizontalAlignment.Left;
break;
case"mnuItemBarcodesAlignCenter":aD=l.HorizontalAlignment.Center;
break;
case"mnuItemBarcodesAlignRight":aD=l.HorizontalAlignment.Right;
break;
}if(aD!==null){l.sendCommand(l.Command.SetItemProperty,l.ItemType.Barcode,l.BarcodeControlProperty.HorizontalAlign,aD);
}}function I(aD){l.fileMenu.hide();
l.hideAllMenus_FrameFormatTab();
if(!g){return;
}var aE=document.getElementById("barcodesVertAlignDropDown");
l.calcMenuWidths(aE);
g.show().position({my:"left top",at:"left bottom",of:aD.currentTarget});
a(document).one("click",function(){g.hide();
});
return false;
}function G(aE,aG){var aF=aG.item.context.id;
var aD=null;
switch(aF){case"mnuItemBarcodesAlignTop":aD=l.VerticalAlignment.Top;
break;
case"mnuItemBarcodesAlignMiddle":aD=l.VerticalAlignment.Center;
break;
case"mnuItemBarcodesAlignBottom":aD=l.VerticalAlignment.Bottom;
break;
}if(aD!==null){l.sendCommand(l.Command.SetItemProperty,l.ItemType.Barcode,l.BarcodeControlProperty.VerticalAlign,aD);
}}function V(aD){l.fileMenu.hide();
l.hideAllMenus_FrameFormatTab();
if(!r){return;
}var aE=document.getElementById("textFramesBgColorDropDown");
l.calcMenuWidths(aE);
r.show().position({my:"left top",at:"left bottom",of:aD.currentTarget});
a(document).one("click",function(){r.hide();
});
return false;
}function ai(aE,aG){var aF=aG.item.context;
if(aF.hasOwnProperty("txColor")){var aD=aF.txColor;
l.sendCommand(l.Command.SetItemProperty,l.ItemType.TextFrame,l.TextFrameProperty.BackColor,0,{color:aD,isAuto:false});
}else{switch(aF.id){case"mnuItemTextFramesBgColorAutomatic":l.sendCommand(l.Command.SetItemProperty,l.ItemType.TextFrame,l.TextFrameProperty.BackColor,0,{color:null,isAuto:true});
break;
case"mnuItemTextFramesBgColorMoreColors":l.sendCommand(l.Command.ShowDialog,l.DialogCategory.TXDialog,l.TXDialogType.ObjectAttributesDialog,2);
break;
}}}function X(aD){l.fileMenu.hide();
l.hideAllMenus_FrameFormatTab();
if(!t){return;
}var aE=document.getElementById("textFramesTransparencyDropDown");
l.calcMenuWidths(aE);
t.show().position({my:"left top",at:"left bottom",of:aD.currentTarget});
a(document).one("click",function(){t.hide();
});
return false;
}function ak(aD,aG){var aE=aG.item.context.id;
var aF=null;
switch(aE){case"mnuItemTextFramesTransparency_000":aF=0;
break;
case"mnuItemTextFramesTransparency_010":aF=10;
break;
case"mnuItemTextFramesTransparency_020":aF=20;
break;
case"mnuItemTextFramesTransparency_030":aF=30;
break;
case"mnuItemTextFramesTransparency_040":aF=40;
break;
case"mnuItemTextFramesTransparency_050":aF=50;
break;
case"mnuItemTextFramesTransparency_060":aF=60;
break;
case"mnuItemTextFramesTransparency_070":aF=70;
break;
case"mnuItemTextFramesTransparency_080":aF=80;
break;
case"mnuItemTextFramesTransparency_090":aF=90;
break;
case"mnuItemTextFramesTransparency_100":aF=100;
break;
}if(aF!==null){l.sendCommand(l.Command.SetItemProperty,l.ItemType.TextFrame,l.TextFrameProperty.Transparency,aF);
}}function W(aD){l.fileMenu.hide();
l.hideAllMenus_FrameFormatTab();
if(!s){return;
}var aE=document.getElementById("textFramesFrameLineWidthDropDown");
l.calcMenuWidths(aE);
s.show().position({my:"left top",at:"left bottom",of:aD.currentTarget});
a(document).one("click",function(){s.hide();
});
return false;
}function aj(aD,aF){var aE=aF.item.context.id;
var aG=-1;
switch(aE){case"mnuItemTextFramesFrameLineWidth_NoLine":aG=0;
break;
case"mnuItemTextFramesFrameLineWidth_0_25":aG=0.25*20;
break;
case"mnuItemTextFramesFrameLineWidth_0_5":aG=0.5*20;
break;
case"mnuItemTextFramesFrameLineWidth_0_75":aG=0.75*20;
break;
case"mnuItemTextFramesFrameLineWidth_1_0":aG=20;
break;
case"mnuItemTextFramesFrameLineWidth_1_5":aG=1.5*20;
break;
case"mnuItemTextFramesFrameLineWidth_2_25":aG=2.25*20;
break;
case"mnuItemTextFramesFrameLineWidth_3_0":aG=3*20;
break;
case"mnuItemTextFramesFrameLineWidth_4_5":aG=4.5*20;
break;
case"mnuItemTextFramesFrameLineWidth_6_0":aG=6*20;
break;
}if(aG>=0){l.sendCommand(l.Command.SetItemProperty,l.ItemType.TextFrame,l.TextFrameProperty.BorderWidth,aG);
}}function at(aF){var aD;
if(!aF){return;
}var aE=document.querySelectorAll("#frameWrapTextDropDown div.ribbon-button-tiny");
[].forEach.call(aE,function(aG){aG.classList.remove("ribbon-button-selected");
});
switch(aF.InsertionMode){case l.FrameInsertionMode.AsCharacter:aD=document.getElementById("tglBtnFrameWrapInlineWithText");
break;
case l.FrameInsertionMode.AboveTheText:aD=document.getElementById("tglBtnFrameWrapInFrontOfText");
break;
case l.FrameInsertionMode.DisplaceCompleteLines:aD=document.getElementById("tglBtnFrameWrapTopAndBottom");
break;
case l.FrameInsertionMode.DisplaceText:aD=document.getElementById("tglBtnFrameWrapSquare");
break;
case l.FrameInsertionMode.BelowTheText:aD=document.getElementById("tglBtnFrameWrapBehindText");
break;
}if(aD){aD.classList.add("ribbon-button-selected");
}}function aq(aF){var aD;
var aE=document.querySelectorAll("#framePositionDropDown div.ribbon-button-tiny");
[].forEach.call(aE,function(aG){aG.classList.remove("ribbon-button-selected");
});
switch(aF){case l.HorizontalAlignment.Left:aD=document.getElementById("tglBtnFramePosLeft");
break;
case l.HorizontalAlignment.Center:aD=document.getElementById("tglBtnFramePosCenter");
break;
case l.HorizontalAlignment.Right:aD=document.getElementById("tglBtnFramePosRight");
break;
default:aD=document.getElementById("tglBtnFramePosOther");
break;
}if(aD){aD.classList.add("ribbon-button-selected");
}}function aw(aD){var aF=document.getElementById("ribbonGroupShapesFramesAndBg");
var aE=document.getElementById("ribbonGroupBarcodesColorsAndAlign");
var aG=document.getElementById("ribbonGroupTextFramesFramesAndBg");
aG.style.display=aE.style.display=aF.style.display="none";
switch(aD){case l.FrameType.Drawing:aF.style.display="";
break;
case l.FrameType.TextFrame:aG.style.display="";
break;
case l.FrameType.Barcode:aE.style.display="";
break;
}}function aC(aD){if(!aD){return;
}var aE=document.getElementById("numFrameHeight");
var aF=document.getElementById("numFrameWidth");
aE.value=parseFloat(l.twips2mm(aD.Scaling.Y*aD.Size.Height).toFixed(1));
aF.value=parseFloat(l.twips2mm(aD.Scaling.X*aD.Size.Width).toFixed(1));
var aH=document.getElementById("txtFrameName");
var aG=document.getElementById("txtFrameID");
aH.value=aD.Name;
aG.value=aD.ID;
}function ay(aD){var aF=aD.detail.itemType;
var aE=aD.detail.item;
if(aE===null){return;
}switch(aF){case l.ItemType.Frame:l.processFrameInfo(aE);
break;
case l.ItemType.DrawingFrame:l.processDrawingControlInfo(aE);
break;
}}function u(aD){l.processDrawingControlInfo(aD.detail);
}function x(aE){var aD=aE.detail;
var aG=document.getElementById("numFrameHeight");
var aH=document.getElementById("numFrameWidth");
var aI=aD.size.Width*aD.scaling.X;
var aF=aD.size.Height*aD.scaling.Y;
aG.value=l.twips2mm(aF).toFixed(1);
aH.value=l.twips2mm(aI).toFixed(1);
}function w(aE){var aD=aE.detail;
aq(aD.horizontalAlignment);
}function v(aF){var aD=aF.detail;
if((aD.Frame||aD.DrawingControlInfo)&&(l.appMode==l.ApplicationMode.Normal)){a("#tabFrameFormatting").show();
l.adaptRibbonTabWidths();
document.getElementById("ribbonGroupFrameProps").style.display="";
var aE=(aD.DrawingControlInfo&&aD.DrawingControlInfo.IsDrawingActivated);
if(aD.Frame){l.processFrameInfo(aD.Frame,aE);
}if(aD.DrawingControlInfo){l.processDrawingControlInfo(aD.DrawingControlInfo);
}if(aD.BarcodeControlInfo){l.processBarcodeControlInfo(aD.BarcodeControlInfo);
}if(aD.TextFrameInfo){l.processTextFrameInfo(aD.TextFrameInfo);
}}else{if(a("#tabFrameFormatting").is(":visible")){a("#tabFrameFormatting").hide();
l.adaptRibbonTabWidths();
if(a("#"+a("#tabFrameFormatting").attr("rel")).is(":visible")){l.switchTabs(a("#tabDefault"));
}}}}l.processFrameInfo=function(aE,aD){aD=aD||false;
if(aE){if(!aD){at(aE);
aq(aE.Alignment);
aC(aE);
aB(false);
}aw(aE.FrameType);
}l.LastFrameInfo=aE;
};
l.disableDialogLauncher=function(aE,aD){if(!aE||!(aE instanceof HTMLElement)){return;
}if(typeof aD==="undefined"){aD=true;
}if(aD){aE.style.pointerEvents="none";
aE.style.opacity=0.3;
}else{aE.style.pointerEvents="";
aE.style.opacity="";
}};
function aB(aG,aQ){aQ=aQ||false;
var aK=document.getElementById("drpDnBtnFrameWrapText");
var aH=document.getElementById("drpDnBtnFrameBringToFront");
var aJ=document.getElementById("drpDnBtnFrameSendToBack");
var aI=document.getElementById("drpDnBtnFramePosition");
var aM=document.getElementById("mnuItemFrameBringInFrontOfText");
var aN=document.getElementById("mnuItemFrameSendBehindText");
var aP=document.getElementById("mnuItemShapesFrameLineColorMoreColors");
var aO=document.getElementById("mnuItemShapesBgColorMoreColors");
var aL=document.getElementById("drpDnBtnShapesRotate");
var aD=document.getElementById("btnDlgLnchFrameArrangeGrp");
var aF=document.getElementById("btnDlgLnchFrameSizeGrp");
var aE=document.getElementById("btnDlgLnchFramesAndBgGrp");
if(aG){aK.classList.add("txui-state-disabled");
if(aQ){aJ.classList.add("txui-state-disabled");
aH.classList.add("txui-state-disabled");
aL.classList.add("txui-state-disabled");
}else{aJ.classList.remove("txui-state-disabled");
aH.classList.remove("txui-state-disabled");
aL.classList.remove("txui-state-disabled");
}aM.classList.add("txui-state-disabled");
aN.classList.add("txui-state-disabled");
aO.classList.add("txui-state-disabled");
aP.classList.add("txui-state-disabled");
aI.classList.add("txui-state-disabled");
l.disableDialogLauncher(aD);
l.disableDialogLauncher(aE);
l.disableDialogLauncher(aF);
}else{aK.classList.remove("txui-state-disabled");
aH.classList.remove("txui-state-disabled");
aJ.classList.remove("txui-state-disabled");
aI.classList.remove("txui-state-disabled");
aM.classList.remove("txui-state-disabled");
aN.classList.remove("txui-state-disabled");
aO.classList.remove("txui-state-disabled");
aP.classList.remove("txui-state-disabled");
aL.classList.add("txui-state-disabled");
l.disableDialogLauncher(aD,false);
l.disableDialogLauncher(aE,false);
l.disableDialogLauncher(aF,false);
}}function an(aF){var aE;
var aD=document.querySelectorAll("#barcodesTransparencyDropDown div.ribbon-button-tiny");
[].forEach.call(aD,function(aG){aG.classList.remove("ribbon-button-selected");
});
if(aF===null){return;
}switch(aF){case 0:aE=document.getElementById("tglBtnBarcodesTransparency_000");
break;
case 10:aE=document.getElementById("tglBtnBarcodesTransparency_010");
break;
case 20:aE=document.getElementById("tglBtnBarcodesTransparency_020");
break;
case 30:aE=document.getElementById("tglBtnBarcodesTransparency_030");
break;
case 40:aE=document.getElementById("tglBtnBarcodesTransparency_040");
break;
case 50:aE=document.getElementById("tglBtnBarcodesTransparency_050");
break;
case 60:aE=document.getElementById("tglBtnBarcodesTransparency_060");
break;
case 70:aE=document.getElementById("tglBtnBarcodesTransparency_070");
break;
case 80:aE=document.getElementById("tglBtnBarcodesTransparency_080");
break;
case 90:aE=document.getElementById("tglBtnBarcodesTransparency_090");
break;
case 100:aE=document.getElementById("tglBtnBarcodesTransparency_100");
break;
}if(aE){aE.classList.add("ribbon-button-selected");
}}function am(aD){var aF;
var aE=document.querySelectorAll("#barcodesHorizAlignDropDown div.ribbon-button-tiny");
[].forEach.call(aE,function(aG){aG.classList.remove("ribbon-button-selected");
});
switch(aD){case l.HorizontalAlignment.Left:aF=document.getElementById("tglBtnBarcodesAlignLeft");
break;
case l.HorizontalAlignment.Center:aF=document.getElementById("tglBtnBarcodesAlignCenter");
break;
case l.HorizontalAlignment.Right:aF=document.getElementById("tglBtnBarcodesAlignRight");
break;
}if(aF){aF.classList.add("ribbon-button-selected");
}}function ao(aD){var aF;
var aE=document.querySelectorAll("#barcodesVertAlignDropDown div.ribbon-button-tiny");
[].forEach.call(aE,function(aG){aG.classList.remove("ribbon-button-selected");
});
switch(aD){case l.VerticalAlignment.Top:aF=document.getElementById("tglBtnBarcodesAlignTop");
break;
case l.VerticalAlignment.Center:aF=document.getElementById("tglBtnBarcodesAlignMiddle");
break;
case l.VerticalAlignment.Bottom:aF=document.getElementById("tglBtnBarcodesAlignBottom");
break;
}if(aF){aF.classList.add("ribbon-button-selected");
}}function al(aD,aE){am(aD);
ao(aE);
}function ar(aF){var aE;
var aD=document.querySelectorAll("#shapesTransparencyDropDown div.ribbon-button-tiny");
[].forEach.call(aD,function(aG){aG.classList.remove("ribbon-button-selected");
});
if(aF===null){return;
}switch(aF){case 0:aE=document.getElementById("tglBtnShapesTransparency_000");
break;
case 10:aE=document.getElementById("tglBtnShapesTransparency_010");
break;
case 20:aE=document.getElementById("tglBtnShapesTransparency_020");
break;
case 30:aE=document.getElementById("tglBtnShapesTransparency_030");
break;
case 40:aE=document.getElementById("tglBtnShapesTransparency_040");
break;
case 50:aE=document.getElementById("tglBtnShapesTransparency_050");
break;
case 60:aE=document.getElementById("tglBtnShapesTransparency_060");
break;
case 70:aE=document.getElementById("tglBtnShapesTransparency_070");
break;
case 80:aE=document.getElementById("tglBtnShapesTransparency_080");
break;
case 90:aE=document.getElementById("tglBtnShapesTransparency_090");
break;
case 100:aE=document.getElementById("tglBtnShapesTransparency_100");
break;
}if(aE){aE.classList.add("ribbon-button-selected");
}}function ap(aE){var aF;
var aD=document.querySelectorAll("#shapesFrameLineWidthDropDown div.ribbon-button-tiny");
[].forEach.call(aD,function(aG){aG.classList.remove("ribbon-button-selected");
});
switch(aE){case 0:aF=document.getElementById("tglBtnNoShapesFrameLine");
break;
case 20*0.25:aF=document.getElementById("tglBtnShapesFrameLineWidth_0_25");
break;
case 20*0.5:aF=document.getElementById("tglBtnShapesFrameLineWidth_0_5");
break;
case 20*0.75:aF=document.getElementById("tglBtnShapesFrameLineWidth_0_75");
break;
case 20:aF=document.getElementById("tglBtnShapesFrameLineWidth_1_0");
break;
case 20*1.5:aF=document.getElementById("tglBtnShapesFrameLineWidth_1_5");
break;
case 20*2.25:aF=document.getElementById("tglBtnShapesFrameLineWidth_2_25");
break;
case 20*3:aF=document.getElementById("tglBtnShapesFrameLineWidth_3_0");
break;
case 20*4.5:aF=document.getElementById("tglBtnShapesFrameLineWidth_4_5");
break;
case 20*6:aF=document.getElementById("tglBtnShapesFrameLineWidth_6_0");
break;
}if(aF){aF.classList.add("ribbon-button-selected");
}}function av(aF){var aE;
var aD=document.querySelectorAll("#textFramesTransparencyDropDown div.ribbon-button-tiny");
[].forEach.call(aD,function(aG){aG.classList.remove("ribbon-button-selected");
});
if(aF===null){return;
}switch(aF){case 0:aE=document.getElementById("tglBtnTextFramesTransparency_000");
break;
case 10:aE=document.getElementById("tglBtnTextFramesTransparency_010");
break;
case 20:aE=document.getElementById("tglBtnTextFramesTransparency_020");
break;
case 30:aE=document.getElementById("tglBtnTextFramesTransparency_030");
break;
case 40:aE=document.getElementById("tglBtnTextFramesTransparency_040");
break;
case 50:aE=document.getElementById("tglBtnTextFramesTransparency_050");
break;
case 60:aE=document.getElementById("tglBtnTextFramesTransparency_060");
break;
case 70:aE=document.getElementById("tglBtnTextFramesTransparency_070");
break;
case 80:aE=document.getElementById("tglBtnTextFramesTransparency_080");
break;
case 90:aE=document.getElementById("tglBtnTextFramesTransparency_090");
break;
case 100:aE=document.getElementById("tglBtnTextFramesTransparency_100");
break;
}if(aE){aE.classList.add("ribbon-button-selected");
}}function au(aF){var aE;
var aD=document.querySelectorAll("#textFramesFrameLineWidthDropDown div.ribbon-button-tiny");
[].forEach.call(aD,function(aG){aG.classList.remove("ribbon-button-selected");
});
switch(aF){case 0:aE=document.getElementById("tglBtnNoTextFramesFrameLine");
break;
case 20*0.25:aE=document.getElementById("tglBtnTextFramesFrameLineWidth_0_25");
break;
case 20*0.5:aE=document.getElementById("tglBtnTextFramesFrameLineWidth_0_5");
break;
case 20*0.75:aE=document.getElementById("tglBtnTextFramesFrameLineWidth_0_75");
break;
case 20:aE=document.getElementById("tglBtnTextFramesFrameLineWidth_1_0");
break;
case 20*1.5:aE=document.getElementById("tglBtnTextFramesFrameLineWidth_1_5");
break;
case 20*2.25:aE=document.getElementById("tglBtnTextFramesFrameLineWidth_2_25");
break;
case 20*3:aE=document.getElementById("tglBtnTextFramesFrameLineWidth_3_0");
break;
case 20*4.5:aE=document.getElementById("tglBtnTextFramesFrameLineWidth_4_5");
break;
case 20*6:aE=document.getElementById("tglBtnTextFramesFrameLineWidth_6_0");
break;
}if(aE){aE.classList.add("ribbon-button-selected");
}}l.processTextFrameInfo=function(aF){var aE=document.querySelector("#drpDnBtnTextFrameBgColor img");
l.update16x16ColorButtonIcon(aE,aF.BackColor);
var aD=document.getElementById("tglBtnTextFramesBgColorAutomatic");
if(aF.IsAutoBackColor){aD.classList.add("ribbon-button-selected");
}else{aD.classList.remove("ribbon-button-selected");
}av(aF.Transparency);
au(aF.BorderWidth);
};
l.processBarcodeControlInfo=function(aD){var aF=document.querySelector("#drpDnBtnBarcodesFgColor img");
l.update16x16ColorButtonIcon(aF,aD.ForeColor);
aF=document.querySelector("#drpDnBtnBarcodesBgColor img");
l.update16x16ColorButtonIcon(aF,aD.BackColor);
var aE=document.getElementById("tglBtnBarcodesFgColorAutomatic");
if(aD.IsAutoForeColor){aE.classList.add("ribbon-button-selected");
}else{aE.classList.remove("ribbon-button-selected");
}aE=document.getElementById("tglBtnBarcodesBgColorAutomatic");
if(aD.IsAutoBackColor){aE.classList.add("ribbon-button-selected");
}else{aE.classList.remove("ribbon-button-selected");
}an(aD.Transparency);
al(aD.HorizontalAlign,aD.VerticalAlign);
};
l.processDrawingControlInfo=function(aE){var aF=aE.IsDrawingActivated;
aw(l.FrameType.Drawing);
if(aF){var aH=document.getElementById("ribbonGroupFrameProps");
aH.style.display="none";
aB(true,aE.NoShapesSelected);
var aI=document.getElementById("numFrameHeight");
var aJ=document.getElementById("numFrameWidth");
aI.value=aE.Height?parseFloat(l.twips2mm(aE.Height).toFixed(1)):(aE.Height>=0)?aE.Height:aI.value;
aJ.value=aE.Width?parseFloat(l.twips2mm(aE.Width).toFixed(1)):(aE.Width>=0)?aE.Width:aJ.value;
}ar(aE.Transparency);
var aG=document.querySelector("#drpDnBtnShapesFrameLineColor img");
l.update16x16ColorButtonIcon(aG,aE.OutlineColor);
aG=document.querySelector("#drpDnBtnShapesFrameBgColor img");
l.update16x16ColorButtonIcon(aG,aE.FillColor);
var aD=document.getElementById("tglBtnShapesFrameLineColorAutomatic");
if(aE.IsAutoOutlineColor){aD.classList.add("ribbon-button-selected");
}else{aD.classList.remove("ribbon-button-selected");
}aD=document.getElementById("tglBtnFrameBgColorAutomatic");
if(aE.IsAutoFillColor){aD.classList.add("ribbon-button-selected");
}else{aD.classList.remove("ribbon-button-selected");
}ap(aE.OutlineWidth);
};
function z(aD){var aF=parseFloat(aD.target.value);
if(isNaN(aF)){aF=l.LastFrameInfo.Size.Height*l.LastFrameInfo.Scaling.Y;
aD.target.value=parseFloat(l.twips2mm(aF).toFixed(1));
}else{var aE=l.mm2twips(aF);
l.sendCommand(l.Command.SetItemProperty,l.ItemType.Frame,l.FrameProperty.Height,Math.round(aE));
l.LastFrameInfo.Scaling.Y=aE/l.LastFrameInfo.Size.Height;
}}function A(aD){var aE=parseFloat(aD.target.value);
if(isNaN(aE)){aE=l.LastFrameInfo.Size.Width*l.LastFrameInfo.Scaling.X;
aD.target.value=parseFloat(l.twips2mm(aE).toFixed(1));
}else{var aF=l.mm2twips(aE);
l.sendCommand(l.Command.SetItemProperty,l.ItemType.Frame,l.FrameProperty.Width,Math.round(aF));
l.LastFrameInfo.Scaling.X=aF/l.LastFrameInfo.Size.Width;
}}function aA(aD){l.sendCommand(l.Command.SetItemProperty,l.ItemType.Frame,l.FrameProperty.Name,0,{name:aD.target.value});
}function az(aD){var aE=parseInt(aD.target.value,10);
if(isNaN(aE)){aD.target.value=l.LastFrameInfo.ID;
}else{l.sendCommand(l.Command.SetItemProperty,l.ItemType.Frame,l.FrameProperty.ID,0,{id:aE});
}}l.hideAllMenus_FrameFormatTab=function(){k.hide();
h.hide();
j.hide();
i.hide();
p.hide();
n.hide();
m.hide();
q.hide();
o.hide();
e.hide();
c.hide();
b.hide();
f.hide();
d.hide();
g.hide();
r.hide();
t.hide();
s.hide();
};
return ax;
}(TXTextControl||{},j$1_10_2));
var TXTextControl=(function(d,a){var b=d._private=d._private||{};
var c=d.ribbonPermissionsTab=d.ribbonPermissionsTab||{};
b.ribbonPermissionsTab={allowAdditionalUserNames:true,registeredUserNames:[]};
b.RibbonTabType={};
Object.defineProperty(c,"allowAdditionalUserNames",{get:function(){return b.ribbonPermissionsTab.allowAdditionalUserNames;
},set:function(allowAdditionalUserNames){if(typeof allowAdditionalUserNames!=="boolean"){throw new TypeError(b.ErrorText.ParamNotBoolean);
}b.sendCommand(b.Command.SetRibbonTabProperty,b.RibbonTabType.RibbonPermissionsTab,0,0,{propertyName:"allowAdditionalUserNames",value:allowAdditionalUserNames});
b.ribbonPermissionsTab.allowAdditionalUserNames=allowAdditionalUserNames;
},enumerable:true});
Object.defineProperty(c,"registeredUserNames",{get:function(){return b.ribbonPermissionsTab.registeredUserNames;
},set:function(registeredUserNames){if((registeredUserNames===null)||(registeredUserNames.constructor!==Array)){throw new TypeError('"registeredUserNames" must be an array.');
}registeredUserNames.forEach(function(e){if((typeof e!=="string")&&!(e instanceof String)){throw new TypeError('"registeredUserNames" must be an array of strings.');
}});
b.sendCommand(b.Command.SetRibbonTabProperty,b.RibbonTabType.RibbonPermissionsTab,0,0,{propertyName:"registeredUserNames",value:registeredUserNames});
b.ribbonPermissionsTab.registeredUserNames=registeredUserNames;
},enumerable:true});
return d;
}(TXTextControl||{},j$1_10_2));
var TXTextControl=(function(a6,a){"use strict";
var c=a6._private=a6._private||{};
a6.version="25.0";
function aS(){delete a6._private;
}c.isSSLConnection=(window.location.protocol==="https:");
var D=59;
c.Command=Object.freeze({Close:4,Undo:5,NewFile:6,Cut:10,Copy:11,Paste:12,Redo:13,GetFileList:14,OpenFile:15,GrowFont:17,ShrinkFont:18,SetLandscape:19,PrintToPDF:22,IncreaseIndent:23,DecreaseIndent:24,InputFormat:28,WindowResized:34,HScroll:35,VScroll:36,ScrollDelta:37,InsertBlankPage:38,InsertBreak:39,Zoom:45,ImageLoaded:52,ClientPaste:53,GetDocumentTargets:54,InsertItem:55,GetItem:56,DeleteItem:57,EnableSpellChecking:58,EnableHyphenation:59,InsertDocumentFile:60,GetDialogResources:61,SetAppMode:62,MailMergePrevNav:63,FinishAndMerge:64,ShowDialog:65,DialogResult:66,SelectMasterTable:70,SetFieldDisplayMode:71,HighlightMergeFields:72,ComponentEvent:77,CloseDialog:79,EditDataRelations:82,EditMergeBlocks:84,GoToItem:85,DisplayVisualElement:86,TableCommand:87,ContextMenuItemClicked:89,SetItemProperty:92,SaveDocumentFile:94,Ping:95,SetGUID:103,EnableLangDetect:105,Save:108,ComponentActivationState:109,EditMode:111,Selection:112,BackColor:113,StatusBarColor:114,SpellCheckDialogCommand:117,OpenDirectory:119,ContextMenusEnabled:123,SetTextFieldsEditable:124,IsTouchDevice:126,ServerConsoleWriteLine:127,CreateTextControl:130,SelectAll:132,TXSettingsMVC:133,ResetContents:135,HighlightMergeBlocks:136,ClientSelection:137,EnableLoadWaitDialog:138,ClientTextPart:139,ClipboardMode:141,GetFileDirectory:144,SetFileDirectory:145,ClientSetFormattingPrinter:146,ClientGetFormattingPrinter:147,ClientGetInstalledPrinters:148,SectionFormatProperty:151,PageBackgroundColor:152,RibbonTabsLoaded:153,DataSourceManagerEvent:155,GetClipboardFormats:156,ClientTextField:157,ClientSubTextPart:158,SpellCheck:159,SetTxProperty:161,RibbonMenuEvent:163,RibbonButtonEvent:165,RibbonTextBoxEvent:170,RibbonIconsLoaded:172,UpdateField:174,ThesaurusDialogCommand:176,AppendDocumentFile:177,PermissionsAddUserDialogCommand:178,CheckedListBoxEvent:179,SetDocumentPermissions:182,SetRibbonTabProperty:183,AddImage:186,AddTextFrame:187});
var h=Object.freeze({FontList:2,FileList:4,StyleList:6,Image:7,PrintResult:8,FontSizes:9,InputFormat:11,DocumentSizeChanged:12,Zoomed:13,InputPositionChanged:16,TextViewLocation:19,TextMessage:20,DBScheme:21,SetCursor:22,DocumentTargets:23,Item:24,DialogResources:25,SetAppMode:26,ShowDialog:27,FieldDisplayModeChanged:28,SetRibbonButtonState:29,WaitDialog:30,MergeFieldHighlightingChanged:32,CaretStateChanged:33,CloseDialog:34,ImageRegions:35,Scroll:36,ContextMenuData:37,ConsoleLog:38,DrawShape:39,FieldPropertiesDialog:40,HyperlinkClicked:41,Pong:42,UnknownProtocol:43,StringResources:44,ItemActivationStateChangedEvent:46,HTMLDialogState:47,DocumentDirtyChanged:48,DocumentSaved:49,EnableSaveDocumentQuestion:50,SetTextViewActivationState:51,EditMode:52,ImageResources:53,MenuContent:54,WSDisconnectReason:55,MergeBlockHighlightingChanged:56,ServerEvent:57,DocumentData:58,SelectionData:59,TextPartData:60,TrialString:61,ClipboardMode:62,TextControlLoaded:63,SubTextPartEvent:64,FileDirectory:65,BackColor:66,StatusBarColor:67,FormattingPrinter:68,InstalledPrinters:69,TextControlChanged:70,SupportedPaperSizes:71,SectionFormatProperty:72,PageBackgroundColor:73,DrawingControlInfo:74,DataSourceManagerEvent:75,ClipboardFormats:76,TextFieldData:77,SubTextPartData:78,SpellCheckCommandResponse:79,FrameEvent:80,CreatePrivateJsObject:81,RibbonTab:82,RibbonControlState:84,RibbonButtonState:85,RibbonMenuItemState:86,RibbonTextBoxState:87,ShowFieldDialog:88,FrameInfo:89,CheckedListItemState:90,CheckedListBoxState:91,DocumentPermissionChange:92,TXPropertyChanged:93,SelectionHTMLContent:999,});
c.FileType={Document:0,Image:1,DataBase:2};
c.DialogCategory={TXDialog:0,HTMLDialog:1,};
c.HTMLDialogType=Object.freeze({None:0,MergeFieldDialog:1,IfFieldDialog:2,IncludeTextFieldDialog:3,DateFieldDialog:4,NextIfFieldDialog:5,MaxPreviewRowsDialog:6,InputBoxDialog:7,EditMergeBlocksDialog:8,InsertMergeBlockDialog:9,WaitDialog:10,EditDataRelationsDialog:11,CreateDataRelationDialog:12,HyperlinkDialog:14,OptionsDialog:15,ChartDataRelDialog:17,SaveDocumentAsDialog:18,ClientPasteDialog:19,SpellCheckDialog:20,OpenFileDialog:21,LoadDictionaryDialog:22,EdgePrintDialog:23,SetChartDataRelationDialog:24,FontDialog:25,ThesaurusDialog:26,LoadThesaurusDialog:27,PermissionsAddUserDialog:28});
c.TXDialogType=Object.freeze({Unknown:0,FontDialog:1,ParagraphFormatDialog:2,InsertTableDialog:3,ChildDialog:4,ListFormatDialog:5,FormattingStylesDialog:6,SectionFormatDialog:7,LanguageDialog:8,TableFormatDialog:9,TabDialog:12,ObjectAttributesDialog:13,FindDialog:14,ReplaceDialog:15,ForeColorDialog:16,TextBackColorDialog:17,InsertSymbolDialog:18,FrameFillColorDialog:19,FrameLineColorDialog:20,PageColorDialog:21});
c.VisualElement=Object.freeze({ControlChars:0,TextFrameMarkerLines:1,BookmarkMarkers:2,TableGridLines:3,DrawingMarkerLines:4,FrameAnchors:5});
c.ConsoleLogType={Log:0,Debug:1,Info:2,Warn:3,Error:4};
c.ItemActivationState={Deactivated:0,Activated:1};
c.ServerEventType={TXComponentsLoaded:0,DocumentLoaded:1};
var a3={VariousMessages:0,RibbonStrings:1};
var a8={Unknown:0,ServiceNotInstalled:1,ServiceNotRunning:2,CouldNotConnectToService:3};
var t={Moved:1,Sized:2};
var b={Left:false,Middle:false,Right:false};
c.variousMessages={webSocketErrMsg:{text:"Can't connect to the server.\nPlease refresh the website to re-connect."}};
c.imageResources={};
c.webSocketHandlerURL="";
c.documentSavedEventHandlers=[];
c.documentDirty=false;
c.saveDocumentQuestionEnabled=true;
c.ignoreNextTextFocusRequest=false;
c.inIMEComposition=false;
c.trialStringInf=null;
c.trialStringWDId=null;
c.proofingSettings=null;
c.supportedPaperSizes=[];
c.FrameEventType={};
function y(){var bd=("ontouchend" in document||window.DocumentTouch&&document instanceof DocumentTouch);
var bc=c.BrowserDetect.browser;
return bd&&(bc!=="Edge")&&(bc!=="Explorer")&&(bc!=="Firefox")&&(bc!=="Chrome");
}c.isTouchDevice=y();
if(c.isTouchDevice){c.clipboardMode=c.ClipboardMode.Server;
}c.isSocketConnected=function(){return c.socket&&(c.socket.readyState==WebSocket.OPEN);
};
c.sendCommand=function(bd,bf,bg,bh,be){if(!c.isSocketConnected()){return;
}var bc={CommandID:parseInt(bd,10),Param1:bf||0,Param2:bg||0,Param3:bh||0,Data:be||"",};
var bi=JSON.stringify(bc);
c.socket.send(bi);
};
c.getHostAndWebSocketHandlerPath=function(){var bf="";
var bd="";
if(typeof c.settings!=="undefined"){return c.getHostAndAppVirtPath();
}if(typeof c.webControlSettings!=="undefined"){if(c.webControlSettings.webSocketHandlerPath){bd=c.webControlSettings.webSocketHandlerPath;
}else{return c.getHostAndAppVirtPath();
}}var be=window.location.pathname.split("/");
be.pop();
var bc=(be.length==0)?"/":be.join("/")+"/";
if(bd){if(bd.slice(-1)!=="/"){bd+="/";
}if(bd[0]==="/"){bf=window.location.host+bd;
}else{bf=window.location.host+bc+bd;
}}else{bf=window.location.host+bc;
}return bf;
};
c.getAppVirtualPath=function(){if(typeof c.webControlSettings!=="undefined"){appVirtPath=c.webControlSettings.appVirtPath;
}else{if(typeof c.settings!=="undefined"){appVirtPath=c.settings.AppVirtualPath;
}}return"";
};
c.getHostAndAppVirtPath=function(){var bf="";
var bc="";
if(typeof c.webControlSettings!=="undefined"){bc=c.webControlSettings.appVirtPath;
}else{if(typeof c.settings!=="undefined"){bc=c.settings.AppVirtualPath;
}}if(bc){bf=window.location.host+bc;
}else{var be=window.location.pathname.split("/");
be.pop();
var bd=(be.length==0)?"/":be.join("/")+"/";
bf=window.location.host+bd;
}return bf;
};
c.getTXFileDir=function(){if(typeof c.webControlSettings!=="undefined"){return"";
}var bd=c.getHostAndAppVirtPath();
var bc=c.isSSLConnection?"https://":"http://";
if(typeof c.settings!=="undefined"){return bc+bd+c.settings.BasePath;
}else{return bc+bd;
}};
function w(){var bc=(typeof c.settings!=="undefined")&&c.settings.IsMVC;
var be=c.isSSLConnection?"wss://":"ws://";
var bd=c.getHostAndWebSocketHandlerPath();
if(bc){return be+bd+c.settings.ApiRoute+"TXWebSocket";
}else{return be+bd+"TXWebSocketHandler.ashx";
}}function i(){var bc=document.getElementById("txRibbonTabContentContainer");
var bd=bc.querySelectorAll("img[data-orig-src]");
[].forEach.call(bd,function(be){var bf=be.dataset.origSrc;
be.src=c.settings.AppVirtualPath+c.settings.BasePath+bf;
delete be.dataset.origSrc;
});
}c.changeImageSources=function(){if(typeof c.settings!=="undefined"){i();
}};
function a5(){var bd,bc;
bc=document.getElementById("__txWebControlSettings");
if(bc){bd=bc.innerHTML;
c.webControlSettings=JSON.parse(bd);
bc.parentNode.removeChild(bc);
}else{bc=document.getElementById("__txSettings");
if(bc){bd=bc.innerHTML;
c.settings=JSON.parse(bd);
bc.parentNode.removeChild(bc);
}}}c.init=function(){var be=document.getElementById("mainCanvas");
var bc=document.getElementById("horRulerCanvas");
var bg=document.getElementById("vertRulerCanvas");
var bf=document.getElementById("statusBarCanvas");
be.width=window.innerWidth;
be.height=window.innerHeight;
bc.width=window.innerWidth;
bg.height=window.innerHeight;
bf.width=window.innerWidth;
c.textViewer=new c.ComponentViewer(be,c.ComponentType.TextView);
c.horRulerViewer=new c.ComponentViewer(bc,c.ComponentType.HorRuler);
c.vertRulerViewer=new c.ComponentViewer(bg,c.ComponentType.VertRuler);
c.statusBarViewer=new c.ComponentViewer(bf,c.ComponentType.StatusBar);
a5();
c.webSocketHandlerURL=w();
console.info("Connecting to "+c.webSocketHandlerURL);
c.socket=new WebSocket(c.webSocketHandlerURL,"TXTextControl.Web");
c.socket.addEventListener("open",bb);
c.socket.addEventListener("message",ba);
c.socket.addEventListener("error",a9);
c.socket.addEventListener("close",a7);
x();
window.addEventListener("unload",A);
window.addEventListener("resize",C);
window.addEventListener("blur",B);
e();
f();
document.addEventListener("inputPositionChanged",c.inputPositionChangedHandler);
document.addEventListener("uiFlagsUpdated",c.uiFlagsUpdatedHandler);
document.addEventListener("imageReceived",c.imageReceivedHandler);
document.addEventListener("imageRegionsUpdated",c.imageRegionsUpdatedHandler);
document.addEventListener("viewContentScrolled",c.viewContentScrolledHandler);
document.addEventListener("printResultReceived",c.printResultReceivedHandler);
document.addEventListener("documentSizeChanged",c.documentSizeChangedHandler);
document.addEventListener("txZoomed",c.txZoomedHandler);
document.addEventListener("textViewLocationChanged",c.textViewLocationChangedHandler);
document.addEventListener("contextMenuDataReceived",c.contextMenuDataReceivedHandler);
document.addEventListener("txContainerResized",c.onContainerResize);
document.addEventListener("textViewCaretStateChanged",c.textViewCaretStateChangedHandler);
document.addEventListener("showFieldPropsDialog",c.showFieldPropsDialogHandler);
document.addEventListener("hyperlinkClicked",c.hyperlinkClickedHandler);
document.addEventListener("pongMessageReceived",E);
document.addEventListener("documentSaved",p);
document.addEventListener("textFieldDataReceived",c.textFieldDataReceivedHandler);
document.addEventListener("txPropertyChanged",c.txPropertyChangedHandler);
be.addEventListener("drop",c.handleDrop);
be.addEventListener("dragenter",function(bh){bh.preventDefault();
bh.stopPropagation();
});
be.addEventListener("dragover",function(bh){bh.preventDefault();
bh.stopPropagation();
bh.dataTransfer.dropEffect="copy";
});
document.getElementById("ribbonbar").addEventListener("contextmenu",F);
document.getElementById("vertical-scrollbar-wrapper").addEventListener("contextmenu",F);
document.getElementById("horizontal-scrollbar-wrapper").addEventListener("contextmenu",F);
document.getElementById("scroll-button-up").addEventListener("contextmenu",F);
document.getElementById("scroll-button-down").addEventListener("contextmenu",F);
document.getElementById("scroll-button-left").addEventListener("contextmenu",F);
document.getElementById("scroll-button-right").addEventListener("contextmenu",F);
document.addEventListener("mousedown",m);
document.addEventListener("mouseup",o);
document.addEventListener("mousemove",n);
document.addEventListener("click",l);
c.initContextMenus();
c.createScrollbars();
c.adaptViewToContainerSize();
setInterval(function(){c.sendCommand(c.Command.Ping);
},D*1000);
if(!c.isTouchDevice){c.textViewer.focus();
}var bd=document.getElementById("txLoaderGif");
bd.style.opacity=1;
aS();
};
a(document).ready(function(){c.init();
});
function e(){var bd=window.MutationObserver||window.WebKitMutationObserver||window.MozMutationObserver;
var be=new bd(function(bf){bf.forEach(function(bg){switch(bg.type){case"attributes":switch(bg.attributeName){case"style":j();
break;
}break;
}});
});
var bc={attributes:true,childList:false,characterData:false};
be.observe(document.getElementById("txTemplateDesignerContainer").parentElement,bc);
}function f(){var bd=window.MutationObserver||window.WebKitMutationObserver||window.MozMutationObserver;
var bf=document.getElementById("ribbonbar");
var be=new bd(function(bg){bg.forEach(function(bh){switch(bh.type){case"attributes":switch(bh.attributeName){case"style":if(bf.style.display==="none"){if(!c.isRibbonBarRemoved){c.isRibbonBarRemoved=true;
c.ribbonBarHeight=0;
c.adaptViewToContainerSize();
}}else{if(c.isRibbonBarRemoved){c.isRibbonBarRemoved=false;
c.ribbonBarHeight=c.DEFAULT_RIBBONBAR_HEIGHT;
c.adaptViewToContainerSize();
}}break;
}break;
}});
});
var bc={attributes:true,childList:false,characterData:false};
be.observe(bf,bc);
}function aT(){if(typeof c.webControlSettings=="undefined"){return;
}if(!c.webControlSettings.hasOwnProperty("connectionID")){return;
}c.sendCommand(c.Command.SetGUID,0,0,0,c.webControlSettings.connectionID);
}function aq(){if((typeof c.settings==="undefined")||!c.settings.IsMVC){return;
}c.saveDocumentQuestionEnabled=c.settings.SaveDocumentQuestionDialogEnabled;
c.sendCommand(c.Command.SetGUID,0,0,0,c.settings.ConnectionID);
c.sendCommand(c.Command.TXSettingsMVC,0,0,0,c.settings);
}function u(bc){if(navigator.userLanguage){bc.culture=navigator.userLanguage;
bc.uiCulture=navigator.browserLanguage;
}else{var bd=navigator.languages?navigator.languages[0]:navigator.language;
if(bd){bc.culture=bc.uiCulture=bd;
}else{console.warn("Unable to detect browser language.");
}}}c.CultureSettings=(function(){function bc(culture,uiCulture){if(culture===undefined){culture="";
}if(uiCulture===undefined){uiCulture="";
}this.culture=""+culture;
this.uiCulture=""+uiCulture;
}return bc;
})();
c.getCultures=function(){var bc=new c.CultureSettings();
u(bc);
if(typeof c.webControlSettings!=="undefined"){if(c.webControlSettings.hasOwnProperty("culture")&&c.webControlSettings.hasOwnProperty("uiCulture")){if(c.webControlSettings.culture){bc.culture=c.webControlSettings.culture;
}if(c.webControlSettings.uiCulture){bc.uiCulture=c.webControlSettings.uiCulture;
}}}else{if(typeof c.settings!=="undefined"){if(c.settings.Culture){bc.culture=c.settings.Culture;
}if(c.settings.UICulture){bc.uiCulture=c.settings.UICulture;
}}}return bc;
};
function bb(){aT();
var bc=c.getCultures();
c.sendCommand(c.Command.CreateTextControl,0,0,0,bc);
c.sendCommand(c.Command.IsTouchDevice,c.isTouchDevice?1:0);
aq();
}function C(){try{j();
}catch(bc){}}function B(){c.modifierKeys=0;
}function j(){var bc=document.getElementById("txTemplateDesignerContainer").parentElement;
var bf,be;
if(bc.tagName=="BODY"){bf=window.innerWidth;
be=window.innerHeight;
}else{bf=bc.offsetWidth;
be=bc.offsetHeight;
}if((bf!=c.clientSize.Width)||(be!=c.clientSize.Height)){var bd=new CustomEvent("txContainerResized");
document.dispatchEvent(bd);
}}c.blockUserInput=function(){var bc=document.getElementById("txTemplateDesignerContainer");
var bd=document.createElement("DIV");
bd.style.position="absolute";
bd.style.left=bd.style.top="0px";
bd.style.width=bd.style.height="100%";
bd.style.background="rgba(0, 0, 0, 0.1)";
bd.style.zIndex="9998";
bc.appendChild(bd);
};
function x(){var bj=document.styleSheets||[];
for(var bd=0;
bd<bj.length;
bd++){try{var bh=bj[bd].cssRules||bj[bd].rules||[];
for(var be=0;
be<bh.length;
be++){var bg=bh[be];
switch(bg.selectorText){case"#txTemplateDesignerContainer #ribbonbar":c.ribbonBarHeight=c.DEFAULT_RIBBONBAR_HEIGHT=parseInt(bg.style.height,10);
break;
}}}catch(bc){}}var bf=document.getElementById("ribbonbar");
var bi=getComputedStyle(bf)||{};
if(bi.display==="none"){c.ribbonBarHeight=0;
c.isRibbonBarRemoved=true;
}}function q(bd,be,bc,bf){bd.style.transition="opacity "+(bf/1000)+"s";
setTimeout(function(){bd.style.opacity=0;
setTimeout(function(){be.removeChild(bd);
},bf);
},bc);
}c.showMsgDiv=function(bf,be){c.textViewer.hideCaret();
var bc=document.getElementById("txTemplateDesignerContainer");
var bd=document.createElement("DIV");
bd.id="txErrMsgDiv";
bd.classList.add("unselectable");
bd.style.zIndex="9999";
bf=bf.replace(/\r?\n/g,"<br>");
bd.innerHTML=bf;
bc.appendChild(bd);
bd.style.marginTop=-(bd.clientHeight/2)+"px";
bd.style.marginLeft=-(bd.clientWidth/2)+"px";
if(be){q(bd,bc,1000,1000);
}};
c.showErrMsgDiv=function(){c.showMsgDiv(c.variousMessages.webSocketErrMsg.text);
};
function a2(){c.blockUserInput();
c.showErrMsgDiv();
}function a9(bc){c.socket=null;
setTimeout(a2,1000);
}function a7(bd){var bc={code:bd.code,reason:bd.reason,wasClean:bd.wasClean};
c.fireEvent(c.EventName.webSocketClosed,bc);
a9();
}function ba(bc){var be=""+bc.data;
var bd=JSON.parse(be);
ap(bd);
}function ap(be){if(!be.hasOwnProperty("ID")){console.error("Message has no ID");
return;
}if(!be.hasOwnProperty("Body")){console.error("Message has no message body");
return;
}switch(be.ID){case h.FontList:Y(be.Body);
break;
case h.FileList:X(be.Body);
break;
case h.Image:af(be.Body);
break;
case h.PrintResult:au(be.Body);
break;
case h.FontSizes:Z(be.Body);
break;
case h.InputFormat:ah(be.Body);
break;
case h.DocumentSizeChanged:R(be.Body);
break;
case h.Zoomed:aQ(be.Body);
break;
case h.InputPositionChanged:ai(be.Body);
break;
case h.TextViewLocation:aL(be.Body);
break;
case h.TextMessage:var bf=c.txDialog?c.txDialog.getActiveViewer():c.textViewer;
c.documentSavedEventHandlers=[];
c.jQueryAlert(be.Body.caption,be.Body.message,bf);
break;
case h.DBScheme:O(be.Body);
break;
case h.SetCursor:aE(be.Body);
break;
case h.DocumentTargets:S(be.Body);
break;
case h.Item:al(be.Body);
break;
case h.DialogResources:P(be.Body);
break;
case h.SetAppMode:aD(be.Body);
break;
case h.ShowDialog:aG(be.Body);
break;
case h.FieldDisplayModeChanged:V(be.Body);
break;
case h.SetRibbonButtonState:aF(be.Body);
break;
case h.WaitDialog:aO(be.Body);
break;
case h.MergeFieldHighlightingChanged:ao(be.Body);
break;
case h.MergeBlockHighlightingChanged:an(be.Body);
break;
case h.CaretStateChanged:H(be.Body);
break;
case h.CloseDialog:K(be.Body);
break;
case h.ImageRegions:ag(be.Body);
break;
case h.Scroll:aw(be.Body);
break;
case h.ContextMenuData:M(be.Body);
break;
case h.ConsoleLog:L(be.Body);
break;
case h.DrawShape:U(be.Body);
break;
case h.FieldPropertiesDialog:var bc=new CustomEvent("showFieldPropsDialog");
document.dispatchEvent(bc);
break;
case h.HyperlinkClicked:ae(be.Body);
break;
case h.Pong:bc=new CustomEvent("pongMessageReceived");
document.dispatchEvent(bc);
break;
case h.UnknownProtocol:aN();
break;
case h.StringResources:aI(be.Body);
break;
case h.ItemActivationStateChangedEvent:ak(be.Body);
break;
case h.HTMLDialogState:ad(be.Body);
break;
case h.DocumentDirtyChanged:c.documentDirty=be.Body.documentDirty;
break;
case h.DocumentSaved:var bd=be.Body.message;
if(bd&&bd.length){c.showMsgDiv(bd,true);
}c.documentDirty=false;
bc=new CustomEvent("documentSaved");
document.dispatchEvent(bc);
break;
case h.EnableSaveDocumentQuestion:c.saveDocumentQuestionEnabled=be.Body.enabled;
break;
case h.SetTextViewActivationState:aU(be.Body.activationState);
break;
case h.EditMode:c.setEditMode(be.Body.editMode);
break;
case h.ImageResources:c.imageResources=be.Body;
break;
case h.MenuContent:am(be.Body);
break;
case h.WSDisconnectReason:aP(be.Body);
break;
case h.ServerEvent:aC(be.Body);
break;
case h.DocumentData:Q(be.Body);
break;
case h.SelectionData:ay(be.Body);
break;
case h.TextPartData:c.processTextPartDataMessage(be.Body);
break;
case h.TrialString:c.trialStringInf=be.Body.content;
g();
break;
case h.ClipboardMode:J(be.Body);
break;
case h.TextControlLoaded:c.fireEvent(c.EventName.textControlLoaded);
break;
case h.SubTextPartEvent:aJ(be.Body);
break;
case h.FileDirectory:W(be.Body);
break;
case h.BackColor:G(be.Body);
break;
case h.StatusBarColor:aH(be.Body);
break;
case h.FormattingPrinter:aa(be.Body);
break;
case h.InstalledPrinters:aj(be.Body);
break;
case h.TextControlChanged:c.fireEvent(c.EventName.textControlChanged);
break;
case h.SupportedPaperSizes:aK(be.Body);
break;
case h.SectionFormatProperty:ax(be.Body);
break;
case h.PageBackgroundColor:at(be.Body);
break;
case h.DrawingControlInfo:T(be.Body);
break;
case h.DataSourceManagerEvent:N(be.Body);
break;
case h.ClipboardFormats:I(be.Body);
break;
case h.SelectionHTMLContent:c.processSelectionHTMLContentMessage(be.Body);
break;
case h.TextFieldData:c.processTextFieldDataMessage(be.Body);
break;
case h.SubTextPartData:c.processSubTextPartDataMessage(be.Body);
break;
case h.SpellCheckCommandResponse:c.processSpellCheckCommandResponse(be.Body);
break;
case h.FrameEvent:ab(be.Body);
break;
case h.CreatePrivateJsObject:c.createPrivateObject(be.Body);
break;
case h.RibbonTab:c.addRibbonTab(be.Body);
break;
case h.RibbonControlState:c.changeRibbonControlState(be.Body);
break;
case h.RibbonButtonState:c.changeRibbonButtonState(be.Body);
break;
case h.RibbonMenuItemState:c.changeRibbonMenuItemState(be.Body);
break;
case h.RibbonTextBoxState:c.changeRibbonTextBoxState(be.Body);
break;
case h.ShowFieldDialog:c.showFieldDialog(be.Body.dialogContent.field,be.Body.dialogContent.fieldType,be.Body.textField);
break;
case h.FrameInfo:ac(be.Body);
break;
case h.CheckedListItemState:c.changeCheckedListItemState(be.Body);
break;
case h.CheckedListBoxState:c.changeCheckedListBoxState(be.Body);
break;
case h.DocumentPermissionChange:c.setDocumentPermission(be.Body);
break;
case h.TXPropertyChanged:aM(be.Body);
break;
}}function aU(bc){switch(bc){case c.ActivationState.Activated:c.textViewer.focus();
break;
case c.ActivationState.Deactivated:c.textViewer.blur();
break;
}}function af(bd){var bc=new CustomEvent("imageReceived",{detail:bd});
document.dispatchEvent(bc);
}function Y(bd){var bc=new CustomEvent("fontListReceived",{detail:{fontNames:bd.fontNames}});
document.dispatchEvent(bc);
}function k(bd){var bc=new CustomEvent("uiFlagsUpdated",{detail:bd});
document.dispatchEvent(bc);
}function X(bd){var bc=new CustomEvent("fileListReceived",{detail:bd});
document.dispatchEvent(bc);
}function au(bd){var bc=new CustomEvent("printResultReceived",{detail:bd});
document.dispatchEvent(bc);
}function Z(bd){var bc=new CustomEvent("fontSizesReceived",{detail:{fontSizes:bd.fontSizes}});
document.dispatchEvent(bc);
}function ah(bd){var bc=new CustomEvent("inputFormatReceived",{detail:bd});
document.dispatchEvent(bc);
}function R(bd){var bc=new CustomEvent("documentSizeChanged",{detail:bd});
document.dispatchEvent(bc);
}function aQ(bd){var bc=new CustomEvent("txZoomed",{detail:bd});
document.dispatchEvent(bc);
}c.InputPositionChangedEventArgs=(function(){function bc(inputPosition){for(var bd in inputPosition){this[bd]=inputPosition[bd];
}}return bc;
})();
function ai(be){var bd=new CustomEvent("inputPositionChanged",{detail:be});
document.dispatchEvent(bd);
var bc=new c.InputPositionChangedEventArgs(be.InputPosition);
c.fireEvent(c.EventName.inputPositionChanged,bc);
k(be.uiFlags);
}function ac(bd){var bc=new CustomEvent("frameInfoReceived",{detail:bd});
document.dispatchEvent(bc);
}function aM(bd){var bc=new CustomEvent("txPropertyChanged",{detail:bd});
document.dispatchEvent(bc);
}function TextViewLocationChangedEventArgs(x,y){this.location=new c.Point(x,y);
}function aL(be){var bd=new CustomEvent("textViewLocationChanged",{detail:be});
document.dispatchEvent(bd);
var bf=c.twips2px(be.X,100,96);
var bg=c.twips2px(be.Y,100,96);
var bc=new TextViewLocationChangedEventArgs(bf,bg);
c.fireEvent(c.EventName.textViewLocationChanged,bc);
k(be.uiFlags);
}function O(bd){var bc=new CustomEvent("dbSchemeReceived",{detail:bd});
document.dispatchEvent(bc);
}function aE(bd){var bc=new CustomEvent("componentCursorChanged",{detail:bd});
document.dispatchEvent(bc);
}function S(bd){var bc=new CustomEvent("documentTargetsReceived",{detail:{targets:bd.targets}});
document.dispatchEvent(bc);
}function al(bd){var bc=new CustomEvent("txItemReceived",{detail:bd});
document.dispatchEvent(bc);
switch(bd.itemType){case c.ItemType.FieldAdapter:bc=new CustomEvent("fieldDataReceived",{detail:bd.item});
document.dispatchEvent(bc);
break;
case c.ItemType.TextField:bc=new CustomEvent("textFieldDataReceived",{detail:bd});
document.dispatchEvent(bc);
break;
}}function P(bd){var bc=new CustomEvent("dialogResourcesReceived",{detail:bd});
document.dispatchEvent(bc);
}function aD(bd){var bc=new CustomEvent("appModeChanged",{detail:bd});
document.dispatchEvent(bc);
}function aG(bc){switch(bc.dialogCategory){case c.DialogCategory.HTMLDialog:aX(bc);
break;
case c.DialogCategory.TXDialog:if(!c.txDialog){c.txDialog=new c.TxDialog(bc.initialImage,bc.caption,bc.dialogType);
c.txDialog.showModal();
}else{c.txDialog.showChildDialog(bc.initialImage,bc.caption);
}break;
}}function aX(bd){var bc;
switch(bd.dialogType){case c.HTMLDialogType.InputBoxDialog:aY(bd);
break;
case c.HTMLDialogType.MaxPreviewRowsDialog:aZ(bd);
break;
case c.HTMLDialogType.ChildDialog:if(c.txDialog){c.txDialog.showChildDialog(bd.initialImage,bd.caption);
}else{c.jQueryAlert("Error Message","Can not open child dialog without having any TXTextControl dialog open.");
}break;
case c.HTMLDialogType.EditDataRelationsDialog:aV(bd.relations);
break;
case c.HTMLDialogType.EditMergeBlocksDialog:aW(bd.blocks);
break;
case c.HTMLDialogType.OptionsDialog:a0(bd.options);
break;
case c.HTMLDialogType.InsertMergeBlockDialog:bc=new c.InsertMergeBlockDialog(bd.name,c.dbScheme);
bc.showModal();
break;
case c.HTMLDialogType.SaveDocumentAsDialog:a1(bd.fileName,bd.streamType);
break;
case c.HTMLDialogType.SpellCheckDialog:bc=new c.SpellCheckDialog(bd);
bc.showModal();
break;
case c.HTMLDialogType.LoadDictionaryDialog:bc=new c.LoadDictionaryDialog(bd);
bc.showModal();
break;
case c.HTMLDialogType.SetChartDataRelationDialog:bc=new c.SetChartDataRelationDialog(bd);
bc.showModal();
break;
case c.HTMLDialogType.FontDialog:bc=new c.FontDialog(bd.state);
bc.showModal();
break;
case c.HTMLDialogType.ThesaurusDialog:bc=new c.ThesaurusDialog(bd);
bc.showModal();
break;
case c.HTMLDialogType.LoadThesaurusDialog:bc=new c.LoadThesaurusDialog(bd);
bc.showModal();
break;
case c.HTMLDialogType.PermissionsAddUserDialog:bc=new c.PermissionsAddUserDialog(bd);
bc.showModal();
break;
}}function V(bd){var bc=new CustomEvent("fieldDisplayModeChanged",{detail:bd});
document.dispatchEvent(bc);
}function aF(bd){var bc=new CustomEvent("ribbonButtonStateMessageReceived",{detail:bd});
document.dispatchEvent(bc);
}function aO(bd){var bc=new CustomEvent("waitDialogMessageReceived",{detail:bd});
document.dispatchEvent(bc);
}function ao(bd){var bc=new CustomEvent("mergeFieldHighlightingChanged",{detail:bd});
document.dispatchEvent(bc);
}function an(bd){var bc=new CustomEvent("mergeBlockHighlightingChanged",{detail:bd});
document.dispatchEvent(bc);
}function H(bd){var be=bd.target;
switch(be){case c.ComponentType.TxDialog:var bc=new CustomEvent("dialogCaretStateChanged",{detail:bd});
document.dispatchEvent(bc);
break;
case c.ComponentType.TextView:bc=new CustomEvent("textViewCaretStateChanged",{detail:bd});
document.dispatchEvent(bc);
break;
}}function K(bd){var bc=new CustomEvent("txDialogClosed",{detail:bd});
document.dispatchEvent(bc);
}function ag(bd){var bc=new CustomEvent("imageRegionsUpdated",{detail:bd});
document.dispatchEvent(bc);
}function aw(bd){var bc=new CustomEvent("viewContentScrolled",{detail:bd});
document.dispatchEvent(bc);
}function M(bd){var bc=new CustomEvent("contextMenuDataReceived",{detail:bd});
document.dispatchEvent(bc);
}function L(bc){var bd=bc.text;
switch(bc.type){case c.ConsoleLogType.Log:console.log(bd);
break;
case c.ConsoleLogType.Debug:console.debug(bd);
break;
case c.ConsoleLogType.Info:console.info(bd);
break;
case c.ConsoleLogType.Warn:console.warn(bd);
break;
case c.ConsoleLogType.Error:console.error(bd);
break;
}}function U(bd){var bc=new CustomEvent("drawShapeMessageReceived",{detail:bd});
document.dispatchEvent(bc);
}function ae(bd){var bc=new CustomEvent("hyperlinkClicked",{detail:bd.link});
document.dispatchEvent(bc);
}function aN(){}function aI(bc){var bd=bc.resources;
switch(bc.type){case a3.VariousMessages:c.variousMessages=bd;
break;
case a3.RibbonStrings:c.ribbonStringResources=bd;
c.initRibbon();
break;
}}function av(bc){c.proofingSettings=bc;
if(bc.isSpellCheckingEnabled){a("#btnSpelling").removeClass("txui-state-disabled");
a("#btnLoadDictionary").removeClass("txui-state-disabled");
a("#tglBtnEnableSpellCheck").addClass("ribbon-button-selected");
}else{a("#btnSpelling").addClass("txui-state-disabled");
a("#btnLoadDictionary").addClass("txui-state-disabled");
a("#tglBtnEnableSpellCheck").removeClass("ribbon-button-selected");
}if(bc.isLangDetectEnabled){a("#tglBtnEnableLangDetect").addClass("ribbon-button-selected");
}else{a("#tglBtnEnableLangDetect").removeClass("ribbon-button-selected");
}if(bc.isHyphenationEnabled){a("#tglBtnEnableHyphenation").addClass("ribbon-button-selected");
}else{a("#tglBtnEnableHyphenation").removeClass("ribbon-button-selected");
}}function ak(bd){var bc=null;
switch(bd.itemType){case c.ItemType.HeaderFooter:switch(bd.activationState){case c.ItemActivationState.Activated:bc=new CustomEvent("headerFooterActivated");
break;
case c.ItemActivationState.Deactivated:bc=new CustomEvent("headerFooterDeactivated");
break;
}break;
}if(bc){document.dispatchEvent(bc);
}}function ad(bd){switch(bd.dialogType){case c.HTMLDialogType.SpellCheckDialog:var bc=new CustomEvent("spellCheckDialogStateUpdated",{detail:bd.state});
document.dispatchEvent(bc);
break;
case c.HTMLDialogType.ThesaurusDialog:var bc=new CustomEvent("thesaurusDialogStateUpdated",{detail:bd.state});
document.dispatchEvent(bc);
break;
case c.HTMLDialogType.PermissionsAddUserDialog:var bc=new CustomEvent("permissionsAddUserDialogUpdated",{detail:bd.state});
document.dispatchEvent(bc);
break;
}}function am(bc){switch(bc.menuType){case c.MenuType.InsertShapes:c.insertShapesMenuContent=bc.menuItems;
break;
case c.MenuType.InsertChart:c.insertChartMenuContent=bc.menuItems;
break;
}}function aP(bc){var bd="";
switch(bc.reason){case a8.CouldNotConnectToService:bd="The web server could not connect to the\r\nTX Text Control service for unknown reasons.";
break;
case a8.ServiceNotInstalled:bd="The web server could not connect to the TX Text Control service\r\nbecause the service is not installed.";
break;
case a8.ServiceNotRunning:bd="The web server could not connect to the TX Text Control service\r\nbecause the service is not running.";
break;
}if(bd){c.variousMessages.webSocketErrMsg.text=bd;
}console.error(bc.excType+": "+bc.excMsg);
}function aC(bc){switch(bc.eventType){case c.ServerEventType.DocumentLoaded:r(bc.eventData);
break;
}}c.DocumentLoadedEventArgs=(function(){function bc(fileName){this.fileName=fileName;
}return bc;
})();
function r(bd){var bc=new c.DocumentLoadedEventArgs(bd.FileName);
c.fireEvent(c.EventName.documentLoaded,bc);
}c.SaveDocumentResult=(function(){function bc(data,streamType){this.data=data;
this.streamType=streamType;
}return bc;
})();
function Q(bh){var be=c.documentTaskCallbacks.save;
c.documentTaskCallbacks.save=[];
if(bh.excMsg){throw new Error(bh.excMsg);
}for(var bg=0;
bg<be.length;
++bg){var bd=be[bg];
var bc=new c.SaveDocumentResult(bh.data,bh.streamType);
try{bd(bc);
}catch(bf){}}}function ay(bc){switch(bc.selectionCommand){case c.SelectionCommand.Save:aB(bc.content);
break;
case c.SelectionCommand.GetStartAndLength:az(bc.content);
break;
case c.SelectionCommand.GetCulture:aA(bc.content);
break;
default:ar(bc.content);
break;
}}function aB(bh){var be=c.selectionTaskCallbacks.save;
c.selectionTaskCallbacks.save=[];
if(bh.excMsg){throw new Error(bh.excMsg);
}for(var bg=0;
bg<be.length;
++bg){var bd=be[bg];
var bc=new c.SaveDocumentResult(bh.data,bh.streamType);
try{bd(bc);
}catch(bf){}}}function az(bg){var bd=c.selectionTaskCallbacks.getBounds;
c.selectionTaskCallbacks.getBounds=[];
if(bg.excMsg){throw new Error(bg.excMsg);
}for(var bf=0;
bf<bd.length;
++bf){var bc=bd[bf];
try{bc({start:bg.start,length:bg.length});
}catch(be){}}}function aA(bg){var bd=c.selectionTaskCallbacks.getCulture;
c.selectionTaskCallbacks.getCulture=[];
if(bg.excMsg){throw new Error(bg.excMsg);
}for(var bf=0;
bf<bd.length;
++bf){var bc=bd[bf];
try{bc(bg.culture);
}catch(be){}}}function ar(bc){if(bc.excMsg){throw new Error(bc.excMsg);
}}function J(bc){if(c.isTouchDevice){return;
}c.setClipboardMode(bc.mode);
}c.SubTextPartEventArgs=(function(){function bc(subTextPart){for(var bd in subTextPart){this[bd]=subTextPart[bd];
}}return bc;
})();
function aJ(bd){var bc="";
switch(bd.eventType){case c.SubTextPartEventType.Entered:bc=c.EventName.subTextPartEntered;
break;
case c.SubTextPartEventType.Left:bc=c.EventName.subTextPartLeft;
break;
case c.SubTextPartEventType.Clicked:bc=c.EventName.subTextPartClicked;
break;
case c.SubTextPartEventType.DoubleClicked:bc=c.EventName.subTextPartDoubleClicked;
break;
}if(bc){c.fireEvent(bc,new c.SubTextPartEventArgs(bd.subTextPart));
}}function W(bg){var bd=[];
switch(bg.fileType){case c.FileType.Document:bd=c.controlTaskCallbacks.getFileDir.document;
c.controlTaskCallbacks.getFileDir.document=[];
break;
case c.FileType.Image:bd=c.controlTaskCallbacks.getFileDir.image;
c.controlTaskCallbacks.getFileDir.image=[];
break;
case c.FileType.DataBase:bd=c.controlTaskCallbacks.getFileDir.db;
c.controlTaskCallbacks.getFileDir.db=[];
break;
}for(var bf=0;
bf<bd.length;
++bf){var bc=bd[bf];
try{bc(bg.dir);
}catch(be){}}}function G(bg){var bd=c.controlTaskCallbacks.getBackColor;
c.controlTaskCallbacks.getBackColor=[];
for(var bf=0;
bf<bd.length;
++bf){var bc=bd[bf];
try{bc(bg.color);
}catch(be){}}}function aH(bg){var bd=c.controlTaskCallbacks.getStatusBarColor;
c.controlTaskCallbacks.getStatusBarColor=[];
for(var bf=0;
bf<bd.length;
++bf){var bc=bd[bf];
try{bc(bg.color);
}catch(be){}}}function aa(bg){var bd=c.controlTaskCallbacks.getFormattingPrinter;
c.controlTaskCallbacks.getFormattingPrinter=[];
for(var bf=0;
bf<bd.length;
++bf){var bc=bd[bf];
try{bc(bg.printerName);
}catch(be){}}}function aj(bg){var bd=c.controlTaskCallbacks.getInstalledPrinters;
c.controlTaskCallbacks.getInstalledPrinters=[];
for(var bf=0;
bf<bd.length;
++bf){var bc=bd[bf];
try{bc(bg.printerNames);
}catch(be){}}}function aK(bd){c.supportedPaperSizes=bd.paperSizes;
var bc=new CustomEvent("supportedPaperSizesChanged");
document.dispatchEvent(bc);
}function ax(bd){var bc;
switch(bd.id){case c.SectionFormatProperty.PageSize:bc=new CustomEvent("pageSizeChanged",{detail:bd.value});
document.dispatchEvent(bc);
break;
case c.SectionFormatProperty.PageBorder:bc=new CustomEvent("pageBorderReceived",{detail:bd.value});
document.dispatchEvent(bc);
break;
}}function at(bd){var bc=new CustomEvent("pageBackgroundColorReceived",{detail:bd});
document.dispatchEvent(bc);
}function T(bd){var bc=new CustomEvent("drawingControlInfoReceived",{detail:bd.drawingControlInfo});
document.dispatchEvent(bc);
}function N(bd){var bc,be;
switch(bd.eventType){case c.DataSourceManagerEvent.PossibleMergeFieldColumnsChanged.id:be=c.DataSourceManagerEvent.PossibleMergeFieldColumnsChanged.name;
break;
case c.DataSourceManagerEvent.PossibleMergeBlockTablesChanged.id:be=c.DataSourceManagerEvent.PossibleMergeBlockTablesChanged.name;
break;
case c.DataSourceManagerEvent.MasterDataTableInfoChanged.id:be=c.DataSourceManagerEvent.MasterDataTableInfoChanged.name;
break;
case c.DataSourceManagerEvent.IsMergingPossibleChanged.id:be=c.DataSourceManagerEvent.IsMergingPossibleChanged.name;
break;
case c.DataSourceManagerEvent.DataTablesChanged.id:be=c.DataSourceManagerEvent.DataTablesChanged.name;
break;
case c.DataSourceManagerEvent.DataRelationsChanged.id:be=c.DataSourceManagerEvent.DataRelationsChanged.name;
break;
case c.DataSourceManagerEvent.DataProviderNameChanged.id:be=c.DataSourceManagerEvent.DataProviderNameChanged.name;
break;
case c.DataSourceManagerEvent.ConnectionStringChanged.id:be=c.DataSourceManagerEvent.ConnectionStringChanged.name;
break;
}bc=new CustomEvent(be,{detail:bd.args});
document.dispatchEvent(bc);
}function I(bd){var bc=new CustomEvent("clipboardFormatsReceived",{detail:bd.formatNames});
document.dispatchEvent(bc);
}function ab(be){var bd=null;
switch(be.eventType){case c.FrameEventType.Sized:bd="frameSized";
break;
case c.FrameEventType.Moved:bd="frameMoved";
break;
}if(bd){var bc=new CustomEvent(bd,{detail:be.args});
document.dispatchEvent(bc);
}}c.createPrivateObject=function(bd){c[bd.name]=c[bd.name]||{};
for(var bc in bd.description){c[bd.name][bc]=bd.description[bc];
}};
function a4(){var bc=document.getElementById(c.trialStringInf.id);
if(!bc){g();
}else{if(!bc.style.display||(bc.style.display!==d.display)){bc.style.display=d.display;
}if(!bc.style.position||(bc.style.position!==d.position)){bc.style.position=d.position;
}if(bc.style.zIndex){bc.style.zIndex="";
}if(!bc.style.left||(bc.style.left!==d.left)){bc.style.left=d.left;
}if(!bc.style.top||(bc.style.top!==(d.top+"px"))){bc.style.top=d.top+"px";
}if(!bc.style.marginLeft||(bc.style.marginLeft!==(d.marginLeft+"px"))){bc.style.marginLeft=d.marginLeft+"px";
}if(!bc.style.width||(bc.style.width!==(d.width+"px"))){bc.style.width=d.width+"px";
}if(!bc.style.overflow||(bc.style.overflow!==d.overflow)){bc.style.overflow=d.overflow;
}if(!bc.style.opacity||(bc.style.opacity!=d.opacity)){bc.style.opacity=d.opacity;
}if(!bc.style.fontSize||(bc.style.fontSize!==(d.fontSize+"pt"))){bc.style.fontSize=d.fontSize+"pt";
}if(!bc.style.color||(bc.style.color.replace(/ /g,"")!==d.color)){bc.style.color=d.color;
}if(bc.innerHTML!==d.innerHTML){bc.innerHTML=d.innerHTML;
}if(bc.style.transform){bc.style.transform="";
}if(bc.style.zIndex!==d.zIndex){bc.style.zIndex=d.zIndex;
}}}function aR(bd){if(bd<1){throw"ID must at least be one character long.";
}var bg="";
var bf="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";
var be="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789_";
for(var bc=0;
bc<bd;
++bc){if(bc==0){bg+=bf.charAt(Math.floor(Math.random()*bf.length));
}else{bg+=be.charAt(Math.floor(Math.random()*be.length));
}}return bg;
}function v(bc){var bd=bc.children.length;
if(!bd){return null;
}return bc.children[Math.floor(Math.random()*bd)];
}var d={position:"absolute",display:"block",left:"50%",top:0,marginLeft:0,overflow:"visible",opacity:0.3,width:0,zIndex:1,fontSize:16,color:"rgb(0,0,0)",innerHTML:""};
function g(){var bc=c.trialStringInf.color;
var bh=(bc.A/255).toFixed(2);
d.opacity=bh;
var bd=document.createElement("div");
bd.textContent=c.trialStringInf.text;
bd.style.position=d.position;
if(!c.trialStringWDId){bd.style.opacity=0;
}else{bd.style.opacity=bh;
}d.color="rgb("+bc.R+","+bc.G+","+bc.B+")";
bd.style.color=d.color;
bd.style.fontFamily=c.trialStringInf.fontFamily;
d.fontSize=c.trialStringInf.fontSize;
bd.style.fontSize=c.trialStringInf.fontSize+"pt";
bd.style.pointerEvents="none";
bd.style.zIndex=d.zIndex;
bd.style.textAlign="center";
bd.style.display=d.display;
if(!c.trialStringWDId){bd.style.transition="opacity 2s";
}bd.classList.add("unselectable");
d.innerHTML=bd.innerHTML;
bd.id=aR(10);
c.trialStringInf.id=bd.id;
var bg=document.getElementById("mainCanvas");
var bi=document.getElementById("txTemplateDesignerContainer");
try{var bf=v(bi);
bi.insertBefore(bd,bf);
}catch(be){if(be instanceof TypeError&&c.trialStringWDId){clearInterval(c.trialStringWDId);
return;
}}d.top=bg.offsetTop+c.trialStringInf.yPos;
bd.style.top=d.top+"px";
d.width=bd.clientWidth+10;
bd.style.width=d.width+"px";
d.marginLeft=-(bd.clientWidth/2);
bd.style.marginLeft=d.marginLeft+"px";
bd.style.left=d.left;
if(!c.trialStringWDId){setTimeout(function(){bd.style.opacity=bh;
},2000);
}if(!c.trialStringWDId){c.trialStringWDId=setInterval(a4,2000);
}}c.fileSaveQuestion=function(be){be=be||function(){};
if(!c.saveDocumentQuestionEnabled){be();
return;
}var bi=c.txDialog?c.txDialog.getActiveViewer():c.textViewer;
var bd=c.variousMessages.fileSaveQuestionDlg.caption;
var bh=c.variousMessages.fileSaveQuestionDlg.text;
var bj=c.variousMessages.fileSaveQuestionDlg.yesBtnTxt;
var bf=c.variousMessages.fileSaveQuestionDlg.noBtnTxt;
var bc=c.variousMessages.fileSaveQuestionDlg.cancelBtnTxt;
c.documentSavedEventHandlers=[];
var bg=function(){c.documentSavedEventHandlers.push(be);
c.sendCommand(c.Command.Save);
};
a('<div style="font-size: 10pt; min-width: 250px">'+bh+"</div>").dialog({modal:true,resizable:false,title:bd,width:"auto",height:130,buttons:{Yes:{text:bj,click:function(){a(this).dialog("destroy").remove();
bg();
if(bi&&!c.isTouchDevice){bi.focus();
}}},No:{text:bf,click:function(){a(this).dialog("destroy").remove();
be();
if(bi&&!c.isTouchDevice){bi.focus();
}}},Cancel:{text:bc,click:function(){a(this).dialog("destroy").remove();
if(bi&&!c.isTouchDevice){bi.focus();
}}}},close:function(){a(this).dialog("destroy").remove();
if(bi&&!c.isTouchDevice){bi.focus();
}}});
};
function aY(bc){var bd=new c.InputBoxDialog(bc.title,bc.text,bc.label,bc.isPasswordBox);
bd.showModal();
}function aZ(bc){var bd=new c.MaxPreviewRowsDialog(bc.value);
bd.showModal();
}function aV(bd){var bc=new c.EditDataRelationsDialog(bd);
bc.showModal();
}function aW(bc){var bd=new c.EditMergeBlocksDialog(bc);
bd.showModal();
}function a0(bd){var bc=new c.OptionsDialog(bd);
bc.showModal();
}function a1(bd,be){var bc=new c.SaveDocumentAsDialog(bd,be);
bc.showModal();
}function s(bc){if(c.isTouchDevice){return;
}var bd=document.getElementById("txTemplateDesignerContainer");
if((bc==bd)||(bd.contains(bc))){if((bc.tagName!=="SELECT")&&(bc.tagName!=="INPUT")){c.textViewer.focus();
}}}function z(bc){var bd=document.getElementsByClassName("scrollbar-wrapper");
for(var be=0;
be<bd.length;
++be){if(bd[be].contains(bc)){s(bc);
break;
}}}function m(bd){try{z(bd.target);
b.Left=(bd.which==1);
b.Middle=(bd.which==2);
b.Right=(bd.which==3);
}catch(bc){}}function n(bd){try{if(c.mouseOwner){c.mouseOwner.canvas_MouseMove(bd);
}}catch(bc){}}function o(bd){try{if(bd.which==1){b.Left=false;
}if(bd.which==2){b.Middle=false;
}if(bd.which==3){b.Right=false;
}if(c.mouseOwner){c.mouseOwner.canvas_MouseUp(bd);
}if(!b.Left&&!b.Middle&&!b.Right){c.mouseOwner=null;
}}catch(bc){}}function l(bd){try{s(bd.target);
}catch(bc){}}function E(){}function p(){for(var bd=0;
bd<c.documentSavedEventHandlers.length;
++bd){var bc=c.documentSavedEventHandlers[bd];
bc();
}c.documentSavedEventHandlers=[];
}function F(bc){bc.preventDefault();
}c.webSocketDisconnect=function(){if(!c.socket){return;
}if(c.isSocketConnected()){c.socket.removeEventListener("error",a9);
c.socket.removeEventListener("close",a7);
c.socket.close();
}c.socket=null;
};
function A(bc){try{c.sendCommand(c.Command.Close);
c.webSocketDisconnect();
}catch(bc){}}c.unsubscribeDocumentAndWindowEvents=function(){};
c.jQueryAlert=function(bc,bd,be){bc=bc||"";
bd=bd||"";
bd=bd.replace(/\r?\n/g,"<br>");
be=typeof be!=="undefined"?be:null;
a('<div style="font-size: 10pt; min-width: 250px">'+bd+"</div>").dialog({modal:true,resizable:false,title:bc,width:"auto",buttons:{OK:function(){a(this).dialog("destroy").remove();
if(be&&!c.isTouchDevice){be.focus();
}},},close:function(){a(this).dialog("destroy").remove();
if(be&&!c.isTouchDevice){be.focus();
}}});
};
return a6;
}(TXTextControl||{},j$1_10_2));
if(typeof randomIntFromInterval!=="function"){randomIntFromInterval=function(b,a){return Math.floor(Math.random()*(a-b+1)+b);
};
}if(typeof isInteger!=="function"){isInteger=function(a){return(a===+a)&&(a===(a|0));
};
}!Array.prototype.find&&(Array.prototype.find=function(a){for(var b=0;
b<this.length;
++b){if(a(this[b],b,this)){return this[b];
}}return null;
});
!Array.prototype.some&&(Array.prototype.some=function(a){return this.find(a)!==null;
});
!Number.prototype.mod&&(Number.prototype.mod=function(a){return((this%a)+a)%a;
});
if(typeof CustomEvent!=="function"){(function(){function a(b,d){d=d||{bubbles:false,cancelable:false,detail:undefined};
var c=document.createEvent("CustomEvent");
c.initCustomEvent(b,d.bubbles,d.cancelable,d.detail);
return c;
}a.prototype=window.CustomEvent.prototype;
window.CustomEvent=a;
})();
}if(typeof cloneObject!=="function"){cloneObject=function(a){return JSON.parse(JSON.stringify(a));
};
}var TXTextControl=(function(v,a){var b=v._private=v._private||{};
b.ribbonStringResources={};
b.setRibbonStrings=function(){var y=b.ribbonStringResources;
for(var x in y){if(y.hasOwnProperty(x)){if(typeof y[x]==="string"){y[x]=y[x].replace(/\r?\n/g,"<br>");
}}}var w=document.getElementById("tabFile");
w.textContent=w.dataset.text=y.RIBBON_MNU_FILE_TITLE;
w=document.getElementById("tabDefault");
w.textContent=w.dataset.text=y.RIBBON_TAB_HOME_TITLE;
w=document.getElementById("tabInsert");
w.textContent=w.dataset.text=y.RIBBON_TAB_INSERT_TITLE;
w=document.getElementById("tabPageLayout");
w.textContent=w.dataset.text=y.RIBBON_TAB_PAGE_LAYOUT_TITLE;
w=document.getElementById("tabReports");
w.textContent=w.dataset.text=y.RIBBON_TAB_REPORTS_TITLE;
w=document.getElementById("tabView");
w.textContent=w.dataset.text=y.RIBBON_TAB_VIEW_TITLE;
w=document.getElementById("tabProofing");
w.textContent=w.dataset.text=y.RIBBON_TAB_PROOF_TITLE;
w=document.getElementById("tabTableLayout");
w.textContent=w.dataset.text=y.RIBBON_TAB_TBL_LAYOUT_TITLE;
b.adaptRibbonTabWidths();
e("fileMnuItemNew",y.RIBBON_MNU_FILE_NEW);
e("fileMnuItemOpen",y.RIBBON_MNU_FILE_OPEN);
e("fileMnuItemSave",y.RIBBON_MNU_FILE_SAVE);
e("fileMnuItemSaveAs",y.RIBBON_MNU_FILE_SAVE_AS);
e("fileMnuItemPrintToPDF",y.RIBBON_MNU_FILE_PRINT);
e("fileMnuItemOptions",y.RIBBON_MNU_FILE_OPTIONS);
r(y);
delete b.ribbonStringResources;
};
function r(w){g(w);
h(w);
n(w);
k(w);
u(w);
f(w);
t(w);
d(w);
}function d(x){var w=document.querySelectorAll(".ribbon-group img.txDialogLauncher");
[].forEach.call(w,function(y){switch(y.id){case"btnDlgLnchFontGrp":y.title=x.RIBBON_TAB_HOME_GRP_FONT_DLG_LAUNCHER_TOOLTIP;
break;
case"btnDlgLnchParGrp":y.title=x.RIBBON_TAB_HOME_GRP_PARA_DLG_LAUNCHER_TOOLTIP;
break;
case"btnDlgLnchPgSetupGrp":y.title=x.RIBBON_TAB_PAGE_LAYOUT_GRP_SETUP_DLG_LAUNCHER_TOOLTIP;
break;
case"btnDlgLnchColBreaksGrp":y.title=x.RIBBON_TAB_PAGE_LAYOUT_GRP_COLS_BREAKS_DLG_LAUNCHER_TOOLTIP;
break;
case"btnDlgLnchParIndGrp":y.title=x.RIBBON_TAB_PAGE_LAYOUT_GRP_PAR_IND_DLG_LAUNCHER_TOOLTIP;
break;
case"btnDlgLnchPageBgFramesGrp":y.title=x.RIBBON_TAB_PAGE_LAYOUT_GRP_PAGE_BG_FRAMES_DLG_LAUNCHER_TOOLTIP;
break;
case"btnDlgLnchTblFrmsAndBgGrp":y.title=x.RIBBON_TAB_TBL_LAYOUT_GRP_FRAMES_DLG_LAUNCHER_TOOLTIP;
break;
case"btnDlgLnchTblAlignGrp":y.title=x.RIBBON_TAB_TBL_LAYOUT_GRP_ALIGN_DLG_LAUNCHER_TOOLTIP;
break;
case"btnDlgLnchFrameArrangeGrp":y.title=x.RIBBON_TAB_FRAME_FMT_GRP_ARR_DLG_LAUNCHER_TOOLTIP;
break;
case"btnDlgLnchFrameSizeGrp":y.title=x.RIBBON_TAB_FRAME_FMT_GRP_SIZE_DLG_LAUNCHER_TOOLTIP;
break;
case"btnDlgLnchFramesAndBgGrp":case"btnDlgLnchFramesAndBgGrpTextFrames":y.title=x.RIBBON_TAB_FRAME_FMT_GRP_FRAMES_AND_BG_DLG_LAUNCHER_TOOLTIP;
break;
case"btnDlgLnchColsAndAlignGrp":y.title=x.RIBBON_TAB_FRAME_FMT_GRP_COL_AND_ALIGN_DLG_LAUNCHER_TOOLTIP;
break;
}});
}function e(z,A){var x=document.getElementById(z);
if(!x){console.error('Could not find menu item "'+z+'".');
return;
}var w=x.getElementsByClassName("large-menu-item-caption-container");
if(!w.length){console.error("Menu item caption container div not found.");
return;
}var y=document.createElement("P");
y.textContent=A;
w[0].appendChild(y);
}function o(w,A,B){if(typeof A==="undefined"){console.error('Ribbon button text for buton "'+w+'" is undefined.');
return;
}var x=document.getElementById(w);
if(!x){console.error('Could not find button "'+w+'".');
return;
}if(B){x.title=B;
}var z=x.querySelector("span.ribbon-button-label-text");
if(z){z.innerHTML=A;
}else{var y=x.querySelector("p.ribbon-button-label");
if(!y){console.error("Ribbon button label element not found. ("+w+")");
return;
}y.innerHTML=A;
}}function m(y,z){var x=document.getElementById(y);
if(!x){console.error('Could not find menu item "'+y+'".');
return;
}var w=x.querySelector(".menu-item-category-header h1");
if(!w){console.error("Ribbon menu section header element not found ("+y+")");
return;
}w.textContent=z;
}function q(y,z){if(z===undefined){console.error('Ribbon group title for group "'+y+'" is undefined.');
return;
}var w=document.getElementById(y);
if(!w){console.error('Could not find ribbon group "'+y+'".');
return;
}var x=w.querySelector("p.ribbon-group-label");
if(!x){console.error("Ribbon group label element not found. ("+y+")");
return;
}x.textContent=z;
}function p(w,y){if(typeof y==="undefined"){console.error('Tooltip text for ribbon button "'+w+'" is undefined.');
return;
}var x=document.getElementById(w);
if(!x){console.error('Could not find button "'+w+'".');
return;
}x.setAttribute("title",y);
}function l(z,w){var x=document.getElementById(z);
if(!x){console.error('Could not find menu item "'+z+'".');
return;
}var y=x.querySelector(".large-menu-item-caption-container p, .small-menu-item-caption-container p, .menu-item-caption-container-numbered-list p, .menu-item-caption-container-42px p");
if(!y){console.error("List menu item caption element not found. ("+z+")");
return;
}y.textContent=w;
}function j(A,z,B){var x=document.getElementById(A);
if(!x){console.error('Could not find menu item "'+A+'".');
return;
}if(z){var w=x.querySelector(".large-menu-item-long-caption-container h1");
w.textContent=z;
}if(B){var y=x.querySelector(".large-menu-item-long-caption-container p");
y.innerHTML=B;
}}function i(w,y){var x=document.querySelector("label[for="+w+"]");
if(!x){console.error('Could not find label for element "'+w+'".');
return;
}if(!x){console.error("Label for element "+w+" not found.");
return;
}x.textContent=y;
}function s(x,y){var w=document.querySelector("#"+x+" a");
if(!w){console.error('Could not find menu item "'+x+'".');
return;
}if(!w){console.error("Menu item "+x+" not found.");
return;
}w.textContent=y;
}function g(w){q("ribbonGroupClipboard",w.RIBBON_TAB_HOME_GRP_CLIPB_TITLE);
if(b.isTouchDevice){o("btnPaste",w.RIBBON_TAB_HOME_GRP_CLIPB_BTN_PASTE);
}else{o("btnPaste",w.RIBBON_TAB_HOME_GRP_CLIPB_PASTE_BTN_SERVER_PASTE);
}if(b.isTouchDevice){j("mnuItemServerPaste",w.RIBBON_TAB_HOME_GRP_CLIPB_PASTE_MNU_ITM_SERVER_HEAD,w.RIBBON_TAB_HOME_GRP_CLIPB_PASTE_MNU_ITM_SERVER_DESC);
j("mnuItemClientPaste",w.RIBBON_TAB_HOME_GRP_CLIPB_PASTE_MNU_ITM_CLIENT_HEAD,w.RIBBON_TAB_HOME_GRP_CLIPB_PASTE_MNU_ITM_CLIENT_DESC);
}else{o("tglBtnLocalClipboard",w.RIBBON_TAB_HOME_GRP_CLIPB_BTN_LOCAL_CLIPB);
}o("btnCut",w.RIBBON_TAB_HOME_GRP_CLIPB_BTN_CUT);
o("btnCopy",w.RIBBON_TAB_HOME_GRP_CLIPB_BTN_COPY);
l("mnuItemTextHighlightColorAutomatic",w.RIBBON_COLOR_MENU_ITEM_AUTOMATIC);
l("mnuItemTextHighlightColorMoreColors",w.RIBBON_COLOR_MENU_ITEM_MORE_COLORS);
l("mnuItemTextColorAutomatic",w.RIBBON_COLOR_MENU_ITEM_AUTOMATIC);
l("mnuItemTextColorMoreColors",w.RIBBON_COLOR_MENU_ITEM_MORE_COLORS);
l("mnuItemBackColorAutomatic",w.RIBBON_COLOR_MENU_ITEM_AUTOMATIC);
l("mnuItemBackColorMoreColors",w.RIBBON_COLOR_MENU_ITEM_MORE_COLORS);
l("mnuItemFrameColorAutomatic",w.RIBBON_COLOR_MENU_ITEM_AUTOMATIC);
l("mnuItemFrameColorMoreColors",w.RIBBON_COLOR_MENU_ITEM_MORE_COLORS);
q("ribbonGroupFont",w.RIBBON_TAB_HOME_GRP_FONT_TITLE);
p("btnFontGrow",w.RIBBON_TAB_HOME_GRP_FONT_BTN_GROW);
p("btnFontShrink",w.RIBBON_TAB_HOME_GRP_FONT_BTN_SHRINK);
p("tglBtnBold",w.RIBBON_TAB_HOME_GRP_FONT_BTN_BOLD);
p("tglBtnItalic",w.RIBBON_TAB_HOME_GRP_FONT_BTN_ITALIC);
p("drpDnBtnUnderlineStyles",w.RIBBON_TAB_HOME_GRP_FONT_BTN_UNDERLINE);
l("mnuItemULStyleSingle",w.RIBBON_TAB_HOME_GRP_FONT_UNDERLINE_MNU_ITM_SINGLE);
l("mnuItemULStyleDoubled",w.RIBBON_TAB_HOME_GRP_FONT_UNDERLINE_MNU_ITM_DOUBLED);
l("mnuItemULStyleSingleWO",w.RIBBON_TAB_HOME_GRP_FONT_UNDERLINE_MNU_ITM_SINGLE_WORDS);
l("mnuItemULStyleDoubledWO",w.RIBBON_TAB_HOME_GRP_FONT_UNDERLINE_MNU_ITM_DOUBLED_WORDS);
p("tglBtnStrikethrough",w.RIBBON_TAB_HOME_GRP_FONT_BTN_STRIKETHROUGH);
p("tglBtnSubscript",w.RIBBON_TAB_HOME_GRP_FONT_BTN_SUBSCRIPT);
p("tglBtnSuperscript",w.RIBBON_TAB_HOME_GRP_FONT_BTN_SUPERSCRIPT);
p("drpDnBtnTextHighlightColor",w.RIBBON_TAB_HOME_GRP_FONT_BTN_HIGHLIGHT_COLOR);
p("drpDnBtnTextColor",w.RIBBON_TAB_HOME_GRP_FONT_BTN_COLOR);
q("ribbonGroupParagraph",w.RIBBON_TAB_HOME_GRP_PARA_TITLE);
p("drpDnBtnBulletList",w.RIBBON_TAB_HOME_GRP_PARA_BTN_LST_BULLET);
l("mnuItemBulletListDisc",w.RIBBON_TAB_HOME_GRP_PARA_LST_BULLET_MNU_ITM_DISC);
l("mnuItemBulletListDash",w.RIBBON_TAB_HOME_GRP_PARA_LST_BULLET_MNU_ITM_DASH);
l("mnuItemBulletListAsterisk",w.RIBBON_TAB_HOME_GRP_PARA_LST_BULLET_MNU_ITM_ASTERISK);
l("mnuItemBulletListDiamond",w.RIBBON_TAB_HOME_GRP_PARA_LST_BULLET_MNU_ITM_DIAMOND);
l("mnuItemBulletListArrow",w.RIBBON_TAB_HOME_GRP_PARA_LST_BULLET_MNU_ITM_ARROW);
l("mnuItemListFormatBullet",w.RIBBON_TAB_HOME_GRP_PARA_LST_MNU_ITM_FMT_LST);
p("drpDnBtnNumberedList",w.RIBBON_TAB_HOME_GRP_PARA_BTN_LST_NUMBERED);
l("mnuItemNumberedList_123",w.RIBBON_TAB_HOME_GRP_PARA_LST_NUMBERED_MNU_ITM_123);
l("mnuItemNumberedList_abc",w.RIBBON_TAB_HOME_GRP_PARA_LST_NUMBERED_MNU_ITM_ABC);
l("mnuItemNumberedList_ABC",w.RIBBON_TAB_HOME_GRP_PARA_LST_NUMBERED_MNU_ITM_ABC_CAPS);
l("mnuItemNumberedList_III",w.RIBBON_TAB_HOME_GRP_PARA_LST_NUMBERED_MNU_ITM_ROMAN);
l("mnuItemNumberedList_iii",w.RIBBON_TAB_HOME_GRP_PARA_LST_NUMBERED_MNU_ITM_ROMAN_SMALL);
l("mnuItemFormatListNumbered",w.RIBBON_TAB_HOME_GRP_PARA_LST_MNU_ITM_FMT_LST);
p("drpDnBtnStructuredList",w.RIBBON_TAB_HOME_GRP_PARA_BTN_LST_STRUCT);
l("mnuItemStructuredList_123",w.RIBBON_TAB_HOME_GRP_PARA_LST_NUMBERED_MNU_ITM_123);
l("mnuItemStructuredList_abc",w.RIBBON_TAB_HOME_GRP_PARA_LST_NUMBERED_MNU_ITM_ABC);
l("mnuItemStructuredList_ABC",w.RIBBON_TAB_HOME_GRP_PARA_LST_NUMBERED_MNU_ITM_ABC_CAPS);
l("mnuItemStructuredList_III",w.RIBBON_TAB_HOME_GRP_PARA_LST_NUMBERED_MNU_ITM_ROMAN);
l("mnuItemStructuredList_iii",w.RIBBON_TAB_HOME_GRP_PARA_LST_NUMBERED_MNU_ITM_ROMAN_SMALL);
l("mnuItemFormatListStructured",w.RIBBON_TAB_HOME_GRP_PARA_LST_MNU_ITM_FMT_LST);
p("btnIndentDecrease",w.RIBBON_TAB_HOME_GRP_PARA_BTN_IND_DEC);
p("btnIndentIncrease",w.RIBBON_TAB_HOME_GRP_PARA_BTN_IND_INC);
p("tglBtnTextDirLTR",w.RIBBON_TAB_HOME_GRP_PARA_BTN_LTR);
p("tglBtnTextDirRTL",w.RIBBON_TAB_HOME_GRP_PARA_BTN_RTL);
p("btnTabs",w.RIBBON_TAB_HOME_GRP_PARA_BTN_TABS);
p("tglBtnControlChars",w.RIBBON_TAB_HOME_GRP_PARA_BTN_CTRL_CHARS);
p("tglBtnAlignLeft",w.RIBBON_TAB_HOME_GRP_PARA_BTN_ALIGN_LEFT);
p("tglBtnAlignCenter",w.RIBBON_TAB_HOME_GRP_PARA_BTN_ALIGN_CENTER);
p("tglBtnAlignRight",w.RIBBON_TAB_HOME_GRP_PARA_BTN_ALIGN_RIGHT);
p("tglBtnAlignJust",w.RIBBON_TAB_HOME_GRP_PARA_BTN_ALIGN_JUST);
p("drpDnBtnLineSpacing",w.RIBBON_TAB_HOME_GRP_PARA_BTN_LINE_SPACE);
l("mnuItemLineSpacing_1_0",w.RIBBON_TAB_HOME_GRP_PARA_LINE_SPACE_MNU_ITM_1_0);
l("mnuItemLineSpacing_1_15",w.RIBBON_TAB_HOME_GRP_PARA_LINE_SPACE_MNU_ITM_1_15);
l("mnuItemLineSpacing_1_5",w.RIBBON_TAB_HOME_GRP_PARA_LINE_SPACE_MNU_ITM_1_5);
l("mnuItemLineSpacing_2_0",w.RIBBON_TAB_HOME_GRP_PARA_LINE_SPACE_MNU_ITM_2_0);
l("mnuItemLineSpacing_2_5",w.RIBBON_TAB_HOME_GRP_PARA_LINE_SPACE_MNU_ITM_2_5);
l("mnuItemLineSpacing_3_0",w.RIBBON_TAB_HOME_GRP_PARA_LINE_SPACE_MNU_ITM_3_0);
p("drpDnBtnBorders",w.RIBBON_TAB_HOME_GRP_PARA_BTN_BORDERS);
l("mnuItemBorderLeft",w.RIBBON_TAB_HOME_GRP_PARA_BORDERS_MNU_ITM_LEFT);
l("mnuItemBorderTop",w.RIBBON_TAB_HOME_GRP_PARA_BORDERS_MNU_ITM_TOP);
l("mnuItemBorderRight",w.RIBBON_TAB_HOME_GRP_PARA_BORDERS_MNU_ITM_RIGHT);
l("mnuItemBorderBottom",w.RIBBON_TAB_HOME_GRP_PARA_BORDERS_MNU_ITM_BOT);
l("mnuItemBorderOutside",w.RIBBON_TAB_HOME_GRP_PARA_BORDERS_MNU_ITM_OUTSIDE);
l("mnuItemBorderAll",w.RIBBON_TAB_HOME_GRP_PARA_BORDERS_MNU_ITM_ALL);
l("mnuItemBorderInsideHor",w.RIBBON_TAB_HOME_GRP_PARA_BORDERS_MNU_ITM_INS_HOR);
l("mnuItemBorderInsideVert",w.RIBBON_TAB_HOME_GRP_PARA_BORDERS_MNU_ITM_INS_VERT);
p("drpDnBtnFrameLineWidth",w.RIBBON_TAB_HOME_GRP_PARA_BTN_FRAME_LINE_WIDTH);
p("drpDnBtnFrameColor",w.RIBBON_TAB_HOME_GRP_PARA_BTN_FRAME_LINE_COLOR);
p("drpDnBtnBackColor",w.RIBBON_TAB_HOME_GRP_PARA_BTN_BACK_COLOR);
l("mnuItemFrameLineWidth_0_25",w.RIBBON_TAB_HOME_GRP_PARA_LINE_WIDTH_MNU_ITM_0_25);
l("mnuItemFrameLineWidth_0_5",w.RIBBON_TAB_HOME_GRP_PARA_LINE_WIDTH_MNU_ITM_0_5);
l("mnuItemFrameLineWidth_0_75",w.RIBBON_TAB_HOME_GRP_PARA_LINE_WIDTH_MNU_ITM_0_75);
l("mnuItemFrameLineWidth_1_0",w.RIBBON_TAB_HOME_GRP_PARA_LINE_WIDTH_MNU_ITM_1_0);
l("mnuItemFrameLineWidth_1_5",w.RIBBON_TAB_HOME_GRP_PARA_LINE_WIDTH_MNU_ITM_1_5);
l("mnuItemFrameLineWidth_2_25",w.RIBBON_TAB_HOME_GRP_PARA_LINE_WIDTH_MNU_ITM_2_25);
l("mnuItemFrameLineWidth_3_0",w.RIBBON_TAB_HOME_GRP_PARA_LINE_WIDTH_MNU_ITM_3_0);
l("mnuItemFrameLineWidth_4_5",w.RIBBON_TAB_HOME_GRP_PARA_LINE_WIDTH_MNU_ITM_4_5);
l("mnuItemFrameLineWidth_6_0",w.RIBBON_TAB_HOME_GRP_PARA_LINE_WIDTH_MNU_ITM_6_0);
q("ribbonGroupStyles",w.RIBBON_TAB_HOME_GRP_STYLES_TITLE);
o("drpDnBtnStyles",w.RIBBON_TAB_HOME_GRP_STYLES_BTN_STYLES);
j("mnuItemManageStyles",w.RIBBON_TAB_HOME_GRP_STYLES_STYLES_MNU_ITM_MANAGE_HEAD,w.RIBBON_TAB_HOME_GRP_STYLES_STYLES_MNU_ITM_MANAGE_DESC);
q("ribbonGroupEditing",w.RIBBON_TAB_HOME_GRP_EDIT_TITLE);
o("btnUndo",w.RIBBON_TAB_HOME_GRP_EDIT_BTN_UNDO);
o("btnRedo",w.RIBBON_TAB_HOME_GRP_EDIT_BTN_REDO);
o("btnFind",w.RIBBON_TAB_HOME_GRP_EDIT_BTN_FIND);
o("btnReplace",w.RIBBON_TAB_HOME_GRP_EDIT_BTN_REPLACE);
o("btnSelectAll",w.RIBBON_TAB_HOME_GRP_EDIT_BTN_SEL_ALL);
o("btnSelectObjects",w.RIBBON_TAB_HOME_GRP_EDIT_BTN_SEL_OBJ);
if(document.getElementById("clipboardFormatDropDown")){l("mnuItemClipFmt_FormattedText",w.CLIPBOARD_FMT_FORMATTED_TEXT);
l("mnuItemClipFmt_UnformattedText",w.CLIPBOARD_FMT_UNFORMATTED_TEXT);
l("mnuItemClipFmt_Image",w.CLIPBOARD_FMT_IMAGE);
l("mnuItemClipFmt_TextFrame",w.CLIPBOARD_FMT_TEXT_FRAME);
l("mnuItemClipFmt_Chart",w.CLIPBOARD_FMT_CHART);
l("mnuItemClipFmt_Barcode",w.CLIPBOARD_FMT_BARCODE);
l("mnuItemClipFmt_Drawing",w.CLIPBOARD_FMT_DRAWING);
}}function c(w){j("mnuItemInsertQRCode",null,w.RIBBON_TAB_INSERT_GRP_ILLUST_BARCODE_MNU_QRCODE);
j("mnuItemInsertAztecCode",null,w.RIBBON_TAB_INSERT_GRP_ILLUST_BARCODE_MNU_AZTECCODE);
j("mnuItemInsertDatamatrix",null,w.RIBBON_TAB_INSERT_GRP_ILLUST_BARCODE_MNU_DATAMATRIX);
j("mnuItemInsertPDF417",null,w.RIBBON_TAB_INSERT_GRP_ILLUST_BARCODE_MNU_PDF417);
j("mnuItemInsertMicroPDF",null,w.RIBBON_TAB_INSERT_GRP_ILLUST_BARCODE_MNU_MICROPDF);
j("mnuItemInsertMaxicode",null,w.RIBBON_TAB_INSERT_GRP_ILLUST_BARCODE_MNU_MAXICODE);
m("mnuItemInsertCode128",w.RIBBON_TAB_INSERT_GRP_ILLUST_BARCODE_MNU_HDR_1D);
j("mnuItemInsertCode128",null,w.RIBBON_TAB_INSERT_GRP_ILLUST_BARCODE_MNU_CODE128);
j("mnuItemInsertEAN13",null,w.RIBBON_TAB_INSERT_GRP_ILLUST_BARCODE_MNU_EAN13);
j("mnuItemInsertUPCA",null,w.RIBBON_TAB_INSERT_GRP_ILLUST_BARCODE_MNU_UPCA);
j("mnuItemInsertEAN8",null,w.RIBBON_TAB_INSERT_GRP_ILLUST_BARCODE_MNU_EAN8);
j("mnuItemInsertInterleaved2of5",null,w.RIBBON_TAB_INSERT_GRP_ILLUST_BARCODE_MNU_INTERL2OF5);
j("mnuItemInsertPostnet",null,w.RIBBON_TAB_INSERT_GRP_ILLUST_BARCODE_MNU_POSTNET);
j("mnuItemInsertCode39",null,w.RIBBON_TAB_INSERT_GRP_ILLUST_BARCODE_MNU_CODE39);
j("mnuItemInsertIntelligentMail",null,w.RIBBON_TAB_INSERT_GRP_ILLUST_BARCODE_MNU_INTELMAIL);
j("mnuItemInsertCodabar",null,w.RIBBON_TAB_INSERT_GRP_ILLUST_BARCODE_MNU_CODABAR);
j("mnuItemInsertFourState",null,w.RIBBON_TAB_INSERT_GRP_ILLUST_BARCODE_MNU_FOURSTATE);
j("mnuItemInsertCode11",null,w.RIBBON_TAB_INSERT_GRP_ILLUST_BARCODE_MNU_CODE11);
j("mnuItemInsertCode93",null,w.RIBBON_TAB_INSERT_GRP_ILLUST_BARCODE_MNU_CODE93);
j("mnuItemInsertPLANET",null,w.RIBBON_TAB_INSERT_GRP_ILLUST_BARCODE_MNU_PLANET);
j("mnuItemInsertRoyalMail",null,w.RIBBON_TAB_INSERT_GRP_ILLUST_BARCODE_MNU_ROYMAIL);
}function h(w){q("ribbonGroupPages",w.RIBBON_TAB_INSERT_GRP_PAGES_TITLE);
o("btnBlankPage",w.RIBBON_TAB_INSERT_GRP_PAGES_BTN_BLANK_PAGE);
o("btnPageBreak",w.RIBBON_TAB_INSERT_GRP_PAGES_BTN_PAGE_BREAK);
q("ribbonGroupTables",w.RIBBON_TAB_INSERT_GRP_TABLES_TITLE);
o("drpDnBtnInsertTable",w.RIBBON_TAB_INSERT_GRP_TABLES_BTN_TABLE);
j("mnuItemInsertTable",w.RIBBON_TAB_INSERT_GRP_TABLES_INS_MNU_ITM_TBL_HEAD,w.RIBBON_TAB_INSERT_GRP_TABLES_INS_MNU_ITM_TBL_DESC);
document.querySelector("#mnuItemTableWizard .txTblWizHdrFirstPart").textContent=w.RIBBON_TAB_INSERT_GRP_TABLES_INS_MNU_ITM_TBL_HEAD;
q("ribbonGroupIllustrations",w.RIBBON_TAB_INSERT_GRP_ILLUST_TITLE);
o("drpDnBtnInsertImage",w.RIBBON_TAB_INSERT_GRP_ILLUST_BTN_IMAGE);
j("mnuItemInsertImage",w.RIBBON_TAB_INSERT_GRP_ILLUST_IMAGE_MNU_ITM_IMAGE_HEAD,w.RIBBON_TAB_INSERT_GRP_ILLUST_IMAGE_MNU_ITM_IMAGE_DESC);
j("mnuItemInsertImagePlacehld",w.RIBBON_TAB_INSERT_GRP_ILLUST_IMAGE_MNU_ITM_IMG_PLCHLD_HEAD,w.RIBBON_TAB_INSERT_GRP_ILLUST_IMAGE_MNU_ITM_IMG_PLCHLD_DESC);
o("drpDnBtnInsertShape",w.RIBBON_TAB_INSERT_GRP_ILLUST_BTN_SHAPES);
o("drpDnBtnInsertChart",w.RIBBON_TAB_INSERT_GRP_ILLUST_BTN_CHART);
o("drpDnBtnInsertBarcode",w.RIBBON_TAB_INSERT_GRP_ILLUST_BTN_BARCODE);
m("mnuItemInsertQRCode",w.RIBBON_TAB_INSERT_GRP_ILLUST_BARCODE_MNU_HDR_2D);
c(w);
q("ribbonGroupLinks",w.RIBBON_TAB_INSERT_GRP_LINKS_TITLE);
o("drpDnBtnInsertHyperlink",w.RIBBON_TAB_INSERT_GRP_LINKS_BTN_HYPLNK);
j("mnuItemInsertHyperlink",w.RIBBON_TAB_INSERT_GRP_LINKS_HYPLNK_MNU_ITM_INS_HEAD,w.RIBBON_TAB_INSERT_GRP_LINKS_HYPLNK_MNU_ITM_INS_DESC);
j("mnuItemEditHyperlink",w.RIBBON_TAB_INSERT_GRP_LINKS_HYPLNK_MNU_ITM_EDIT_HEAD,w.RIBBON_TAB_INSERT_GRP_LINKS_HYPLNK_MNU_ITM_EDIT_DESC);
j("mnuItemDeleteHyperlink",w.RIBBON_TAB_INSERT_GRP_LINKS_HYPLNK_MNU_ITM_DELETE_HEAD,w.RIBBON_TAB_INSERT_GRP_LINKS_HYPLNK_MNU_ITM_DELETE_DESC);
o("drpDnBtnInsertBookmark",w.RIBBON_TAB_INSERT_GRP_LINKS_BTN_BOOKMRK);
j("mnuItemInsertBookmark",w.RIBBON_TAB_INSERT_GRP_LINKS_BKMRK_MNU_ITM_INS_HEAD,w.RIBBON_TAB_INSERT_GRP_LINKS_BKMRK_MNU_ITM_INS_DESC);
j("mnuItemDeleteBookmark",w.RIBBON_TAB_INSERT_GRP_LINKS_BKMRK_MNU_ITM_DEL_HEAD,w.RIBBON_TAB_INSERT_GRP_LINKS_BKMRK_MNU_ITM_DEL_DESC);
j("mnuItemEditBookmark",w.RIBBON_TAB_INSERT_GRP_LINKS_BKMRK_MNU_ITM_EDIT_HEAD,w.RIBBON_TAB_INSERT_GRP_LINKS_BKMRK_MNU_ITM_EDIT_DESC);
j("mnuItemShowBookmarkMarkers",w.RIBBON_TAB_INSERT_GRP_LINKS_BKMRK_MNU_ITM_SHOW_MRK_HEAD,w.RIBBON_TAB_INSERT_GRP_LINKS_BKMRK_MNU_ITM_SHOW_MRK_DESC);
o("drpDnBtnInsertHeader",w.RIBBON_TAB_INSERT_GRP_HDRFTR_BTN_HEADER);
q("ribbonGroupHeadersAndFooters",w.RIBBON_TAB_INSERT_GRP_HDRFTR_TITLE);
j("mnuItemEditHeader",w.RIBBON_TAB_INSERT_GRP_HDRFTR_HEADER_MNU_ITM_EDIT_HEAD,w.RIBBON_TAB_INSERT_GRP_HDRFTR_HEADER_MNU_ITM_EDIT_DESC);
j("mnuItemRemoveHeader",w.RIBBON_TAB_INSERT_GRP_HDRFTR_HEADER_MNU_ITM_DEL_HEAD,w.RIBBON_TAB_INSERT_GRP_HDRFTR_HEADER_MNU_ITM_DEL_DESC);
o("drpDnBtnInsertFooter",w.RIBBON_TAB_INSERT_GRP_HDRFTR_BTN_FOOTER);
j("mnuItemEditFooter",w.RIBBON_TAB_INSERT_GRP_HDRFTR_FOOTER_MNU_ITM_EDIT_HEAD,w.RIBBON_TAB_INSERT_GRP_HDRFTR_FOOTER_MNU_ITM_EDIT_DESC);
j("mnuItemRemoveFooter",w.RIBBON_TAB_INSERT_GRP_HDRFTR_FOOTER_MNU_ITM_DEL_HEAD,w.RIBBON_TAB_INSERT_GRP_HDRFTR_FOOTER_MNU_ITM_DEL_DESC);
o("drpDnBtnInsertPageNum",w.RIBBON_TAB_INSERT_GRP_HDRFTR_BTN_PG_NUM);
j("mnuItemInsertPageNum",w.RIBBON_TAB_INSERT_GRP_HDRFTR_PG_NUM_MNU_ITM_INS_HEAD,w.RIBBON_TAB_INSERT_GRP_HDRFTR_PG_NUM_MNU_ITM_INS_DESC);
j("mnuItemPageNumRemove",w.RIBBON_TAB_INSERT_GRP_HDRFTR_PG_NUM_MNU_ITM_DEL_HEAD,w.RIBBON_TAB_INSERT_GRP_HDRFTR_PG_NUM_MNU_ITM_DEL_DESC);
q("ribbonGroupText",w.RIBBON_TAB_INSERT_GRP_TEXT_TITLE);
o("drpDnBtnInsertTextFrame",w.RIBBON_TAB_INSERT_GRP_TEXT_BTN_TEXT_FRAME);
j("mnuItemInsertTextFrame",w.RIBBON_TAB_INSERT_GRP_TEXT_TEXTFRAME_MNU_ITM_INS_HEAD,w.RIBBON_TAB_INSERT_GRP_TEXT_TEXTFRAME_MNU_ITM_INS_DESC);
j("mnuItemShowTextFrameMarkerLines",w.RIBBON_TAB_INSERT_GRP_TEXT_TEXTFRAME_MNU_ITM_SHOW_MRK_HEAD,w.RIBBON_TAB_INSERT_GRP_TEXT_TEXTFRAME_MNU_ITM_SHOW_MRK_DESC);
o("btnInsertFile",w.RIBBON_TAB_INSERT_GRP_TEXT_BTN_FILE);
q("ribbonGroupSymbols",w.RIBBON_TAB_INSERT_GRP_SYMB_TITLE);
o("drpDnBtnInsertSymbol",w.RIBBON_TAB_INSERT_GRP_SYMB_BTN_SYMBOL);
l("mnuItemMoreSymbols",w.RIBBON_TAB_INSERT_GRP_SYMB_MNU_ITM_MORE_SYMBOLS);
}function n(y){q("ribbonGroupPageSetup",y.RIBBON_TAB_PAGE_LAYOUT_GRP_SETUP_TITLE);
q("ribbonGroupColsAndBreaks",y.RIBBON_TAB_PAGE_LAYOUT_GRP_COLS_BREAKS_TITLE);
q("ribbonGroupPageBgAndFrames",y.RIBBON_TAB_PAGE_LAYOUT_GRP_PAGE_BG_FRAMES_TITLE);
o("btnPageSetup",y.RIBBON_TAB_PAGE_LAYOUT_GRP_SETUP_BTN_MRG);
o("drpDnBtnPageOrientation",y.RIBBON_TAB_PAGE_LAYOUT_GRP_SETUP_BTN_ORIENT);
j("mnuItemPortrait",y.RIBBON_TAB_PAGE_LAYOUT_GRP_SETUP_ORIENT_MNU_ITM_PORT_HEAD,y.RIBBON_TAB_PAGE_LAYOUT_GRP_SETUP_ORIENT_MNU_ITM_PORT_DESC);
j("mnuItemLandscape",y.RIBBON_TAB_PAGE_LAYOUT_GRP_SETUP_ORIENT_MNU_ITM_LANDSC_HEAD,y.RIBBON_TAB_PAGE_LAYOUT_GRP_SETUP_ORIENT_MNU_ITM_LANDSC_DESC);
o("drpDnBtnPageColumns",y.RIBBON_TAB_PAGE_LAYOUT_GRP_SETUP_BTN_COLS);
j("mnuItemOneColumn",y.RIBBON_TAB_PAGE_LAYOUT_GRP_SETUP_COLS_MNU_ITM_ONE_HEAD,y.RIBBON_TAB_PAGE_LAYOUT_GRP_SETUP_COLS_MNU_ITM_ONE_DESC);
j("mnuItemTwoColumns",y.RIBBON_TAB_PAGE_LAYOUT_GRP_SETUP_COLS_MNU_ITM_TWO_HEAD,y.RIBBON_TAB_PAGE_LAYOUT_GRP_SETUP_COLS_MNU_ITM_TWO_DESC);
j("mnuItemThreeColumns",y.RIBBON_TAB_PAGE_LAYOUT_GRP_SETUP_COLS_MNU_ITM_THREE_HEAD,y.RIBBON_TAB_PAGE_LAYOUT_GRP_SETUP_COLS_MNU_ITM_THREE_DESC);
j("mnuItemMoreColumns",y.RIBBON_TAB_PAGE_LAYOUT_GRP_SETUP_COLS_MNU_ITM_MORE_HEAD,y.RIBBON_TAB_PAGE_LAYOUT_GRP_SETUP_COLS_MNU_ITM_MORE_DESC);
o("drpDnBtnPageBreaks",y.RIBBON_TAB_PAGE_LAYOUT_GRP_SETUP_BTN_BREAKS);
m("mnuItemPageBreakPage",y.RIBBON_TAB_PAGE_LAYOUT_GRP_SETUP_BREAKS_MNU_HDR_PAGE_BREAKS);
l("mnuItemPageBreakPage",y.RIBBON_TAB_PAGE_LAYOUT_GRP_SETUP_BREAKS_MNU_ITM_PAGE);
l("mnuItemPageBreakColumn",y.RIBBON_TAB_PAGE_LAYOUT_GRP_SETUP_BREAKS_MNU_ITM_COL);
l("mnuItemPageBreakTextWrap",y.RIBBON_TAB_PAGE_LAYOUT_GRP_SETUP_BREAKS_MNU_ITM_TXT_WRAP);
m("mnuItemSectionBreakPage",y.RIBBON_TAB_PAGE_LAYOUT_GRP_SETUP_BREAKS_MNU_HDR_SECT_BREAKS);
l("mnuItemSectionBreakPage",y.RIBBON_TAB_PAGE_LAYOUT_GRP_SETUP_BREAKS_MNU_ITM_NEXT_PAGE);
l("mnuItemSectionBreakCont",y.RIBBON_TAB_PAGE_LAYOUT_GRP_SETUP_BREAKS_MNU_ITM_CONT);
o("drpDnBtnPageFrame",y.RIBBON_TAB_PAGE_LAYOUT_GRP_SETUP_BTN_PAGE_FRAME);
o("drpDnBtnPageBgColor",y.RIBBON_TAB_PAGE_LAYOUT_GRP_SETUP_BTN_PAGE_COLOR);
o("drpDnBtnPageFrameColor",y.RIBBON_TAB_PAGE_LAYOUT_GRP_SETUP_BTN_PAGE_FRAME_COLOR);
o("drpDnBtnPageFrameWidth",y.RIBBON_TAB_PAGE_LAYOUT_GRP_SETUP_BTN_PAGE_FRAME_WIDTH);
o("drpDnBtnPaperSize",y.RIBBON_TAB_PAGE_LAYOUT_GRP_SETUP_BTN_SIZE);
l("mnuItemPageFrameLineWidth_NoLine",y.RIBBON_TAB_PAGE_LAYOUT_MNU_ITM_NO_FRAME_LINE);
l("mnuItemPageFrameLineWidth_0_25",y.RIBBON_TAB_PAGE_LAYOUT_MNU_ITM_WEIGHT025);
l("mnuItemPageFrameLineWidth_0_5",y.RIBBON_TAB_PAGE_LAYOUT_MNU_ITM_WEIGHT050);
l("mnuItemPageFrameLineWidth_0_75",y.RIBBON_TAB_PAGE_LAYOUT_MNU_ITM_WEIGHT075);
l("mnuItemPageFrameLineWidth_1_0",y.RIBBON_TAB_PAGE_LAYOUT_MNU_ITM_WEIGHT100);
l("mnuItemPageFrameLineWidth_1_5",y.RIBBON_TAB_PAGE_LAYOUT_MNU_ITM_WEIGHT150);
l("mnuItemPageFrameLineWidth_2_25",y.RIBBON_TAB_PAGE_LAYOUT_MNU_ITM_WEIGHT225);
l("mnuItemPageFrameLineWidth_3_0",y.RIBBON_TAB_PAGE_LAYOUT_MNU_ITM_WEIGHT300);
l("mnuItemPageFrameLineWidth_4_5",y.RIBBON_TAB_PAGE_LAYOUT_MNU_ITM_WEIGHT450);
l("mnuItemPageFrameLineWidth_6_0",y.RIBBON_TAB_PAGE_LAYOUT_MNU_ITM_WEIGHT600);
l("mnuItemPageBgColorAutomatic",y.RIBBON_COLOR_MENU_ITEM_AUTOMATIC);
l("mnuItemPageBgMoreColors",y.RIBBON_COLOR_MENU_ITEM_MORE_COLORS);
l("mnuItemPageFrameColorAutomatic",y.RIBBON_COLOR_MENU_ITEM_AUTOMATIC);
l("mnuItemPageFrameMoreColors",y.RIBBON_COLOR_MENU_ITEM_MORE_COLORS);
l("mnuItemPageFrameLeft",y.RIBBON_TAB_PAGE_LAYOUT_MNU_ITM_FRAME_LEFT);
l("mnuItemPageFrameTop",y.RIBBON_TAB_PAGE_LAYOUT_MNU_ITM_FRAME_TOP);
l("mnuItemPageFrameRight",y.RIBBON_TAB_PAGE_LAYOUT_MNU_ITM_FRAME_RIGHT);
l("mnuItemPageFrameBottom",y.RIBBON_TAB_PAGE_LAYOUT_MNU_ITM_FRAME_BOTTOM);
l("mnuItemPageFrameAll",y.RIBBON_TAB_PAGE_LAYOUT_MNU_ITM_FRAME_ALL);
try{q("ribbonGroupParIndents",y.RIBBON_TAB_PAGE_LAYOUT_GRP_PAR_IND_TITLE);
var z=document.getElementById("tblRibbonGrpParInd");
z.rows[0].cells[0].innerHTML=y.RIBBON_TAB_PAGE_LAYOUT_GRP_PAR_IND_INDENT;
z.rows[0].cells[1].innerHTML=y.RIBBON_TAB_PAGE_LAYOUT_GRP_PAR_IND_SPACING;
var x=document.querySelectorAll("#tblRibbonGrpParInd label");
x[0].innerHTML=y.RIBBON_TAB_PAGE_LAYOUT_GRP_PAR_IND_LEFT;
x[1].innerHTML=y.RIBBON_TAB_PAGE_LAYOUT_GRP_PAR_IND_BEFORE;
x[2].innerHTML=y.RIBBON_TAB_PAGE_LAYOUT_GRP_PAR_IND_RIGHT;
x[3].innerHTML=y.RIBBON_TAB_PAGE_LAYOUT_GRP_PAR_IND_AFTER;
}catch(w){}}function k(w){q("ribbonGroupDataSource",w.RIBBON_TAB_REPORTS_GRP_DATA_SRC_TITLE);
o("btnLoadDBScheme",w.RIBBON_TAB_REPORTS_GRP_DATA_SRC_BTN_LOAD_DB);
o("drpDnBtnSelectMasterTable",w.RIBBON_TAB_REPORTS_GRP_DATA_SRC_BTN_SEL_MSTR_TBL);
o("btnEditDataRelations",w.RIBBON_TAB_REPORTS_GRP_DATA_SRC_BTN_EDIT_DATA_RELS);
q("ribbonGroupMergeField",w.RIBBON_TAB_REPORTS_GRP_MRG_FLD_TITLE);
o("drpDnBtnInsertMergeField",w.RIBBON_TAB_REPORTS_GRP_MRG_FLD_BTN_INS,w.RIBBON_TAB_REPORTS_GRP_MRG_FLD_BTN_INS_TOOLTIP);
j("mnuItemInsertMergeField",w.RIBBON_TAB_REPORTS_GRP_MRG_FLD_MNU_ITM_CUSTOM_HEAD,w.RIBBON_TAB_REPORTS_GRP_MRG_FLD_MNU_ITM_CUSTOM_DESC);
j("mnuItemHighlightMergeFields",w.RIBBON_TAB_REPORTS_GRP_MRG_FLD_MNU_ITM_HIGHLIGHT_HEAD,w.RIBBON_TAB_REPORTS_GRP_MRG_FLD_MNU_ITM_HIGHLIGHT_DESC);
o("drpDnBtnInsertSpecialField",w.RIBBON_TAB_REPORTS_GRP_MRG_FLD_BTN_INS_SPEC);
j("mnuItemInsertIFField",w.RIBBON_TAB_REPORTS_GRP_MRG_FLD_SPEC_MNU_ITM_IF_HEAD,w.RIBBON_TAB_REPORTS_GRP_MRG_FLD_SPEC_MNU_ITM_IF_DESC);
j("mnuItemInsertInclTxtField",w.RIBBON_TAB_REPORTS_GRP_MRG_FLD_SPEC_MNU_ITM_INCLTXT_HEAD,w.RIBBON_TAB_REPORTS_GRP_MRG_FLD_SPEC_MNU_ITM_INCLTXT_DESC);
j("mnuItemInsertDateField",w.RIBBON_TAB_REPORTS_GRP_MRG_FLD_SPEC_MNU_ITM_DATE_HEAD,w.RIBBON_TAB_REPORTS_GRP_MRG_FLD_SPEC_MNU_ITM_DATE_DESC);
j("mnuItemInsertNextField",w.RIBBON_TAB_REPORTS_GRP_MRG_FLD_SPEC_MNU_ITM_NEXT_HEAD,w.RIBBON_TAB_REPORTS_GRP_MRG_FLD_SPEC_MNU_ITM_NEXT_DESC);
j("mnuItemInsertNextIfField",w.RIBBON_TAB_REPORTS_GRP_MRG_FLD_SPEC_MNU_ITM_NEXTIF_HEAD,w.RIBBON_TAB_REPORTS_GRP_MRG_FLD_SPEC_MNU_ITM_NEXTIF_DESC);
o("btnFieldProperties",w.RIBBON_TAB_REPORTS_GRP_MRG_FLD_BTN_PROPS);
o("btnDeleteField",w.RIBBON_TAB_REPORTS_GRP_MRG_FLD_BTN_DEL);
q("ribbonGroupMergeBlock",w.RIBBON_TAB_REPORTS_GRP_MRG_BLOCK_TITLE);
o("drpDnBtnInsertMergeBlock",w.RIBBON_TAB_REPORTS_GRP_MRG_BLOCK_BTN_INS,w.RIBBON_TAB_REPORTS_GRP_MRG_BLOCK_BTN_INS_TOOLTIP);
j("mnuItemInsertMergeBlock",w.RIBBON_TAB_REPORTS_GRP_MRG_BLOCK_MNU_ITM_CUST_HEAD,w.RIBBON_TAB_REPORTS_GRP_MRG_BLOCK_MNU_ITM_CUST_DESC);
j("mnuItemHighlightMergeBlocks",w.RIBBON_TAB_REPORTS_GRP_MRG_BLOCK_MNU_ITM_HIGHLIGHT_HEAD,w.RIBBON_TAB_REPORTS_GRP_MRG_BLOCK_MNU_ITM_HIGHLIGHT_DESC);
o("btnEditMergeBlocks",w.RIBBON_TAB_REPORTS_GRP_MRG_BLOCK_BTN_EDIT);
q("ribbonGroupView",w.RIBBON_TAB_REPORTS_GRP_VIEW_TITLE);
o("tglBtnShowFieldCodes",w.RIBBON_TAB_REPORTS_GRP_VIEW_BTN_SHOW_CODES);
o("tglBtnShowFieldText",w.RIBBON_TAB_REPORTS_GRP_VIEW_BTN_SHOW_TEXT);
q("ribbonGroupMailMergeFinish",w.RIBBON_TAB_REPORTS_GRP_FINISH_TITLE);
o("btnPreviewMergeResults",w.RIBBON_TAB_REPORTS_GRP_FINISH_BTN_PREV);
o("btnFinishAndMerge",w.RIBBON_TAB_REPORTS_GRP_FINISH_BTN_FINISH);
q("ribbonGroupMailMergePreview",w.RIBBON_TAB_REPORTS_GRP_PREV_TITLE);
o("btnCloseReportingPreview",w.RIBBON_TAB_REPORTS_GRP_PREV_BTN_CLOSE);
q("ribbonGroupPreviewNav",w.RIBBON_TAB_REPORTS_GRP_NAV_TITLE);
o("btnFirstRecord",w.RIBBON_TAB_REPORTS_GRP_NAV_BTN_FIRST);
o("btnPrevRecord",w.RIBBON_TAB_REPORTS_GRP_NAV_BTN_PREV);
o("btnNextRecord",w.RIBBON_TAB_REPORTS_GRP_NAV_BTN_NEXT);
o("btnLastRecord",w.RIBBON_TAB_REPORTS_GRP_NAV_BTN_LAST);
}function u(w){q("ribbonGroupZoom",w.RIBBON_TAB_VIEW_GRP_ZOOM_TITLE);
o("drpDnBtnZoom",w.RIBBON_TAB_VIEW_GRP_ZOOM_BTN_ZOOM);
o("btnZoom100",w.RIBBON_TAB_VIEW_GRP_ZOOM_BTN_ZOOM_100);
o("btnZoomPageWidth",w.RIBBON_TAB_VIEW_GRP_ZOOM_BTN_ZOOM_PAGE_WIDTH);
o("btnZoomFullPage",w.RIBBON_TAB_VIEW_GRP_ZOOM_BTN_ZOOM_FULL_PAGE);
o("btnZoomTextWidth",w.RIBBON_TAB_VIEW_GRP_ZOOM_BTN_ZOOM_TEXT_WIDTH);
q("ribbonGroupToolbars",w.RIBBON_TAB_VIEW_GRP_TOOLBARS_TITLE);
i("chkRulerHor",w.RIBBON_TAB_VIEW_GRP_TOOLBARS_CHK_HOR_RULER);
i("chkRulerVert",w.RIBBON_TAB_VIEW_GRP_TOOLBARS_CHK_VERT_RULER);
i("chkStatusBar",w.RIBBON_TAB_VIEW_GRP_TOOLBARS_CHK_STATUSBAR);
q("ribbonGroupShow",w.RIBBON_TAB_VIEW_GRP_SHOW_TITLE);
o("btnViewTableGridlines",w.RIBBON_TAB_VIEW_GRP_SHOW_BTN_TABLE_GRIDLINES);
o("btnViewBookmarkMarkers",w.RIBBON_TAB_VIEW_GRP_SHOW_BTN_BOOKMARK_MARKERS);
o("btnViewTextframeMarkerLines",w.RIBBON_TAB_VIEW_GRP_SHOW_BTN_TEXTFRAME_MARKER_LINES);
o("btnViewDrawingMarkerLines",w.RIBBON_TAB_VIEW_GRP_SHOW_BTN_DRAWING_MARKER_LINES);
o("btnViewControlCharacters",w.RIBBON_TAB_VIEW_GRP_SHOW_BTN_CONTROL_CHARS);
o("btnViewFrameAnchors",w.RIBBON_TAB_VIEW_GRP_SHOW_BTN_FRAME_ANCHORS);
}function f(x){var w;
q("ribbonGroupFrameArrange",x.RIBBON_TAB_FRAME_FMT_GRP_ARR_TITLE);
o("drpDnBtnFrameWrapText",x.RIBBON_TAB_FRAME_FMT_GRP_ARR_BTN_WRAP_TEXT);
l("mnuItemFrameWrapInlineWithText",x.RIBBON_TAB_FRAME_FMT_GRP_ARR_WRAP_TXT_MNU_ITM_INLINE);
l("mnuItemFrameWrapTopAndBottom",x.RIBBON_TAB_FRAME_FMT_GRP_ARR_WRAP_TXT_MNU_ITM_TOP_BOT);
l("mnuItemFrameWrapSquare",x.RIBBON_TAB_FRAME_FMT_GRP_ARR_WRAP_TXT_MNU_ITM_SQUARE);
l("mnuItemFrameWrapBehindText",x.RIBBON_TAB_FRAME_FMT_GRP_ARR_WRAP_TXT_MNU_ITM_BEH_TXT);
l("mnuItemFrameWrapInFrontOfText",x.RIBBON_TAB_FRAME_FMT_GRP_ARR_WRAP_TXT_MNU_ITM_IN_FRONT);
l("mnuItemFrameWrapMoreOptions",x.RIBBON_TAB_FRAME_FMT_GRP_ARR_WRAP_TXT_MNU_ITM_MORE_OPTS);
o("drpDnBtnFrameBringToFront",x.RIBBON_TAB_FRAME_FMT_GRP_ARR_BTN_BRING_TO_FRONT);
l("mnuItemFrameBringToFront",x.RIBBON_TAB_FRAME_FMT_GRP_ARR_MNU_ITM_BRING_TO_FRONT);
l("mnuItemFrameBringForward",x.RIBBON_TAB_FRAME_FMT_GRP_ARR_MNU_ITM_BRING_FORWARD);
l("mnuItemFrameBringInFrontOfText",x.RIBBON_TAB_FRAME_FMT_GRP_ARR_MNU_ITM_BRING_IN_FRONT);
o("drpDnBtnFrameSendToBack",x.RIBBON_TAB_FRAME_FMT_GRP_ARR_BTN_SEND_TO_BACK);
l("mnuItemFrameSendToBack",x.RIBBON_TAB_FRAME_FMT_GRP_ARR_MNU_ITM_SEND_TO_BACK);
l("mnuItemFrameSendBackward",x.RIBBON_TAB_FRAME_FMT_GRP_ARR_MNU_ITM_SEND_BACKWARD);
l("mnuItemFrameSendBehindText",x.RIBBON_TAB_FRAME_FMT_GRP_ARR_MNU_ITM_SEND_BEHIND_TEXT);
o("drpDnBtnFramePosition",x.RIBBON_TAB_FRAME_FMT_GRP_ARR_BTN_POS);
l("mnuItemFramePosLeft",x.RIBBON_TAB_FRAME_FMT_GRP_ARR_MNU_ITM_POS_LEFT);
l("mnuItemFramePosCenter",x.RIBBON_TAB_FRAME_FMT_GRP_ARR_MNU_ITM_POS_CENTER);
l("mnuItemFramePosRight",x.RIBBON_TAB_FRAME_FMT_GRP_ARR_MNU_ITM_POS_RIGHT);
l("mnuItemFrameOtherPos",x.RIBBON_TAB_FRAME_FMT_GRP_ARR_MNU_ITM_POS_OTHER);
q("ribbonGroupFrameSize",x.RIBBON_TAB_FRAME_FMT_GRP_SIZE_TITLE);
w=document.querySelectorAll("#tblRibbonGrpFrameSize label");
w[0].innerHTML=x.RIBBON_TAB_FRAME_FMT_GRP_SIZE_LBL_HEIGHT;
w[1].innerHTML=x.RIBBON_TAB_FRAME_FMT_GRP_SIZE_LBL_WIDTH;
q("ribbonGroupFrameProps",x.RIBBON_TAB_FRAME_FMT_GRP_PROPS_TITLE);
w=document.querySelectorAll("#ribbonGroupFrameProps label");
w[0].innerHTML=x.RIBBON_TAB_FRAME_FMT_GRP_PROPS_LBL_NAME;
w[1].innerHTML=x.RIBBON_TAB_FRAME_FMT_GRP_PROPS_LBL_ID;
q("ribbonGroupShapesFramesAndBg",x.RIBBON_TAB_FRAME_FMT_GRP_FRAMES_AND_BG_TITLE);
o("drpDnBtnShapesFrameLineColor",x.RIBBON_TAB_FRAME_FMT_GRP_FRAMES_AND_BG_BTN_LINE_COLOR);
o("drpDnBtnShapesFrameBgColor",x.RIBBON_TAB_FRAME_FMT_GRP_FRAMES_AND_BG_BTN_BG_COLOR);
o("drpDnBtnShapesFrameLineWidth",x.RIBBON_TAB_FRAME_FMT_GRP_FRAMES_AND_BG_BTN_LINE_WIDTH);
o("drpDnBtnShapesTransparency",x.RIBBON_TAB_FRAME_FMT_GRP_FRAMES_AND_BG_BTN_TRANS);
o("drpDnBtnShapesRotate",x.RIBBON_TAB_FRAME_FMT_GRP_FRAMES_AND_BG_BTN_ROTATE);
l("mnuItemShapesRotateRight90",x.RIBBON_TAB_FRAME_FMT_MNU_ITM_ROT_R_90);
l("mnuItemShapesRotateLeft90",x.RIBBON_TAB_FRAME_FMT_MNU_ITM_ROT_L_90);
l("mnuItemShapesFlipHoriz",x.RIBBON_TAB_FRAME_FMT_MNU_ITM_FLIP_HORIZ);
l("mnuItemShapesFlipVert",x.RIBBON_TAB_FRAME_FMT_MNU_ITM_FLIP_VERT);
l("mnuItemShapesFrameLineColorAutomatic",x.RIBBON_COLOR_MENU_ITEM_AUTOMATIC);
l("mnuItemShapesFrameLineColorMoreColors",x.RIBBON_COLOR_MENU_ITEM_MORE_COLORS);
l("mnuItemShapesBgColorAutomatic",x.RIBBON_COLOR_MENU_ITEM_AUTOMATIC);
l("mnuItemShapesBgColorMoreColors",x.RIBBON_COLOR_MENU_ITEM_MORE_COLORS);
l("mnuItemShapesFrameLineWidth_NoLine",x.RIBBON_TAB_FRAME_FMT_MNU_ITM_NO_FRAME_LINE);
l("mnuItemShapesFrameLineWidth_0_25",x.RIBBON_TAB_FRAME_FMT_MNU_ITM_WEIGHT025);
l("mnuItemShapesFrameLineWidth_0_5",x.RIBBON_TAB_FRAME_FMT_MNU_ITM_WEIGHT050);
l("mnuItemShapesFrameLineWidth_0_75",x.RIBBON_TAB_FRAME_FMT_MNU_ITM_WEIGHT075);
l("mnuItemShapesFrameLineWidth_1_0",x.RIBBON_TAB_FRAME_FMT_MNU_ITM_WEIGHT100);
l("mnuItemShapesFrameLineWidth_1_5",x.RIBBON_TAB_FRAME_FMT_MNU_ITM_WEIGHT150);
l("mnuItemShapesFrameLineWidth_2_25",x.RIBBON_TAB_FRAME_FMT_MNU_ITM_WEIGHT225);
l("mnuItemShapesFrameLineWidth_3_0",x.RIBBON_TAB_FRAME_FMT_MNU_ITM_WEIGHT300);
l("mnuItemShapesFrameLineWidth_4_5",x.RIBBON_TAB_FRAME_FMT_MNU_ITM_WEIGHT450);
l("mnuItemShapesFrameLineWidth_6_0",x.RIBBON_TAB_FRAME_FMT_MNU_ITM_WEIGHT600);
q("ribbonGroupBarcodesColorsAndAlign",x.RIBBON_TAB_FRAME_FMT_GRP_COL_AND_ALIGN_TITLE);
o("drpDnBtnBarcodesFgColor",x.RIBBON_TAB_FRAME_FMT_GRP_COL_AND_ALIGN_BTN_FG_COLOR);
o("drpDnBtnBarcodesBgColor",x.RIBBON_TAB_FRAME_FMT_GRP_COL_AND_ALIGN_BTN_BG_COLOR);
o("drpDnBtnBarcodesTransparency",x.RIBBON_TAB_FRAME_FMT_GRP_COL_AND_ALIGN_BTN_TRANSP);
o("drpDnBtnBarcodesAlignHoriz",x.RIBBON_TAB_FRAME_FMT_GRP_COL_AND_ALIGN_BTN_ALIGN_HORIZ);
o("drpDnBtnBarcodesAlignVert",x.RIBBON_TAB_FRAME_FMT_GRP_COL_AND_ALIGN_BTN_ALIGN_VERT);
o("drpDnBtnBarcodesRotation",x.RIBBON_TAB_FRAME_FMT_GRP_COL_AND_ALIGN_BTN_ROTATION);
l("mnuItemBarcodeRotateRight90",x.RIBBON_TAB_FRAME_FMT_MNU_ITM_ROT_R_90);
l("mnuItemBarcodeRotateLeft90",x.RIBBON_TAB_FRAME_FMT_MNU_ITM_ROT_L_90);
l("mnuItemBarcodeRotate180",x.RIBBON_TAB_FRAME_FMT_MNU_ITM_ROT_180);
l("mnuItemBarcodeRotateOtherOpts",x.RIBBON_TAB_FRAME_FMT_MNU_ITM_MORE_ROT_OPTS);
l("mnuItemBarcodesFgColorAutomatic",x.RIBBON_COLOR_MENU_ITEM_AUTOMATIC);
l("mnuItemBarcodesFgColorMoreColors",x.RIBBON_COLOR_MENU_ITEM_MORE_COLORS);
l("mnuItemBarcodesBgColorAutomatic",x.RIBBON_COLOR_MENU_ITEM_AUTOMATIC);
l("mnuItemBarcodesBgColorMoreColors",x.RIBBON_COLOR_MENU_ITEM_MORE_COLORS);
l("mnuItemBarcodesAlignLeft",x.RIBBON_TAB_FRAME_FMT_GRP_COL_AND_ALIGN_MNU_ITM_ALIGN_LEFT);
l("mnuItemBarcodesAlignCenter",x.RIBBON_TAB_FRAME_FMT_GRP_COL_AND_ALIGN_MNU_ITM_ALIGN_CENTER);
l("mnuItemBarcodesAlignRight",x.RIBBON_TAB_FRAME_FMT_GRP_COL_AND_ALIGN_MNU_ITM_ALIGN_RIGHT);
l("mnuItemBarcodesAlignTop",x.RIBBON_TAB_FRAME_FMT_GRP_COL_AND_ALIGN_MNU_ITM_ALIGN_TOP);
l("mnuItemBarcodesAlignMiddle",x.RIBBON_TAB_FRAME_FMT_GRP_COL_AND_ALIGN_MNU_ITM_ALIGN_MIDDLE);
l("mnuItemBarcodesAlignBottom",x.RIBBON_TAB_FRAME_FMT_GRP_COL_AND_ALIGN_MNU_ITM_ALIGN_BOTTOM);
q("ribbonGroupTextFramesFramesAndBg",x.RIBBON_TAB_FRAME_FMT_GRP_FRAMES_AND_BG_TITLE);
o("drpDnBtnTextFrameBgColor",x.RIBBON_TAB_FRAME_FMT_GRP_FRAMES_AND_BG_TXT_FRM_BTN_BG_COL);
o("drpDnBtnTextFrameTransp",x.RIBBON_TAB_FRAME_FMT_GRP_FRAMES_AND_BG_TXT_FRM_BTN_TRANSP);
o("drpDnBtnTextFrameLineWidth",x.RIBBON_TAB_FRAME_FMT_GRP_FRAMES_AND_BG_TXT_FRM_BTN_LINE_WIDTH);
l("mnuItemTextFramesBgColorAutomatic",x.RIBBON_COLOR_MENU_ITEM_AUTOMATIC);
l("mnuItemTextFramesBgColorMoreColors",x.RIBBON_COLOR_MENU_ITEM_MORE_COLORS);
l("mnuItemTextFramesFrameLineWidth_NoLine",x.RIBBON_TAB_FRAME_FMT_MNU_ITM_NO_FRAME_LINE);
l("mnuItemTextFramesFrameLineWidth_0_25",x.RIBBON_TAB_FRAME_FMT_MNU_ITM_WEIGHT025);
l("mnuItemTextFramesFrameLineWidth_0_5",x.RIBBON_TAB_FRAME_FMT_MNU_ITM_WEIGHT050);
l("mnuItemTextFramesFrameLineWidth_0_75",x.RIBBON_TAB_FRAME_FMT_MNU_ITM_WEIGHT075);
l("mnuItemTextFramesFrameLineWidth_1_0",x.RIBBON_TAB_FRAME_FMT_MNU_ITM_WEIGHT100);
l("mnuItemTextFramesFrameLineWidth_1_5",x.RIBBON_TAB_FRAME_FMT_MNU_ITM_WEIGHT150);
l("mnuItemTextFramesFrameLineWidth_2_25",x.RIBBON_TAB_FRAME_FMT_MNU_ITM_WEIGHT225);
l("mnuItemTextFramesFrameLineWidth_3_0",x.RIBBON_TAB_FRAME_FMT_MNU_ITM_WEIGHT300);
l("mnuItemTextFramesFrameLineWidth_4_5",x.RIBBON_TAB_FRAME_FMT_MNU_ITM_WEIGHT450);
l("mnuItemTextFramesFrameLineWidth_6_0",x.RIBBON_TAB_FRAME_FMT_MNU_ITM_WEIGHT600);
}function t(w){q("ribbonGroupTblLayoutTable",w.RIBBON_TAB_TBL_LAYOUT_GRP_TABLE_TITLE);
o("drpDnBtnTableSelect",w.RIBBON_TAB_TBL_LAYOUT_GRP_TABLE_BTN_SEL);
j("mnuItemSelectTableCell",w.RIBBON_TAB_TBL_LAYOUT_GRP_TABLE_SEL_MNU_ITM_CELL_HEAD,w.RIBBON_TAB_TBL_LAYOUT_GRP_TABLE_SEL_MNU_ITM_CELL_DESC);
j("mnuItemSelectTableColumn",w.RIBBON_TAB_TBL_LAYOUT_GRP_TABLE_SEL_MNU_ITM_COL_HEAD,w.RIBBON_TAB_TBL_LAYOUT_GRP_TABLE_SEL_MNU_ITM_COL_DESC);
j("mnuItemSelectTableRow",w.RIBBON_TAB_TBL_LAYOUT_GRP_TABLE_SEL_MNU_ITM_ROW_HEAD,w.RIBBON_TAB_TBL_LAYOUT_GRP_TABLE_SEL_MNU_ITM_ROW_DESC);
j("mnuItemSelectTable",w.RIBBON_TAB_TBL_LAYOUT_GRP_TABLE_SEL_MNU_ITM_TABLE_HEAD,w.RIBBON_TAB_TBL_LAYOUT_GRP_TABLE_SEL_MNU_ITM_TABLE_DESC);
o("tglBtnViewGridLines",w.RIBBON_TAB_TBL_LAYOUT_GRP_TABLE_BTN_VIEW_GRIDLINES);
o("btnTableProperties",w.RIBBON_TAB_TBL_LAYOUT_GRP_TABLE_BTN_PROPS);
q("ribbonGroupTblLayoutRowsCols",w.RIBBON_TAB_TBL_LAYOUT_GRP_ROWCOL_TITLE);
o("drpDnBtnTableDelete",w.RIBBON_TAB_TBL_LAYOUT_GRP_ROWCOL_BTN_DEL);
j("mnuItemDeleteTableCells",w.RIBBON_TAB_TBL_LAYOUT_GRP_ROWCOL_DEL_MNU_ITM_CELLS_HEAD,w.RIBBON_TAB_TBL_LAYOUT_GRP_ROWCOL_DEL_MNU_ITM_CELLS_DESC);
s("mnuItemMoveCellsToLeft",w.RIBBON_TAB_TBL_LAYOUT_GRP_ROWCOL_DEL_CELL_MNU_ITM_MOVE_LEFT);
s("mnuItemDeleteWholeRow",w.RIBBON_TAB_TBL_LAYOUT_GRP_ROWCOL_DEL_CELL_MNU_ITM_DEL_ROW);
s("mnuItemDeleteWholeColumn",w.RIBBON_TAB_TBL_LAYOUT_GRP_ROWCOL_DEL_CELL_MNU_ITM_DEL_COL);
j("mnuItemDeleteTableColumns",w.RIBBON_TAB_TBL_LAYOUT_GRP_ROWCOL_DEL_MNU_ITM_COLS_HEAD,w.RIBBON_TAB_TBL_LAYOUT_GRP_ROWCOL_DEL_MNU_ITM_COLS_DESC);
j("mnuItemDeleteTableRows",w.RIBBON_TAB_TBL_LAYOUT_GRP_ROWCOL_DEL_MNU_ITM_ROWS_HEAD,w.RIBBON_TAB_TBL_LAYOUT_GRP_ROWCOL_DEL_MNU_ITM_ROWS_DESC);
j("mnuItemDeleteTable",w.RIBBON_TAB_TBL_LAYOUT_GRP_ROWCOL_DEL_MNU_ITM_TABLE_HEAD,w.RIBBON_TAB_TBL_LAYOUT_GRP_ROWCOL_DEL_MNU_ITM_TABLE_DESC);
o("btnInsTblRowAbove",w.RIBBON_TAB_TBL_LAYOUT_GRP_ROWCOL_BTN_INS_ABOVE);
o("btnInsTblRowBelow",w.RIBBON_TAB_TBL_LAYOUT_GRP_ROWCOL_BTN_INS_BELOW);
o("btnInsTblColLeft",w.RIBBON_TAB_TBL_LAYOUT_GRP_ROWCOL_BTN_INS_LEFT);
o("btnInsTblColRight",w.RIBBON_TAB_TBL_LAYOUT_GRP_ROWCOL_BTN_INS_RIGHT);
q("ribbonGroupTblLayoutMerge",w.RIBBON_TAB_TBL_LAYOUT_GRP_MERGE_TITLE);
o("btnMergeCells",w.RIBBON_TAB_TBL_LAYOUT_GRP_MERGE_BTN_MERGE_CELLS);
o("btnSplitCells",w.RIBBON_TAB_TBL_LAYOUT_GRP_MERGE_BTN_SPLIT_CELLS);
o("drpDnBtnSplitTable",w.RIBBON_TAB_TBL_LAYOUT_GRP_MERGE_BTN_SPLIT_TBL);
j("mnuItemTableSplitAbove",w.RIBBON_TAB_TBL_LAYOUT_GRP_MERGE_SPLIT_TABLE_MNU_ITM_ABOVE_HEAD,w.RIBBON_TAB_TBL_LAYOUT_GRP_MERGE_SPLIT_TABLE_MNU_ITM_ABOVE_DESC);
j("mnuItemTableSplitBelow",w.RIBBON_TAB_TBL_LAYOUT_GRP_MERGE_SPLIT_TABLE_MNU_ITM_BELOW_HEAD,w.RIBBON_TAB_TBL_LAYOUT_GRP_MERGE_SPLIT_TABLE_MNU_ITM_BELOW_DESC);
q("ribbonGroupTblFramesAndBg",w.RIBBON_TAB_TBL_LAYOUT_GRP_FRAMES_TITLE);
o("drpDnBtnTableFrames",w.RIBBON_TAB_TBL_LAYOUT_GRP_FRAMES_BTN_FRAMES);
o("drpDnBtnTblLineColor",w.RIBBON_TAB_TBL_LAYOUT_GRP_FRAMES_BTN_LINE_COLOR);
o("drpDnBtnTblBgColor",w.RIBBON_TAB_TBL_LAYOUT_GRP_FRAMES_BTN_BG_COLOR);
o("drpDnBtnTblLineWidth",w.RIBBON_TAB_TBL_LAYOUT_GRP_FRAMES_BTN_LINE_WIDTH);
l("mnuItemTblFrameLeft",w.RIBBON_TAB_HOME_GRP_PARA_BORDERS_MNU_ITM_LEFT);
l("mnuItemTblFrameTop",w.RIBBON_TAB_HOME_GRP_PARA_BORDERS_MNU_ITM_TOP);
l("mnuItemTblFrameRight",w.RIBBON_TAB_HOME_GRP_PARA_BORDERS_MNU_ITM_RIGHT);
l("mnuItemTblFrameBottom",w.RIBBON_TAB_HOME_GRP_PARA_BORDERS_MNU_ITM_BOT);
l("mnuItemTblFrameOutside",w.RIBBON_TAB_HOME_GRP_PARA_BORDERS_MNU_ITM_OUTSIDE);
l("mnuItemTblFrameAll",w.RIBBON_TAB_HOME_GRP_PARA_BORDERS_MNU_ITM_ALL);
l("mnuItemTblFrameInsideHor",w.RIBBON_TAB_HOME_GRP_PARA_BORDERS_MNU_ITM_INS_HOR);
l("mnuItemTblFrameInsideVert",w.RIBBON_TAB_HOME_GRP_PARA_BORDERS_MNU_ITM_INS_VERT);
l("mnuItemTblFrameColorAutomatic",w.RIBBON_COLOR_MENU_ITEM_AUTOMATIC);
l("mnuItemTblFrameMoreColors",w.RIBBON_COLOR_MENU_ITEM_MORE_COLORS);
l("mnuItemTblFrameFillColorAutomatic",w.RIBBON_COLOR_MENU_ITEM_AUTOMATIC);
l("mnuItemTblFrameFillMoreColors",w.RIBBON_COLOR_MENU_ITEM_MORE_COLORS);
l("mnuItemTblFrameLineWidth_0_25",w.RIBBON_TAB_HOME_GRP_PARA_LINE_WIDTH_MNU_ITM_0_25);
l("mnuItemTblFrameLineWidth_0_5",w.RIBBON_TAB_HOME_GRP_PARA_LINE_WIDTH_MNU_ITM_0_5);
l("mnuItemTblFrameLineWidth_0_75",w.RIBBON_TAB_HOME_GRP_PARA_LINE_WIDTH_MNU_ITM_0_75);
l("mnuItemTblFrameLineWidth_1_0",w.RIBBON_TAB_HOME_GRP_PARA_LINE_WIDTH_MNU_ITM_1_0);
l("mnuItemTblFrameLineWidth_1_5",w.RIBBON_TAB_HOME_GRP_PARA_LINE_WIDTH_MNU_ITM_1_5);
l("mnuItemTblFrameLineWidth_2_25",w.RIBBON_TAB_HOME_GRP_PARA_LINE_WIDTH_MNU_ITM_2_25);
l("mnuItemTblFrameLineWidth_3_0",w.RIBBON_TAB_HOME_GRP_PARA_LINE_WIDTH_MNU_ITM_3_0);
l("mnuItemTblFrameLineWidth_4_5",w.RIBBON_TAB_HOME_GRP_PARA_LINE_WIDTH_MNU_ITM_4_5);
l("mnuItemTblFrameLineWidth_6_0",w.RIBBON_TAB_HOME_GRP_PARA_LINE_WIDTH_MNU_ITM_6_0);
q("ribbonGroupTblLayoutAlignment",w.RIBBON_TAB_TBL_LAYOUT_GRP_ALIGN_TITLE);
p("tglBtnCellAlignTopLeft",w.RIBBON_TAB_TBL_LAYOUT_GRP_ALIGN_BTN_TOP_LEFT);
p("tglBtnCellAlignTopCenter",w.RIBBON_TAB_TBL_LAYOUT_GRP_ALIGN_BTN_TOP_CENTER);
p("tglBtnCellAlignTopRight",w.RIBBON_TAB_TBL_LAYOUT_GRP_ALIGN_BTN_TOP_RIGHT);
p("tglBtnCellAlignTopJustify",w.RIBBON_TAB_TBL_LAYOUT_GRP_ALIGN_BTN_TOP_JUST);
p("tglBtnCellAlignMiddleLeft",w.RIBBON_TAB_TBL_LAYOUT_GRP_ALIGN_BTN_MID_LEFT);
p("tglBtnCellAlignMiddleCenter",w.RIBBON_TAB_TBL_LAYOUT_GRP_ALIGN_BTN_MID_CENTER);
p("tglBtnCellAlignMiddleRight",w.RIBBON_TAB_TBL_LAYOUT_GRP_ALIGN_BTN_MID_RIGHT);
p("tglBtnCellAlignMiddleJustify",w.RIBBON_TAB_TBL_LAYOUT_GRP_ALIGN_BTN_MID_JUST);
p("tglBtnCellAlignBottomLeft",w.RIBBON_TAB_TBL_LAYOUT_GRP_ALIGN_BTN_BOT_LEFT);
p("tglBtnCellAlignBottomCenter",w.RIBBON_TAB_TBL_LAYOUT_GRP_ALIGN_BTN_BOT_CENTER);
p("tglBtnCellAlignBottomRight",w.RIBBON_TAB_TBL_LAYOUT_GRP_ALIGN_BTN_BOT_RIGHT);
p("tglBtnCellAlignBottomJustify",w.RIBBON_TAB_TBL_LAYOUT_GRP_ALIGN_BTN_BOT_JUST);
}return v;
}(TXTextControl||{},j$1_10_2));
var TXTextControl=(function(ac,a){var c=ac._private=ac._private||{};
var b=null;
c.ApplicationMode=Object.freeze({Normal:0,MailMergePreview:1,});
var R=Object.freeze({Disabled:0,Enabled:1,});
c.EditMode=Object.freeze({Edit:1,ReadAndSelect:2,ReadOnly:3,UsePassword:2048});
c.MenuType=Object.freeze({InsertShapes:1,InsertChart:2});
c.RibbonGroupElementType={};
c.RibbonControlType={};
c.RibbonMenuItemSize={};
c.RibbonButtonSize={};
c.RibbonMenuEventType={};
c.RibbonButtonSize={};
c.RibbonButtonEventType={};
c.RibbonControlStateType={};
c.RibbonButtonStateType={};
c.RibbonMenuItemBorder={};
c.RibbonMenuItemStateType={};
c.RibbonTextBoxEventType={};
c.RibbonTextBoxStateType={};
c.CheckedListBoxEventType={};
c.CheckedListItemStateType={};
c.CheckedListBoxStateType={};
c.jQueryMenus={};
var e="";
c.appMode=c.ApplicationMode.Normal;
var f=0;
var d=null;
c.isRibbonVisible=true;
c.isRibbonBarRemoved=false;
c.ribbonTabsLoaded=false;
c.editModeCur=c.EditMode.Edit;
c.ribbonBtnStateMsgBuf=[];
var g="";
function N(){var af=function(){c.sendCommand(c.Command.NewFile);
c.switchTabs(a("#tabDefault"));
a("#fileMnuItemSave").addClass("txui-state-disabled");
};
if(c.documentDirty){c.fileSaveQuestion(af);
}else{af();
}}c.initRibbon=function(){c.fileMenu=a("#fileMenu").menu().hide();
a("#fileMenu").on("menuselect",O);
a("ul.tabs a").click(function(){return P(a(this));
});
c.switchTabs(a("#tabDefault"));
a("#tabTableLayout").hide();
a("#tabFrameFormatting").hide();
a("#tabObjectFormat").hide();
c.adaptRibbonTabWidths();
document.addEventListener("appModeChanged",C);
document.addEventListener("ribbonButtonStateMessageReceived",S);
document.addEventListener("waitDialogMessageReceived",ae);
a("#txTemplateDesignerContainer .txRibbonScrollArrow").click(Q);
a("#txTemplateDesignerContainer .txTriangle").click(Q);
a("#txBtnRibbonHide").click(V);
L();
};
function O(af,ag){switch(ag.item.context.id){case"fileMnuItemOpen":c.openFile();
break;
case"fileMnuItemSave":W();
break;
case"fileMnuItemSaveAs":X();
break;
case"fileMnuItemNew":N();
break;
case"fileMnuItemPrintToPDF":c.print();
break;
case"fileMnuItemOptions":ab();
break;
}}c.openFile=function(ag){ag=ag||c.FileType.Document;
var af=function(){var ah=new c.OpenFileDialog(c.Command.OpenFile,ag);
ah.showModal();
};
if((ag==c.FileType.Document)&&c.documentDirty){c.fileSaveQuestion(af);
}else{af();
}};
function W(){c.sendCommand(c.Command.Save);
}function X(){c.sendCommand(c.Command.ShowDialog,c.DialogCategory.HTMLDialog,c.HTMLDialogType.SaveDocumentAsDialog);
}function P(af){if(af.attr("id")=="tabFile"){aa(af);
return false;
}else{c.switchTabs(af);
}}function aa(ag){c.hideAllOtherMenus();
var af=document.getElementById("fileMenu");
c.calcMenuWidths(af);
c.fileMenu.show().position({my:"left top",at:"left bottom",of:ag});
a(document).one("click",function(){c.fileMenu.hide();
});
}function ab(){c.sendCommand(c.Command.ShowDialog,c.DialogCategory.HTMLDialog,c.HTMLDialogType.OptionsDialog);
}function H(ag){var af=document.getElementById("txRibbonTabContentContainer");
if(af.clientWidth>32){return af.clientWidth;
}return 0;
}c.updateRibbonTabContentOffset=function(){var ag=H(e);
if((f<0)&&(ag+f)<c.clientSize.Width){var af=document.getElementById("txRibbonTabContentContainer");
var ah=Math.min(0,(c.clientSize.Width-ag));
c.setVendor(af,"transform","translate("+ah+"px, 0px)");
f=ah;
}};
c.updateRibbonScrollArrows=function(){var al=H(e);
var ah=document.getElementById("txRibbonScrollButtonRight");
var af=document.getElementById("txRibbonScrollButtonLeft");
var ak=ah.clientWidth;
var ag=c.clientSize.Width-ak;
ah.style.left=ag+"px";
var ai=(f<0);
var aj=(c.clientSize.Width<(al+f));
af.style.opacity=ai?"":0;
ah.style.opacity=aj?"":0;
};
c.updateRibbonHideButtonPos=function(){var af=document.getElementById("txBtnRibbonHide");
var ah=af.clientWidth;
var ag=c.clientSize.Width-ah-5;
af.style.left=ag+"px";
};
c.adaptRibbonTabWidths=function(ah){var aj,ao,ap=document.querySelectorAll("div#ribbonbar > ul.tabs > li > a"),ai=22,af,ak,al,ag,am;
ah=ah||document.getElementById("txTemplateDesignerContainer").parentElement;
ap=[].filter.call(ap,function(ar){return ar.style.display!=="none";
});
ap.sort(function(ar,at){return ar.offsetLeft-at.offsetLeft;
});
ag=c.clientSize.Width-ai;
am=ap[ap.length-1];
aq();
if(al>ag){for(aj=ap.length-1;
aj>=0;
--aj){ao=ap[aj];
aq();
if(al>ag){an();
}else{break;
}}}else{for(aj=0;
aj<ap.length;
++aj){ao=ap[aj];
if(!ao.dataset.wasShrunk){continue;
}aq();
if(al<ag){ao.textContent=ao.dataset.text;
aq();
if(al>ag){an();
break;
}delete (ao.dataset.wasShrunk);
ao.title="";
}}}function an(){if(!ao.dataset.text){return;
}ao.textContent=ao.dataset.text.substring(0,1)+"…";
ao.title=ao.dataset.text;
ao.dataset.wasShrunk=true;
}function aq(){af=am.getBoundingClientRect();
ak=af.left-ah.offsetLeft;
al=ak+af.width;
}};
c.setVendor=function(ag,ah,ai){var af=ah.charAt(0).toUpperCase()+ah.substring(1);
ag.style[ah]=ai;
ag.style["webkit"+af]=ai;
ag.style["Moz"+af]=ai;
ag.style["ms"+af]=ai;
ag.style["o"+af]=ai;
};
c.resetRibbonTabContentPos=function(){f=0;
var af=document.getElementById("txRibbonTabContentContainer");
c.setVendor(af,"transform",null);
c.updateRibbonScrollArrows();
};
function Z(ah){var ag,af=null;
switch(ah){case"ribbonTabTableLayout":ag=document.getElementById("tabTableLayout");
if(ag){af=window.getComputedStyle(ag,null).color;
}break;
case"ribbonTabFrameFormatting":ag=document.getElementById("tabFrameFormatting");
if(ag){af=window.getComputedStyle(ag,null).color;
}break;
case"ribbonTabChartFormatting":ag=document.getElementById("tabChartFormatting");
if(ag){af=window.getComputedStyle(ag,null).color;
}break;
}ag=document.querySelector("#txRibbonContentArea");
ag.style.borderTop=(af!==null)?"1px solid "+af:"";
}c.RibbonTabIndexChangedEventArgs=(function(){function af(name){this.name=name;
}return af;
})();
c.switchTabs=function(ah){c.showRibbonBar(true);
a("#txRibbonTabContentContainer div.tab-content").css("display","none");
a("#ribbonbar ul.tabs a").removeClass("selected");
var ag=ah.attr("rel");
a("#"+ag).css("display","inline-block");
ah.addClass("selected");
Z(ag);
e=ag;
c.resetRibbonTabContentPos();
c.setDlgLauncherPos();
var ai=ah.attr("id");
if(ai!==g){var af=new c.RibbonTabIndexChangedEventArgs(ai);
c.fireEvent(c.EventName.ribbonTabIndexChanged,af);
g=ai;
}};
function F(){a("div.ribbon-dropdown-button-tiny").each(function(){var af=document.createElement("p");
af.textContent="▼";
a(this).append(af);
});
}function K(af){return(af.offsetParent===null);
}c.setDlgLauncherPos=function(){var ag=document.querySelectorAll("div.ribbon-group img.txDialogLauncher");
for(var ai=0;
ai<ag.length;
++ai){var af=ag[ai];
var ah=af.previousElementSibling;
if(!K(af)&&!af.style.marginLeft){var aj=parseInt(getComputedStyle(af.parentElement).paddingLeft,10);
var al=af.parentElement.clientWidth;
af.style.marginLeft=al-af.clientWidth-aj-1+"px";
var ak=c.isTouchDevice?(-1):1;
af.style.marginTop=-(c.ribbonBarHeight-ah.offsetTop)+ak+"px";
af.style.opacity="";
}}};
function E(af){switch(af.target.id){case"btnDlgLnchFontGrp":c.sendCommand(c.Command.ShowDialog,c.DialogCategory.TXDialog,c.TXDialogType.FontDialog);
break;
case"btnDlgLnchParGrp":c.sendCommand(c.Command.ShowDialog,c.DialogCategory.TXDialog,c.TXDialogType.ParagraphFormatDialog);
break;
case"btnDlgLnchPgSetupGrp":c.sendCommand(c.Command.ShowDialog,c.DialogCategory.TXDialog,c.TXDialogType.SectionFormatDialog,c.SectionFormatDialogTab.MarginsAndPaper);
break;
case"btnDlgLnchParIndGrp":c.sendCommand(c.Command.ShowDialog,c.DialogCategory.TXDialog,c.TXDialogType.ParagraphFormatDialog);
break;
case"btnDlgLnchColBreaksGrp":c.sendCommand(c.Command.ShowDialog,c.DialogCategory.TXDialog,c.TXDialogType.SectionFormatDialog,c.SectionFormatDialogTab.Columns);
break;
case"btnDlgLnchPageBgFramesGrp":c.sendCommand(c.Command.ShowDialog,c.DialogCategory.TXDialog,c.TXDialogType.SectionFormatDialog,c.SectionFormatDialogTab.Borders);
break;
case"btnDlgLnchTblFrmsAndBgGrp":c.sendCommand(c.Command.ShowDialog,c.DialogCategory.TXDialog,c.TXDialogType.TableFormatDialog,c.TableFormatDialogTab.FrameAndColor);
break;
case"btnDlgLnchTblAlignGrp":c.sendCommand(c.Command.ShowDialog,c.DialogCategory.TXDialog,c.TXDialogType.TableFormatDialog,c.TableFormatDialogTab.SizeAndFormatting);
break;
case"btnDlgLnchFrameArrangeGrp":c.sendCommand(c.Command.ShowDialog,c.DialogCategory.TXDialog,c.TXDialogType.ObjectAttributesDialog);
break;
case"btnDlgLnchFrameSizeGrp":c.sendCommand(c.Command.ShowDialog,c.DialogCategory.TXDialog,c.TXDialogType.ObjectAttributesDialog,1);
break;
case"btnDlgLnchFramesAndBgGrp":case"btnDlgLnchFramesAndBgGrpTextFrames":case"btnDlgLnchColsAndAlignGrp":c.sendCommand(c.Command.ShowDialog,c.DialogCategory.TXDialog,c.TXDialogType.ObjectAttributesDialog,2);
break;
}}function J(){c.setDlgLauncherPos();
var ag=document.querySelectorAll("div.ribbon-group img.txDialogLauncher");
for(var af=0;
af<ag.length;
++af){ag[af].addEventListener("click",E);
}}function h(){if(c.isTouchDevice){var ag=document.getElementById("localClipboardButtonContainer");
ag.parentElement.removeChild(ag);
var af=document.getElementById("clipboardFormatDropDown");
af.parentElement.removeChild(af);
}else{var ah=document.getElementById("pasteDropDown");
if(ah){ah.parentElement.removeChild(ah);
}}}function L(){var ag=c.getTXFileDir();
var af={home:ag+"Ribbon/RibbonTabHome.html",insert:ag+"Ribbon/RibbonTabInsert.html",pageLayout:ag+"Ribbon/RibbonTabPageLayout.html",reporting:ag+"Ribbon/RibbonTabReports.html",view:ag+"Ribbon/RibbonTabView.html",proofing:ag+"Ribbon/RibbonTabProofing.html",tableLayout:ag+"Ribbon/RibbonTabTableLayout.html",frameFormat:ag+"Ribbon/RibbonTabFrameFormatting.html",};
a("#ribbonTabHome").load(af.home,function(){h();
c.attachHomeTabEventHandlers();
a("#ribbonTabInsert").load(af.insert,function(){c.generateDynamicInsertTabContent();
c.attachInsertTabEventHandlers();
a("#ribbonTabPageLayout").load(af.pageLayout,function(){c.attachPageLayoutTabEventHandlers();
a("#ribbonTabReports").load(af.reporting,function(){c.attachMailingsTabEventHandlers();
a("#ribbonTabView").load(af.view,function(){c.attachViewTabEventHandlers();
a("#ribbonTabFrameFormatting").load(af.frameFormat,function(){c.attachFrameFormatTabEventHandlers();
a("#ribbonTabTableLayout").load(af.tableLayout,function(){c.attachTableLayoutTabEventHandlers();
c.changeImageSources();
F();
setTimeout(J,2000);
A();
c.setRibbonStrings();
y();
c.sendCommand(c.Command.RibbonTabsLoaded);
Y();
c.populatePaperSizeMenu();
});
});
});
});
});
});
});
}c.areRibbonIconsLoaded=false;
function Y(){var am=10000;
var ak=200;
var al=0;
var aj=document.querySelector("#drpDnBtnTextHighlightColor > img");
var ai=document.querySelector("#drpDnBtnTextColor > img");
var ag=document.querySelector("#drpDnBtnBackColor > img");
var ah=document.querySelector("#drpDnBtnFrameColor > img");
setTimeout(function af(){if(aj.complete&&ai.complete&&ag.complete&&ah.complete){c.sendCommand(c.Command.RibbonIconsLoaded);
c.areRibbonIconsLoaded=true;
}else{if(al<am){setTimeout(af,ak);
al+=ak;
}else{c.sendCommand(c.Command.RibbonIconsLoaded);
c.areRibbonIconsLoaded=true;
}}},ak);
}function A(){c.applyShapesMenuContent();
c.applyChartMenuContent();
}function C(af){c.setAppMode(af.detail.appMode);
}c.setEditMode=function(af){c.editModeCur=af;
};
function B(ag){var af=ag.buttonNames,ah=ag.buttonState;
af.forEach(function(ai){var aj=document.querySelectorAll("#"+ai);
[].forEach.call(aj,function(ak){switch(ah){case R.Disabled:switch(ak.tagName){case"INPUT":case"SELECT":ak.disabled=true;
break;
case"IMG":if(ak.classList.contains("txDialogLauncher")){c.disableDialogLauncher(ak);
break;
}default:ak.style.display="";
ak.classList.add("txui-state-disabled");
break;
}break;
case R.Enabled:switch(ak.tagName){case"INPUT":case"SELECT":ak.disabled=false;
break;
case"IMG":if(ak.classList.contains("txDialogLauncher")){c.disableDialogLauncher(ak,false);
break;
}default:ak.style.display="";
ak.classList.remove("txui-state-disabled");
break;
}break;
}});
});
}function S(af){var ag=af.detail;
if(!c.ribbonTabsLoaded){c.ribbonBtnStateMsgBuf.push(ag);
return;
}B(ag);
}function z(){c.ribbonBtnStateMsgBuf.forEach(function(af){B(af);
});
c.ribbonBtnStateMsgBuf=[];
}function ae(af){var ah=af.detail;
var ai=ah.show,aj=ah.title,ag=ah.message;
if(ai&&!b){b=new c.WaitDialog(aj,ag);
b.showModal();
}else{if(!ai&&b){b.close(a("#waitDialog"));
b=null;
}}}function U(aj){if(aj.style.opacity!==""){return;
}var af=document.getElementById("txRibbonTabContentContainer");
var ag=af.clientWidth;
var ai=(ag+f)-c.clientSize.Width;
var ah=-Math.min(ai,c.clientSize.Width);
c.setVendor(af,"transform","translate("+(f+ah)+"px, 0px)");
f+=ah;
c.updateRibbonScrollArrows();
}function T(ai){if(ai.style.opacity!==""){return;
}var af=document.getElementById("txRibbonTabContentContainer");
var ah=-f;
var ag=Math.min(ah,c.clientSize.Width);
c.setVendor(af,"transform","translate("+(f+ag)+"px, 0px)");
f+=ag;
c.updateRibbonScrollArrows();
}function Q(af){switch(af.target.id){case"txRibbonScrollButtonRight":U(af.target);
break;
case"txBlackTriangleR":if(af.target.parentElement.id=="txRibbonScrollButtonRight"){U(af.target.parentElement);
}break;
case"txRibbonScrollButtonLeft":T(af.target);
break;
case"txBlackTriangleL":if(af.target.parentElement.id=="txRibbonScrollButtonLeft"){T(af.target.parentElement);
}break;
}}function V(af){if(c.isRibbonVisible){c.showRibbonBar(false);
}else{c.showRibbonBar(true);
}}c.setAppMode=function(af){c.appMode=af;
var ah=a("*[data-applicationmodes]");
ah.each(function(){var ai=a(this),ak=ai.attr("data-tab-type"),aj=ai.attr("data-applicationmodes").split(/[\s,]+/);
if(aj.some(function(al){return(parseInt(al,10)==af);
})&&(ak!=="contextual")){ai.show();
}else{ai.hide();
}});
var ag=document.getElementById("btnCloseReportingPreview");
ag.classList.remove("txui-state-disabled");
c.resetRibbonTabContentPos();
c.updateRibbonScrollArrows();
};
c.isRibbonFadedIn=false;
c.fadeInRibbon=function(){var af=document.getElementById("txRibbonCover");
af.style.opacity="0";
setTimeout(function(){af.parentElement.removeChild(af);
},1000);
c.isRibbonFadedIn=true;
};
function y(){c.updateRibbonScrollArrows();
c.fireEvent(c.EventName.ribbonTabsLoaded);
c.ribbonTabsLoaded=true;
z();
}c.showRibbonBar=function(show){if(typeof show==="undefined"){show=true;
}show=!!show;
if((c.isRibbonVisible==show)||c.isRibbonBarRemoved){return;
}var ai=document.getElementById("ribbonbar");
var ah=document.querySelector("#ribbonbar ul.tabs");
var af=document.querySelectorAll("div.ribbon-group img.txDialogLauncher");
var ag;
if(!show){d={menuBackground:ah.style.background,ribbonBarOverflow:ai.style.overflow,};
ah.style.background="white";
ai.style.overflow="hidden";
ai.style.height=ah.clientHeight+"px";
c.ribbonBarHeight=ah.clientHeight;
for(ag=0;
ag<af.length;
++ag){af[ag].style.display="none";
}a("#txArrowRibbonHideWrapper").addClass("down");
c.isRibbonVisible=false;
}else{if(d!==null){ah.style.background=d.menuBackground;
ai.style.overflow=d.ribbonBarOverflow;
ai.style.height="";
c.ribbonBarHeight=c.DEFAULT_RIBBONBAR_HEIGHT;
a("#txArrowRibbonHideWrapper").removeClass("down");
for(ag=0;
ag<af.length;
++ag){af[ag].style.display="";
}c.isRibbonVisible=true;
}}c.resetRibbonTabContentPos();
c.adaptViewToContainerSize();
};
c.addRibbonTab=function(ag){var af=document.getElementById(ag.name);
if(af){var ah=document.querySelector("a[rel="+ag.name+"]");
ah.textContent=ah.dataset.text=ag.title;
ag.groups.forEach(function(ai){c.addRibbonGroup(af,ai);
});
if(!ag.visible){a("#"+ah.id).hide();
}}else{console.error("NOT IMPLEMENTED YET");
}c.adaptRibbonTabWidths();
};
c.addRibbonGroup=function(ag,ah){var af=document.getElementById(ah.name);
if(!af){af=document.createElement("div");
af.id=ah.name;
af.classList.add("ribbon-group");
af.dataset.applicationmodes="0";
ag.appendChild(af);
}c.populateRibbonGroup(af,ah);
};
c.populateRibbonGroup=function(ag,aj){ag.innerHTML="";
var af=document.createElement("div");
af.classList.add("ribbon-group-content");
ag.appendChild(af);
var ah=document.createElement("div");
ah.classList.add("ribbon-group-label-container");
ag.appendChild(ah);
var ai=document.createElement("p");
ai.classList.add("ribbon-group-label");
ai.innerText=aj.title;
ah.appendChild(ai);
aj.children.forEach(function(ak){c.addRibbonGroupElement(af,ak);
});
if(aj.dialogLauncher){m(ag,aj.dialogLauncher);
}if(!aj.visible){ag.style.display="none";
}};
function m(ag,af){var ah=document.createElement("img");
ah.classList.add("txDialogLauncher");
ah.src=af.imageDataURL;
ah.id=af.name;
ah.width=ah.height=16;
ah.style.opacity=0;
ah.title=af.toolTip;
ah.addEventListener("click",function(ai){c.sendCommand(c.Command.ShowDialog,af.dialogCategory,af.dialogID);
});
ag.appendChild(ah);
}c.addRibbonGroupElement=function(af,ag){switch(ag.controlType){case c.RibbonControlType.StackedButtonWrapper:c.addStackedRibbonButtonWrapper(af,ag);
break;
case c.RibbonControlType.ContentRow:c.addRibbonContentRow(af,ag);
break;
case c.RibbonControlType.LayoutTable:c.addRibbonLayoutTable(af,ag);
break;
case c.RibbonControlType.Button:s(af,ag);
break;
case c.RibbonControlType.CheckedListBox:i(af,ag);
break;
}};
c.addStackedRibbonButtonWrapper=function(af,ah){var ag=document.createElement("div");
af.appendChild(ag);
ag.classList.add("ribbon-button-wrapper-small-stacked-buttons");
ah.buttons.forEach(function(ai){s(ag,ai);
});
};
c.addRibbonContentRow=function(ag,af){console.error("NOT IMPLEMENTED YET");
};
c.addRibbonLayoutTable=function(af,ah){var ag=document.createElement("table");
ag.classList.add("ribbon-group-layout-table");
af.appendChild(ag);
ah.rows.forEach(function(ai){o(ag,ai);
});
};
function o(ag,ah){var af=document.createElement("tr");
ag.appendChild(af);
ah.forEach(function(ai){var aj=document.createElement("td");
aj.style.padding="0px";
af.appendChild(aj);
if(ai===null){aj.innerText="\u00A0";
}else{t(aj,ai);
}});
}function t(ag,af){switch(af.controlType){case c.RibbonControlType.Image:u(ag,af);
break;
case c.RibbonControlType.Label:v(ag,af);
break;
case c.RibbonControlType.TextBox:w(ag,af);
break;
case c.RibbonControlType.Button:s(ag,af);
break;
case c.RibbonControlType.LayoutTable:c.addRibbonLayoutTable(ag,af);
break;
case c.RibbonControlType.CheckedListBox:i(ag,af);
break;
}}function u(af,ah){var ag=document.createElement("img");
if(ah.name){ag.id=ah.tabName+"_"+ah.name;
}if(!ah.enabled){ag.classList.add("txui-state-disabled");
}ag.src=ah.imageDataURL;
ag.style.padding="3px 3px 0px 3px";
af.appendChild(ag);
}function v(af,ah){var ag=document.createElement("label");
ag.style.marginLeft=ag.style.marginRight="2px";
ag.textContent=ah.text;
ag.id=ah.tabName+"_"+ah.name;
ag.dataset.name=ah.name;
if(ah.for_){ag.setAttribute("for",ah.tabName+"_"+ah.for_);
}if(!ah.enabled){ag.classList.add("txui-state-disabled");
}af.appendChild(ag);
}function w(ag,ai){var ah=document.createElement("input");
ah.type=ai.isNumeric?"number":"text";
if(ai.isNumeric){ah.setAttribute("step","0.1");
}ah.id=ai.tabName+"_"+ai.name;
ah.dataset.name=ai.name;
if(ai.text){ah.value=ai.text;
}if(ai.width){ah.style.width=ai.width+"px";
}ah.style.height="14px";
ah.style.marginLeft=ah.style.marginRight="2px";
ah.addEventListener("change",af);
if(!ai.enabled){ah.disabled=true;
}function af(ak){var aj={tabName:ai.tabName,textBoxName:ai.name,text:ah.value};
c.sendCommand(c.Command.RibbonTextBoxEvent,c.RibbonTextBoxEventType.TextChanged,0,0,aj);
}ag.appendChild(ah);
}function s(ag,af){switch(af.buttonSize){case c.RibbonButtonSize.Small:x(ag,af);
break;
case c.RibbonButtonSize.Large:n(ag,af);
break;
}}function x(ah,af){var ag=document.createElement("div");
ah.appendChild(ag);
ag.id=af.tabName+"_"+af.name;
ag.dataset.name=af.name;
ag.classList.add("ribbon-button");
if(af.text){ag.classList.add("ribbon-button-small");
}else{ag.classList.add("ribbon-button-tiny");
}if(af.tooltip){ag.title=af.tooltip;
}if(af.isToggleButton&&af.text){ag.classList.add("ribbon-stacked-toggle-button");
}if(!af.enabled){ag.classList.add("txui-state-disabled");
}var aj;
if(!af.text){aj=ag;
if(af.isToggleButton&&af.isToggled){ag.classList.add("ribbon-button-selected");
}}else{aj=document.createElement("div");
ag.appendChild(aj);
if(af.isToggleButton){aj.classList.add("ribbon-button");
aj.classList.add("ribbon-button-tiny");
if(af.isToggled){aj.classList.add("ribbon-button-selected");
}}else{aj.classList.add("ribbon-button-small-image-container");
}}var ai=document.createElement("img");
ai.classList.add("ribbon-button-small-image");
ai.style.width=ai.style.height="16px";
if(af.imageDataURL){ai.src=af.imageDataURL;
}aj.appendChild(ai);
var al=null;
if(af.text){var ak=document.createElement("div");
ag.appendChild(ak);
ak.classList.add("ribbon-button-small-label-container");
al=document.createElement("p");
ak.appendChild(al);
al.classList.add("ribbon-button-label");
var am=document.createElement("span");
am.classList.add("ribbon-button-label-text");
am.textContent=af.text;
al.appendChild(am);
}q(ag,al,af);
}function n(ah,af){var ag=document.createElement("div");
ah.appendChild(ag);
ag.id=af.tabName+"_"+af.name;
ag.dataset.name=af.name;
if(af.tooltip){ag.title=af.tooltip;
}ag.classList.add("ribbon-button");
ag.classList.add("ribbon-button-big");
if(af.isToggleButton&&af.isToggled){ag.classList.add("ribbon-button-selected");
}if(!af.enabled){ag.classList.add("txui-state-disabled");
}var aj=document.createElement("div");
aj.classList.add("ribbon-button-big-image-container");
var ai=document.createElement("img");
ai.classList.add("ribbon-button-big-image");
ai.src=af.imageDataURL;
aj.appendChild(ai);
ag.appendChild(aj);
var ak=document.createElement("div");
ag.appendChild(ak);
ak.classList.add("ribbon-button-big-label-container");
var al=document.createElement("p");
ak.appendChild(al);
al.classList.add("ribbon-button-label");
var am=document.createElement("span");
am.classList.add("ribbon-button-label-text");
am.innerHTML=af.text.replace(/\r?\n/g,"<br>");
al.appendChild(am);
q(ag,al,af);
}function q(ah,ai,af){if(af.menu){if(ai){var aj=document.createElement("span");
aj.classList.add("drop-down-arrow-large");
aj.textContent="▼";
if(af.buttonSize==c.RibbonButtonSize.Small){aj.style.marginLeft="3px";
}ai.appendChild(aj);
}else{if(ah.classList.contains("ribbon-button-tiny")){ah.classList.remove("ribbon-button-tiny");
ah.classList.add("ribbon-dropdown-button-tiny");
ai=document.createElement("p");
ai.textContent="▼";
ah.appendChild(ai);
}}var ak=G(ah);
c.addDropDownMenu(af.menu,ak);
a("#"+ah.id).click(al);
}else{ah.addEventListener("click",ag);
}function ag(an){var am={buttonName:af.name,tabName:af.tabName};
c.sendCommand(c.Command.RibbonButtonEvent,c.RibbonButtonEventType.Click,0,0,am);
}function al(an){c.fileMenu.hide();
c.hideAllOtherMenus();
var ap=af.tabName+"_"+af.menu.name;
var am=document.getElementById(ap);
c.calcMenuWidths(am);
var ao=c.jQueryMenus[af.menu.name];
ao.show().position({my:"left top",at:"left bottom",of:an.currentTarget});
a(document).on("click",function(aq){if(!(c.isInsideElementWithID(aq.target,ap)&&c.isPartOfMenuItemWithSubMenu(aq.target))){ao.hide();
a(document).off(aq);
}});
return false;
}}function i(af,ah){var ag=document.createElement("div");
af.appendChild(ag);
ag.id=ah.tabName+"_"+ah.name;
ag.dataset.name=ah.name;
ag.classList.add("checked-list-box");
ag.style.width=ah.width+"px";
ag.style.height=ah.height+"px";
j(ag,ah.items,ah.tabName,ah.name);
}function j(ag,ak,am,al){ag.innerHTML="";
var ah=document.createElement("table");
ag.appendChild(ah);
ah.classList.add("checked-list-box-item-container");
for(var ai=0;
ai<ak.length;
++ai){af(ai,ak[ai]);
}function af(ar,at){var aq=document.createElement("tr");
ah.appendChild(aq);
aq.classList.add("checked-list-item");
var ap=document.createElement("td");
aq.appendChild(ap);
var an=document.createElement("input");
ap.appendChild(an);
var au=ag.id+"_checkbox_"+ar;
an.id=au;
an.type="checkbox";
an.dataset.index=ar;
an.dataset.text=at.text;
an.checked=at.isChecked;
an.addEventListener("change",aj);
ap=document.createElement("td");
aq.appendChild(ap);
var ao=document.createElement("label");
ap.appendChild(ao);
ao.htmlFor=au;
ao.textContent=at.text;
}function aj(ap){var an=ap.currentTarget;
var ao={tabName:am,itemIndex:an.dataset.index,listBoxName:al,isChecked:an.checked};
c.sendCommand(c.Command.CheckedListBoxEvent,c.CheckedListBoxEventType.ItemCheckChanged,0,0,ao);
}}function G(af){var ag=af.parentElement;
while(ag){if(ag.classList.contains("tab-content")){return ag;
}ag=ag.parentElement;
}return null;
}c.addDropDownMenu=function(aj,ag){var af=document.createElement("ul");
af.classList.add("dropDownMenu");
var ak=aj.tabName+"_"+aj.name;
af.id=ak;
p(af,aj.items,aj.itemSize,aj.name,true);
ag.appendChild(af);
var ah=a("#"+ak).menu().hide();
c.jQueryMenus[aj.name]=ah;
ah.on("menuselect",ai);
function ai(am,ao){var an=ao.item.context;
var al={menuName:an.dataset.menuName,menuItemName:an.dataset.menuItemName,tabName:aj.tabName,tag:null};
if(an.dataset.tag){al.tag=JSON.parse(an.dataset.tag);
}if(an.dataset.menuItemParameter){al.parameter=an.dataset.menuItemParameter;
}c.sendCommand(c.Command.RibbonMenuEvent,c.RibbonMenuEventType.ItemSelect,0,0,al);
}};
function p(af,ah,ai,aj,ag){if(!ag){af.style.maxHeight="200px";
af.style.overflowY="auto";
}ah.forEach(function(ak){if(ak.isColorPicker){k(af,ak,ai,aj);
}else{r(af,ak,ai,aj);
}});
}var M="1px solid lightgray";
function r(ak,an,ap,aq){var aj=document.createElement("li"),ao;
if(!an.enabled){aj.classList.add("txui-state-disabled");
}if(an.border&c.RibbonMenuItemBorder.Top){aj.style.borderTop=M;
}if(an.border&c.RibbonMenuItemBorder.Bottom){aj.style.borderBottom=M;
}if(an.name){ao=an.tabName+"_"+an.name;
aj.id=ao;
aj.dataset.menuItemName=an.name;
}if(an.parameter){aj.dataset.menuItemParameter=an.parameter;
}aj.dataset.menuName=aq;
var af=document.createElement("a");
var ah=document.createElement("div");
var ag=document.createElement("div");
switch(ap){case c.RibbonMenuItemSize.Large:ah.classList.add("large-menu-item-image-container");
ag.classList.add("large-menu-item-caption-container");
break;
case c.RibbonMenuItemSize.Small:if(an.isCheckable){ah.classList.add("ribbon-button");
ah.classList.add("ribbon-button-tiny");
}else{ah.classList.add("small-menu-item-image-wrapper");
}ag.classList.add("small-menu-item-caption-container");
break;
}if(an.isCheckMark){ah.classList.add("ribbon-button-checkmark");
}if(an.isChecked){ah.classList.add("ribbon-button-selected");
}var ai;
if(an.smallImageDataURL||an.largeImageDataURL){ai=document.createElement("img");
switch(ap){case c.RibbonMenuItemSize.Small:ai.src=an.smallImageDataURL;
break;
case c.RibbonMenuItemSize.Large:ai.src=an.largeImageDataURL;
break;
}}var al=document.createElement("p");
al.textContent=an.text;
if(ai){ah.appendChild(ai);
}ag.appendChild(al);
af.appendChild(ah);
af.appendChild(ag);
aj.appendChild(af);
if(an.menu&&an.menu.items.length){if(ao){l(ao,ap);
}var am=document.createElement("ul");
am.id=an.tabName+"_"+an.menu.name;
p(am,an.menu.items,an.menu.itemSize,an.menu.name,false);
aj.appendChild(am);
}ak.appendChild(aj);
}function l(af,ag){var ah,aj=null,ai;
switch(ag){case c.RibbonMenuItemSize.Large:ah=10;
break;
case c.RibbonMenuItemSize.Small:ah=3;
break;
}aj=I();
if(aj===null){console.error("TX main stylesheet not found.");
return;
}ai="#"+af+" a > span.txui-menu-icon { margin-top: "+ah+"px; }";
aj.insertRule(ai,0);
}function I(){var ag=null,af,ah;
for(af=0;
af<document.styleSheets.length;
++af){ah=document.styleSheets[af];
if(ah.title==="TX Text Control HTML5 Editor main Stylesheet"){ag=ah;
break;
}}return ag;
}function k(ah,aj,ak,al){var ai,ag=c.makeSmallColorButtons();
ah.style.minWidth=c.MinColorPickerMenuWidth+"px";
for(ai=0;
ai<ag.length;
++ai){var af=ag[ai];
af.dataset.menuName=al;
af.dataset.menuItemName=aj.name;
ah.appendChild(af);
}}c.changeRibbonControlState=function(ah){var ag,ai,af;
ag=ah.controlName;
af=document.getElementById(ag);
if(!af){if(ah.tabName!==null){ag=ah.tabName+"_"+ah.controlName;
af=document.getElementById(ag);
if(!af){return;
}}else{return;
}}switch(ah.stateType){case c.RibbonControlStateType.Enabled:switch(af.tagName){case"INPUT":af.disabled=!ah.value;
break;
default:if(ah.value){af.classList.remove("txui-state-disabled");
}else{af.classList.add("txui-state-disabled");
}break;
}break;
case c.RibbonControlStateType.Visible:ai=document.querySelector("a[rel="+ag+"]");
if(ai){if(ah.value){a("#"+ai.id).show();
}else{a("#"+ai.id).hide();
if(a("#"+ag).is(":visible")){c.switchTabs(a("#tabDefault"));
}}c.adaptRibbonTabWidths();
}else{if(ah.value){af.style.display="";
c.setDlgLauncherPos();
}else{af.style.display="none";
}}break;
}};
c.changeRibbonButtonState=function(ag){var af=document.getElementById(ag.tabName+"_"+ag.buttonName);
if(!af){return;
}switch(ag.stateType){case c.RibbonButtonStateType.Toggled:if(af.classList.contains("ribbon-button-big")){if(ag.value){af.classList.add("ribbon-button-selected");
}else{af.classList.remove("ribbon-button-selected");
}}else{var ah=af.getElementsByTagName("div")[0];
if(!ah){ah=af;
}if(ag.value){ah.classList.add("ribbon-button-selected");
}else{ah.classList.remove("ribbon-button-selected");
}}break;
}};
c.changeRibbonMenuItemState=function(ag){var af=document.getElementById(ag.tabName+"_"+ag.menuItemName);
if(!af){return;
}switch(ag.stateType){case c.RibbonMenuItemStateType.IsChecked:D(af,ag.value);
break;
case c.RibbonMenuItemStateType.OverlayColor:ad(af,ag.value);
break;
}};
function ad(ah,af){var ag=ah.querySelector("img");
if(!ag){console.error('No image found in element "'+ah.id+'".');
return;
}c.update16x16ColorButtonIcon(ag,af);
}function D(ag,af){var ah=ag.querySelector("a > div");
if(af){ah.classList.add("ribbon-button-selected");
}else{ah.classList.remove("ribbon-button-selected");
}}c.changeRibbonTextBoxState=function(af){var ag=document.getElementById(af.tabName+"_"+af.textBoxName);
if(!ag){return;
}switch(af.stateType){case c.RibbonTextBoxStateType.Text:ag.value=af.value;
break;
}};
c.changeCheckedListItemState=function(ag){switch(ag.stateType){case c.CheckedListItemStateType.IsChecked:af();
break;
case c.CheckedListItemStateType.Text:ah();
break;
}function af(){var aj=document.querySelectorAll("#"+ag.tabName+"_"+ag.listBoxName+" input[type=checkbox]");
var ai=[].find.call(aj,function(ak){return ak.dataset.text===ag.text;
});
if(!ai){console.error('Check box "'+ag.text+'" not found in list box "'+ag.listBoxName+'".');
return;
}ai.checked=ag.value;
}function ah(){var aj=document.querySelectorAll("#"+ag.tabName+"_"+ag.listBoxName+" label");
var ai=[].find.call(aj,function(ak){return ak.textContent===ag.text;
});
if(!ai){console.error('Label "'+ag.text+'" not found in list box "'+ag.listBoxName+'".');
return;
}ai.text=ag.value;
}};
c.changeCheckedListBoxState=function(ag){var af=document.getElementById(ag.tabName+"_"+ag.name);
if(!af){return;
}switch(ag.stateType){case c.CheckedListBoxStateType.Items:j(af,ag.value,ag.tabName,ag.name);
break;
}};
c.hideAllOtherMenus=function(){c.hideAllMenus_homeTab();
c.hideAllMenus_insertTab();
c.hideAllMenus_pageLayoutTab();
c.hideAllMenus_mailingsTab();
c.hideAllMenus_viewTab();
c.hideAllMenus_tableLayoutTab();
for(var af in c.jQueryMenus){c.jQueryMenus[af].hide();
}};
return ac;
}(TXTextControl||{},j$1_10_2));
var TXTextControl=(function(d,a){var b=d._private=d._private||{};
b.TextPartCommand=Object.freeze({GetCount:0,GetTextPart:1,Activate:2,GetAll:3,GetItem:4});
b.TextPartType=Object.freeze({Auto:0,MainText:1,HeaderFooter:2,TextFrame:3,fromTypeName:function(e){switch(e){case b.TextPartTypeName.Auto:return this.Auto;
case b.TextPartTypeName.MainText:return this.MainText;
case b.TextPartTypeName.HeaderFooter:return this.HeaderFooter;
case b.TextPartTypeName.TextFrame:return this.TextFrame;
}return -1;
}});
b.TextPartTypeName=Object.freeze({Auto:"auto",MainText:"mainText",HeaderFooter:"headerFooter",TextFrame:"textFrame",fromType:function(e){switch(e){case b.TextPartType.Auto:return this.Auto;
case b.TextPartType.MainText:return this.MainText;
case b.TextPartType.HeaderFooter:return this.HeaderFooter;
case b.TextPartType.TextFrame:return this.TextFrame;
}return"";
}});
b.TextPart=(function(){function e(type,index){this.type=type||b.TextPartTypeName.Auto;
this.index=index||0;
var f=this;
Object.defineProperties(this,{selection:{get:function(){return new b.Selection(f);
},set:function(bounds){var g=new b.Selection(f);
g.setBounds(bounds);
},enumerable:true}});
}e.prototype.getTextFields=function(callback,atInputPosition){if(!callback){throw new Error(b.ErrorText.TooFewParameters);
}if(typeof callback!=="function"){throw new TypeError(b.ErrorText.CallBackIsNoFunction);
}b.documentTaskCallbacks.getTextFields.push(callback);
var g={TextPartType:b.TextPartType.fromTypeName(this.type),TextPartIndex:this.index};
var f=atInputPosition?b.TextFieldCommand.GetItem:b.TextFieldCommand.GetAll;
b.sendCommand(b.Command.ClientTextField,f,0,0,g);
};
e.prototype.getSubTextParts=function(callback,atInputPosition){if(!callback){throw new Error(b.ErrorText.TooFewParameters);
}if(typeof callback!=="function"){throw new TypeError(b.ErrorText.CallBackIsNoFunction);
}b.documentTaskCallbacks.getSubTextParts.push(callback);
var g={TextPartType:b.TextPartType.fromTypeName(this.type),TextPartIndex:this.index};
var f=atInputPosition?b.SubTextPartCommand.GetItem:b.SubTextPartCommand.GetAll;
b.sendCommand(b.Command.ClientSubTextPart,f,0,0,g);
};
e.prototype.addTextField=function(textField){if(!textField||((textField.constructor!==b.ApplicationField)&&(textField.constructor!==b.TextField))){throw new TypeError('Parameter "applicationField" cannot be omitted and must be of type TXTextControl.ApplicationField or TXTextControl.TextField.');
}textField._field.textPart.type=b.TextPartType.fromTypeName(this.type);
textField._field.textPart.index=this.index;
b.sendCommand(b.Command.ClientTextField,b.TextFieldCommand.Add,0,0,{textField:textField._field});
};
return e;
})();
b.processTextPartDataMessage=function(e){switch(e.textPartCommand){case b.TextPartCommand.GetAll:c(e.content);
break;
}};
function c(h){var k;
var g=b.documentTaskCallbacks.getTextParts;
b.documentTaskCallbacks.getTextParts=[];
var n=[];
var l=h.textParts.length;
for(k=0;
k<l;
++k){var o=h.textParts[k];
var m=new b.TextPart(b.TextPartTypeName.fromType(o.type),o.index);
n.push(m);
}for(k=0;
k<g.length;
++k){var f=g[k];
try{f(n);
}catch(j){}}}return d;
}(TXTextControl||{},j$1_10_2));
var TXTextControl=(function(c,a){var b=c._private=c._private||{};
b.SelectionCommand=Object.freeze({GetStartAndLength:0,SetStartAndLength:1,Load:2,GetText:3,Save:4,GetCulture:5,SetCulture:6});
b.Selection=(function(){function d(textPart){this.textPart=textPart||new b.TextPart();
}d.prototype.getBounds=function(callback){if(!callback){throw new Error(b.ErrorText.TooFewParameters);
}if(typeof callback!=="function"){throw new TypeError(b.ErrorText.CallBackIsNoFunction);
}b.selectionTaskCallbacks.getBounds.push(callback);
var e={TextPartType:b.TextPartType.fromTypeName(this.textPart.type),TextPartIndex:this.textPart.index,};
b.sendCommand(b.Command.ClientSelection,b.SelectionCommand.GetStartAndLength,0,0,e);
};
d.prototype.setBounds=function(bounds){if(!(bounds.hasOwnProperty("start")&&bounds.hasOwnProperty("length"))){throw new Error(b.ErrorText.SelectionObjectProps);
}var f={Index:this.textPart.index,Type:b.TextPartType.fromTypeName(this.textPart.type)};
var e={Start:bounds.start,Length:bounds.length,TextPart:f};
b.sendCommand(b.Command.ClientSelection,b.SelectionCommand.SetStartAndLength,0,0,e);
};
d.prototype.getCulture=function(callback){if(!callback){throw new Error(b.ErrorText.TooFewParameters);
}if(typeof callback!=="function"){throw new TypeError(b.ErrorText.CallBackIsNoFunction);
}b.selectionTaskCallbacks.getCulture.push(callback);
var e={TextPartType:b.TextPartType.fromTypeName(this.textPart.type),TextPartIndex:this.textPart.index,};
b.sendCommand(b.Command.ClientSelection,b.SelectionCommand.GetCulture,0,0,e);
};
d.prototype.setCulture=function(culture){var f={Index:this.textPart.index,Type:b.TextPartType.fromTypeName(this.textPart.type)};
var e={Culture:culture,TextPart:f};
b.sendCommand(b.Command.ClientSelection,b.SelectionCommand.SetCulture,0,0,e);
};
d.prototype.load=function(streamType,base64Data){if(!streamType){throw new Error(b.ErrorText.NoStreamType);
}if(!base64Data){throw new Error(b.ErrorText.NoDocumentData);
}var e={TextPartType:b.TextPartType.fromTypeName(this.textPart.type),TextPartIndex:this.textPart.index,DocData:base64Data};
b.sendCommand(b.Command.ClientSelection,b.SelectionCommand.Load,streamType,0,e);
};
d.prototype.save=function(streamType,callback){if(!streamType){throw new Error(b.ErrorText.NoStreamType);
}if(!callback){throw new Error(b.ErrorText.TooFewParameters);
}if(typeof callback!=="function"){throw new TypeError(b.ErrorText.CallBackIsNoFunction);
}b.selectionTaskCallbacks.save.push(callback);
var e={TextPartType:b.TextPartType.fromTypeName(this.textPart.type),TextPartIndex:this.textPart.index};
b.sendCommand(b.Command.ClientSelection,b.SelectionCommand.Save,streamType,0,e);
};
return d;
})();
return c;
}(TXTextControl||{},j$1_10_2));
var TXTextControl=(function(d,a){var b=d._private=d._private||{};
b.TextFieldCommand=Object.freeze({GetAll:1,SetProperty:2,GetItem:3,Add:4,Remove:5,ShowDialog:6});
b.TextFieldProperty=Object.freeze({Text:0,Parameters:1,Name:2,TypeName:3,ID:4,Deleteable:5,DoubledInputPosition:6,Editable:7,ShowActivated:8,IsSpellCheckingEnabled:9});
b.PrivateTextField=(function(){function e(typeName,text,parameters,fieldType){typeName=typeName||"";
text=text||"";
parameters=parameters||[];
if(typeof typeName!=="string"){throw new Error('"typeName" must be a string.');
}if(typeof text!=="string"){throw new TypeError('"text" must be a string.');
}if(parameters.constructor!==Array){throw new TypeError('"parameters" must be an array.');
}parameters.forEach(function(f){if((typeof f!=="string")&&!(f instanceof String)){throw new TypeError('"parameters" must be an array of strings.');
}});
this.typeName=typeName;
this.fieldText=text;
this.parameters=parameters;
this.fieldType=fieldType;
this.fieldName="";
this.start=0;
this.length=0;
this.id=0;
this.bounds={location:{x:0,y:0},size:{width:0,height:0}};
this.containsInputPosition=false;
this.deleteable=true;
this.doubledInputPosition=false;
this.editable=true;
this.showActivated=false;
this.isSpellCheckingEnabled=true;
this.textPart={type:b.TextPartType.Auto,index:-1};
}return e;
})();
b.Size=(function(){function e(width,height){if((typeof width!=="number")||(typeof height!=="number")){throw new TypeError("Parameters have to be numerical values.");
}this.width=width;
this.height=height;
}return e;
})();
b.Rectangle=(function(){function e(x,y,width,height){if((typeof x!=="number")||(typeof y!=="number")||(typeof width!=="number")||(typeof height!=="number")){throw new TypeError("Parameters have to be numerical values.");
}this.location=new b.Point(x,y);
this.size=new b.Size(width,height);
}return e;
})();
b.TextField=(function(){function e(text){var f;
if(arguments.length===2){f=arguments[1];
}else{f=new b.PrivateTextField("",text,[],"TEXTFIELD");
}this._field=f;
var g=this;
Object.defineProperties(this,{text:{get:function(){return g._field.fieldText;
},set:function(text){if(text===undefined){throw new Error(b.ErrorText.TooFewParameters);
}if(typeof text!=="string"){throw new TypeError('"text" must be a string.');
}g._field.fieldText=text;
if(g._field.constructor===b.PrivateTextField){return;
}var h={textField:g._field};
b.sendCommand(b.Command.ClientTextField,b.TextFieldCommand.SetProperty,b.TextFieldProperty.Text,0,h);
},enumerable:true},name:{get:function(){return g._field.fieldName;
},set:function(name){if(name===undefined){throw new Error(b.Error.TooFewParameters);
}if(typeof name!=="string"){throw new TypeError('"name" must be a string.');
}g._field.fieldName=name;
if(g._field.constructor===b.PrivateTextField){return;
}var h={textField:g._field};
b.sendCommand(b.Command.ClientTextField,b.TextFieldCommand.SetProperty,b.TextFieldProperty.Name,0,h);
},enumerable:true},start:{get:function(){return g._field.start;
},enumerable:true},length:{get:function(){return g._field.length;
},enumerable:true},id:{get:function(){return g._field.id;
},set:function(id){if(id===undefined){id=0;
}if(!isInteger(id)){throw new TypeError('"id" must be an integer.');
}g._field.id=id;
if(g._field.constructor===b.PrivateTextField){return;
}var h={textField:g._field};
b.sendCommand(b.Command.ClientTextField,b.TextFieldCommand.SetProperty,b.TextFieldProperty.ID,0,h);
},enumerable:true},type:{get:function(){return g._field.fieldType;
},enumerable:true},bounds:{get:function(){var h=g._field.bounds;
return new b.Rectangle(h.location.x,h.location.y,h.size.width,h.size.height);
},enumerable:true},containsInputPosition:{get:function(){return g._field.containsInputPosition;
},enumerable:true},deleteable:{get:function(){return g._field.deleteable;
},set:function(deleteable){if(deleteable===undefined){deleteable=false;
}if(typeof deleteable!=="boolean"){throw new TypeError('"deleteable" must be a boolean value.');
}g._field.deleteable=deleteable;
if(g._field.constructor===b.PrivateTextField){return;
}var h={textField:g._field};
b.sendCommand(b.Command.ClientTextField,b.TextFieldCommand.SetProperty,b.TextFieldProperty.Deleteable,0,h);
},enumerable:true},doubledInputPosition:{get:function(){return g._field.doubledInputPosition;
},set:function(doubledInputPosition){if(doubledInputPosition===undefined){doubledInputPosition=false;
}if(typeof doubledInputPosition!=="boolean"){throw new TypeError('"doubledInputPosition" must be a boolean value.');
}g._field.doubledInputPosition=doubledInputPosition;
if(g._field.constructor===b.PrivateTextField){return;
}var h={textField:g._field};
b.sendCommand(b.Command.ClientTextField,b.TextFieldCommand.SetProperty,b.TextFieldProperty.DoubledInputPosition,0,h);
},enumerable:true},editable:{get:function(){return g._field.editable;
},set:function(editable){if(editable===undefined){editable=false;
}if(typeof editable!=="boolean"){throw new TypeError('"editable" must be a boolean value.');
}g._field.editable=editable;
if(g._field.constructor===b.PrivateTextField){return;
}var h={textField:g._field};
b.sendCommand(b.Command.ClientTextField,b.TextFieldCommand.SetProperty,b.TextFieldProperty.Editable,0,h);
},enumerable:true},showActivated:{get:function(){return g._field.showActivated;
},set:function(showActivated){if(showActivated===undefined){showActivated=false;
}if(typeof showActivated!=="boolean"){throw new TypeError('"showActivated" must be a boolean value.');
}g._field.showActivated=showActivated;
if(g._field.constructor===b.PrivateTextField){return;
}var h={textField:g._field};
b.sendCommand(b.Command.ClientTextField,b.TextFieldCommand.SetProperty,b.TextFieldProperty.ShowActivated,0,h);
},enumerable:true},isSpellCheckingEnabled:{get:function(){return g._field.isSpellCheckingEnabled;
},set:function(isSpellCheckingEnabled){if(isSpellCheckingEnabled===undefined){isSpellCheckingEnabled=false;
}if(typeof isSpellCheckingEnabled!=="boolean"){throw new TypeError('"isSpellCheckingEnabled" must be a boolean value.');
}g._field.isSpellCheckingEnabled=isSpellCheckingEnabled;
if(g._field.constructor===b.PrivateTextField){return;
}var h={textField:g._field};
b.sendCommand(b.Command.ClientTextField,b.TextFieldCommand.SetProperty,b.TextFieldProperty.IsSpellCheckingEnabled,0,h);
},enumerable:true}});
}return e;
})();
b.processTextFieldDataMessage=function(e){switch(e.textFieldCommand){case b.TextFieldCommand.GetAll:c(e.content);
break;
}};
function c(f){var e=b.documentTaskCallbacks.getTextFields;
b.documentTaskCallbacks.getTextFields=[];
var g=[];
f.textFields.forEach(function(h){switch(h.fieldType){case"APPLICATIONFIELD":g.push(new b.ApplicationField(null,null,null,h));
break;
case"TEXTFIELD":g.push(new b.TextField(null,h));
break;
default:console.error("Unknown text field type: "+h.fieldType);
break;
}});
e.forEach(function(h){try{h(g);
}catch(i){}});
}return d;
}(TXTextControl||{},j$1_10_2));
var TXTextControl=(function(c,a){var b=c._private=c._private||{};
b.ApplicationField=(function(d){__extends(e,d);
function e(typeName,text,parameters){var f;
if(arguments.length===4){f=arguments[3];
}else{f=new b.PrivateTextField(typeName,text,parameters,"APPLICATIONFIELD");
}d.call(this,null,f);
var g=this;
Object.defineProperties(this,{typeName:{get:function(){return g._field.typeName;
},set:function(typeName){if(typeName===undefined){throw new Error(b.Error.TooFewParameters);
}if(typeof typeName!=="string"){throw new TypeError('"typeName" must be a string.');
}g._field.typeName=typeName;
if(g._field.constructor===b.PrivateTextField){return;
}var h={textField:g._field};
b.sendCommand(b.Command.ClientTextField,b.TextFieldCommand.SetProperty,b.TextFieldProperty.TypeName,0,h);
},enumerable:true},parameters:{get:function(){return g._field.parameters;
},set:function(parameters){if(parameters===undefined){throw new Error(b.ErrorText.TooFewParameters);
}if(parameters.constructor!==Array){throw new TypeError('"parameters" must be an array.');
}parameters.forEach(function(i){if((typeof i!=="string")&&!(i instanceof String)){throw new TypeError('"parameters" must be an array of strings.');
}});
g._field.parameters=parameters;
if(g._field.constructor===b.PrivateTextField){return;
}var h={textField:g._field};
b.sendCommand(b.Command.ClientTextField,b.TextFieldCommand.SetProperty,b.TextFieldProperty.Parameters,0,h);
},enumerable:true}});
}e.prototype.showDialog=function(){b.sendCommand(b.Command.ClientTextField,b.TextFieldCommand.ShowDialog,0,0,{textField:this._field});
};
return e;
})(b.TextField);
return c;
}(TXTextControl||{},j$1_10_2));
var TXTextControl=(function(d,a){var b=d._private=d._private||{};
b.SubTextPartCommand=Object.freeze({GetAll:1,SetProperty:2,GetItem:3,});
b.SubTextPartProperty=Object.freeze({Name:1,Start:2,Length:3,ID:4,HighlightColor:5,HighlightMode:6});
b.HighlightMode=Object.freeze({Never:1,Activated:2,Always:3});
b.Color=(function(){function e(r,g,b,a){if(a===undefined){a=255;
}if((r===undefined)||(g===undefined)||(b===undefined)||(r<0)||(r>255)||(g<0)||(g>255)||(b<0)||(b>255)||(a<0)||(a>255)){throw new TypeError("r, g, and b parameters must be integer values between 0 and 255.");
}this.r=Math.round(r);
this.g=Math.round(g);
this.b=Math.round(b);
this.a=Math.round(a);
}return e;
})();
b.SubTextPart=(function(){function e(serverSubTextPartObject){this._subTextPart=serverSubTextPartObject;
var f=this;
Object.defineProperties(this,{name:{get:function(){return f._subTextPart.name;
},set:function(name){if(name===undefined){throw new Error(b.ErrorText.TooFewParameters);
}if(typeof name!=="string"){throw new TypeError('"name" must be a string.');
}f._subTextPart.name=name;
var g={subTextPart:f._subTextPart};
b.sendCommand(b.Command.ClientSubTextPart,b.SubTextPartCommand.SetProperty,b.SubTextPartProperty.Name,0,g);
},enumerable:true},id:{get:function(){return f._subTextPart.id;
},set:function(id){if(id===undefined){id=0;
}if(!isInteger(id)){throw new TypeError('"id" must be an integer.');
}f._subTextPart.id=id;
var g={subTextPart:f._subTextPart};
b.sendCommand(b.Command.ClientSubTextPart,b.SubTextPartCommand.SetProperty,b.SubTextPartProperty.ID,0,g);
},enumerable:true},highlightColor:{get:function(){return f._subTextPart.highlightColor;
},set:function(highlightColor){if(highlightColor===undefined){throw new Error(b.ErrorText.TooFewParameters);
}if(!highlightColor.hasOwnProperty("r")||!highlightColor.hasOwnProperty("g")||!highlightColor.hasOwnProperty("b")||!highlightColor.hasOwnProperty("a")){throw new TypeError("The color object must have the properties 'r', 'g', 'b' and 'a'.");
}if(!isInteger(highlightColor.r)||!isInteger(highlightColor.g)||!isInteger(highlightColor.b)||!isInteger(highlightColor.a)){throw new TypeError("All color channel values must be integers between 0 and 255.");
}f._subTextPart.highlightColor=highlightColor;
var g={subTextPart:f._subTextPart};
b.sendCommand(b.Command.ClientSubTextPart,b.SubTextPartCommand.SetProperty,b.SubTextPartProperty.HighlightColor,0,g);
},enumerable:true},highlightMode:{get:function(){return f._subTextPart.highlightMode;
},set:function(highlightMode){if(highlightMode===undefined){throw new Error(b.ErrorText.TooFewParameters);
}if(!isInteger(highlightMode)){throw new TypeError('"highlightMode" must be one of the values defined in TXTextControl.HighlightMode.');
}f._subTextPart.highlightMode=highlightMode;
var g={subTextPart:f._subTextPart};
b.sendCommand(b.Command.ClientSubTextPart,b.SubTextPartCommand.SetProperty,b.SubTextPartProperty.HighlightMode,0,g);
},enumerable:true},text:{get:function(){return f._subTextPart.text;
},enumerable:true},number:{get:function(){return f._subTextPart.number;
},enumerable:true},start:{get:function(){return f._subTextPart.start;
},enumerable:true},length:{get:function(){return f._subTextPart.length;
},enumerable:true},nestedLevel:{get:function(){return f._subTextPart.nestedLevel;
},enumerable:true},});
}return e;
})();
b.processSubTextPartDataMessage=function(e){switch(e.subTextPartCommand){case b.SubTextPartCommand.GetAll:c(e.content);
break;
}};
function c(f){var e=b.documentTaskCallbacks.getSubTextParts;
b.documentTaskCallbacks.getSubTextParts=[];
var g=[];
f.subTextParts.forEach(function(h){g.push(new b.SubTextPart(h));
});
e.forEach(function(h){try{h(g);
}catch(i){}});
}return d;
}(TXTextControl||{},j$1_10_2));
var TXTextControl=(function(f,a){var b=f._private=f._private||{};
var e=f.Proofing=f.Proofing||{};
b.SpellCheckCommand=Object.freeze({LoadUserDictionary:1,AddWordToUserDict:2,RemoveWordFromUserDict:3,ClientSaveUserDictionary:4,RemoveUserDictionary:5,ClientGetUserDictInfo:6});
b.proofingTaskCallbacks={saveUserDictionary:[],getUserDictionaryInfo:[]};
b.UserDictionaryInfo=(function(){function g(info){for(var h in info){this[h]=info[h];
}}return g;
})();
e.loadUserDictionary=function(name,words,language){if(!name||(typeof name!=="string")){throw new TypeError('"name" must be a non empty string.');
}if((language===undefined)||(typeof language!=="string")){throw new TypeError('"language" must be a string.');
}if(words===undefined){throw new Error(b.ErrorText.TooFewParameters);
}if(words.constructor!==Array){throw new TypeError('"words" must be an array.');
}words.forEach(function(h){if((typeof h!=="string")&&!(h instanceof String)){throw new TypeError('"words" must be an array of strings.');
}});
var g={words:words,name:name,lang:language};
b.sendCommand(b.Command.SpellCheck,b.SpellCheckCommand.LoadUserDictionary,0,0,g);
};
e.addWordToUserDictionary=function(name,word){if(!name||(typeof name!=="string")){throw new TypeError('"name" must be a non empty string.');
}if(word===undefined){throw new Error(b.ErrorText.TooFewParameters);
}if(!word||(typeof word!=="string")){throw new TypeError('"word" must be a non empty string.');
}var g={word:word,name:name};
b.sendCommand(b.Command.SpellCheck,b.SpellCheckCommand.AddWordToUserDict,0,0,g);
};
e.removeWordFromUserDictionary=function(name,word){if(!name||(typeof name!=="string")){throw new TypeError('"name" must be a non empty string.');
}if(word===undefined){throw new Error(b.ErrorText.TooFewParameters);
}if(!word||(typeof word!=="string")){throw new TypeError('"word" must be a non empty string.');
}var g={word:word,name:name};
b.sendCommand(b.Command.SpellCheck,b.SpellCheckCommand.RemoveWordFromUserDict,0,0,g);
};
e.saveUserDictionary=function(name,callback){if(!name||(typeof name!=="string")){throw new TypeError('"name" must be a non empty string.');
}if(!callback){throw new Error(b.ErrorText.TooFewParameters);
}if(typeof callback!=="function"){throw new TypeError(b.ErrorText.CallBackIsNoFunction);
}b.proofingTaskCallbacks.saveUserDictionary.push(callback);
b.sendCommand(b.Command.SpellCheck,b.SpellCheckCommand.ClientSaveUserDictionary,0,0,{name:name});
};
e.removeUserDictionary=function(name){if(!name||(typeof name!=="string")){throw new TypeError('"name" must be a non empty string.');
}b.sendCommand(b.Command.SpellCheck,b.SpellCheckCommand.RemoveUserDictionary,0,0,{name:name});
};
e.getUserDictionaryInfo=function(callback){if(!callback){throw new Error(b.ErrorText.TooFewParameters);
}if(typeof callback!=="function"){throw new TypeError(b.ErrorText.CallBackIsNoFunction);
}b.proofingTaskCallbacks.getUserDictionaryInfo.push(callback);
b.sendCommand(b.Command.SpellCheck,b.SpellCheckCommand.ClientGetUserDictInfo);
};
b.processSpellCheckCommandResponse=function(g){switch(g.content.command){case b.SpellCheckCommand.ClientSaveUserDictionary:d(g.content.content);
break;
case b.SpellCheckCommand.ClientGetUserDictInfo:c(g.content.content);
break;
}};
function d(j){var h=b.proofingTaskCallbacks.saveUserDictionary;
b.proofingTaskCallbacks.saveUserDictionary=[];
for(var l=0;
l<h.length;
++l){var g=h[l];
try{g(j.name,j.words);
}catch(k){}}}function c(j){var h=b.proofingTaskCallbacks.getUserDictionaryInfo;
b.proofingTaskCallbacks.getUserDictionaryInfo=[];
var m=[];
j.info.forEach(function(i){m.push(new b.UserDictionaryInfo(i));
});
for(var l=0;
l<h.length;
++l){var g=h[l];
try{g(m);
}catch(k){}}}return f;
}(TXTextControl||{},j$1_10_2));
var TXTextControl=(function(d,a){var b=d._private=d._private||{};
var c=d.documentPermissions=d.documentPermissions||{};
b.documentPermissions={readOnly:true,allowCopy:true,allowFormatting:true,allowFormattingStyles:true,allowPrinting:true};
b.DocumentPermissionsProperty={};
Object.defineProperty(c,"readOnly",{get:function(){return b.documentPermissions.readOnly;
},set:function(readOnly){if(typeof readOnly!=="boolean"){throw new TypeError(b.ErrorText.ParamNotBoolean);
}b.sendCommand(b.Command.SetDocumentPermissions,b.DocumentPermissionsProperty.ReadOnly,readOnly?1:0);
},enumerable:true});
Object.defineProperty(c,"allowCopy",{get:function(){return b.documentPermissions.allowCopy;
},set:function(allowCopy){if(typeof allowCopy!=="boolean"){throw new TypeError(b.ErrorText.ParamNotBoolean);
}b.sendCommand(b.Command.SetDocumentPermissions,b.DocumentPermissionsProperty.AllowCopy,allowCopy?1:0);
},enumerable:true});
Object.defineProperty(c,"allowFormatting",{get:function(){return b.documentPermissions.allowFormatting;
},set:function(allowFormatting){if(typeof allowFormatting!=="boolean"){throw new TypeError(b.ErrorText.ParamNotBoolean);
}b.sendCommand(b.Command.SetDocumentPermissions,b.DocumentPermissionsProperty.AllowFormatting,allowFormatting?1:0);
},enumerable:true});
Object.defineProperty(c,"allowFormattingStyles",{get:function(){return b.documentPermissions.allowFormattingStyles;
},set:function(allowFormattingStyles){if(typeof allowFormattingStyles!=="boolean"){throw new TypeError(b.ErrorText.ParamNotBoolean);
}b.sendCommand(b.Command.SetDocumentPermissions,b.DocumentPermissionsProperty.AllowFormattingStyles,allowFormattingStyles?1:0);
},enumerable:true});
Object.defineProperty(c,"allowPrinting",{get:function(){return b.documentPermissions.allowPrinting;
},set:function(allowPrinting){if(typeof allowPrinting!=="boolean"){throw new TypeError(b.ErrorText.ParamNotBoolean);
}b.sendCommand(b.Command.SetDocumentPermissions,b.DocumentPermissionsProperty.AllowPrinting,allowPrinting?1:0);
},enumerable:true});
b.setDocumentPermission=function(e){switch(e.property){case b.DocumentPermissionsProperty.ReadOnly:b.documentPermissions.readOnly=e.value;
break;
case b.DocumentPermissionsProperty.AllowCopy:b.documentPermissions.allowCopy=e.value;
break;
case b.DocumentPermissionsProperty.AllowFormatting:b.documentPermissions.allowFormatting=e.value;
break;
case b.DocumentPermissionsProperty.AllowFormattingStyles:b.documentPermissions.allowFormattingStyles=e.value;
break;
case b.DocumentPermissionsProperty.AllowPrinting:b.documentPermissions.allowPrinting=e.value;
break;
}};
return d;
}(TXTextControl||{},j$1_10_2));
var TXTextControl=(function(c,a){var b=c._private=c._private||{};
b.Ribbon=(function(){function d(){Object.defineProperties(this,{selectedTab:{get:function(){var e=document.querySelector("#ribbonbar ul.tabs a[rel].selected");
if(e){return e.getAttribute("id");
}else{return"";
}},set:function(tabName){if(typeof tabName!=="string"){throw new TypeError(b.ErrorText.ParamNotAString);
}var h=document.querySelectorAll("#ribbonbar ul.tabs a[rel]");
var g=false;
for(var e=0;
e<h.length;
++e){var f=h[e];
if((f.id===tabName)&&(f.style.display!=="none")){g=true;
break;
}}if(!g){throw new Error(b.ErrorText.RibbonTabDoesNotExist);
}b.switchTabs(a("#"+tabName));
},enumerable:true}});
}d.prototype.minimize=function(){b.showRibbonBar(false);
};
d.prototype.expand=function(){b.showRibbonBar(true);
};
return d;
})();
return c;
}(TXTextControl||{},j$1_10_2));
var TXTextControl=(function(f,a){var c=f._private=f._private||{};
c.secretAPIEnabled=false;
c.documentTaskCallbacks={save:[],getTextParts:[],getTextFields:[],getSubTextParts:[]};
c.selectionTaskCallbacks={save:[],getBounds:[],getCulture:[]};
c.controlTaskCallbacks={getFileDir:{document:[],db:[],image:[]},getBackColor:[],getStatusBarColor:[],getFormattingPrinter:[],getInstalledPrinters:[]};
c.ErrorText=Object.freeze({NoStreamType:"No TXTextControl stream type given.",NoDocumentData:"No document data given.",TooFewParameters:"Wrong number of parameters.",CallBackIsNoFunction:'Parameter "callback" must be of type "function".',ParamNotANumber:"Parameter is not a number.",ParamNotAString:"Parameter is not a string.",ParamNotBoolean:"Parameter is not of type boolean.",FileTypeIsNotNumeric:'Parameter "fileType" must be a numeric value.',InvalidHexColorString:" is not a valid hex color string.",RibbonTabDoesNotExist:"The requested ribbon tab does not exist or is not selectable at the moment.",TextFieldParamTypeError:'Parameter "textField" cannot be omitted and must be of type TXTextControl.ApplicationField or TXTextControl.TextField.'});
var b=true;
f.StreamType=f.streamType=c.TXStreamType;
f.EditMode=c.EditMode;
f.FileType=c.FileType;
f.ClipboardMode=c.ClipboardMode;
f.HighlightMode=c.HighlightMode;
f.Color=c.Color;
f.ApplicationField=c.ApplicationField;
f.TextField=c.TextField;
f.FieldType=c.FieldType;
f.MergeFieldTextFormat=c.MergeFieldTextFormat;
f.IncludeTextField=c.IncludeTextField;
f.DateField=c.DateField;
f.MergeField=c.MergeField;
f.IfField=c.IfField;
f.NextIfField=c.NextIfField;
f.NextField=c.NextField;
f.RelationalOperator=c.RelationalOperator;
f.SpecialZoomFactor=c.SpecialZoomFactor;
f.ImageInsertionMode=c.ImageInsertionMode;
f.HorizontalAlignment=c.HorizontalAlignment;
f.TextFrameInsertionMode=c.TextFrameInsertionMode;
f.loadDocument=function(streamType,base64Data){if(!streamType){throw new Error(c.ErrorText.NoStreamType);
}if(!base64Data){throw new Error(c.ErrorText.NoDocumentData);
}c.sendCommand(c.Command.OpenFile,c.FileType.Document,streamType,1,base64Data);
};
f.appendDocument=function(streamType,base64Data){if(!streamType){throw new Error(c.ErrorText.NoStreamType);
}if(!base64Data){throw new Error(c.ErrorText.NoDocumentData);
}c.sendCommand(c.Command.AppendDocumentFile,0,streamType,1,base64Data);
};
f.saveDocument=function(streamType,callback){if(!streamType){throw new Error(c.ErrorText.NoStreamType);
}if(!callback){throw new Error(c.ErrorText.TooFewParameters);
}if(typeof callback!=="function"){throw new TypeError(c.ErrorText.CallBackIsNoFunction);
}c.documentTaskCallbacks.save.push(callback);
c.sendCommand(c.Command.SaveDocumentFile,streamType,-1);
};
f.loadSelection=function(streamType,base64Data){var g=new c.Selection();
g.load(streamType,base64Data);
};
f.saveSelection=function(streamType,callback){var g=new c.Selection();
g.save(streamType,callback);
};
f.getTextParts=function(callback,atInputPosition){atInputPosition=atInputPosition||false;
if(!callback){throw new Error(c.ErrorText.TooFewParameters);
}if(typeof callback!=="function"){throw new TypeError(c.ErrorText.CallBackIsNoFunction);
}c.documentTaskCallbacks.getTextParts.push(callback);
var g=atInputPosition?c.TextPartCommand.GetItem:c.TextPartCommand.GetAll;
c.sendCommand(c.Command.ClientTextPart,g);
};
f.getTextFields=function(callback,atInputPosition){if(!callback){throw new Error(c.ErrorText.TooFewParameters);
}if(typeof callback!=="function"){throw new TypeError(c.ErrorText.CallBackIsNoFunction);
}c.documentTaskCallbacks.getTextFields.push(callback);
var g=atInputPosition?c.TextFieldCommand.GetItem:c.TextFieldCommand.GetAll;
c.sendCommand(c.Command.ClientTextField,g);
};
f.addTextField=function(textField){if(!textField||((textField.constructor!==c.ApplicationField)&&(textField.constructor!==c.TextField))){throw new TypeError(c.ErrorText.TextFieldParamTypeError);
}c.sendCommand(c.Command.ClientTextField,c.TextFieldCommand.Add,0,0,{textField:textField._field});
};
f.addMergeField=function(mergeField){var h=null,g=-1;
if((mergeField===null)||(typeof mergeField==="undefined")){throw new TypeError('Please provide "mergeField" parameter.');
}if(mergeField.constructor===f.MergeField){g=f.FieldType.MergeField;
}else{if(mergeField.constructor===f.IfField){g=f.FieldType.IfField;
}else{if(mergeField.constructor===f.IncludeTextField){g=f.FieldType.IncludeTextField;
}else{if(mergeField.constructor===f.DateField){g=f.FieldType.DateField;
}else{if(mergeField.constructor===f.NextField){g=f.FieldType.NextField;
}else{if(mergeField.constructor===f.NextIfField){g=f.FieldType.NextIfField;
}else{throw new TypeError('Parameter "mergeField" must be one of the known merge field types (e. g. TXTextControl.MergeField or TXTextControl.DateField).');
}}}}}}if(g!==-1){h=mergeField.toUpperCamelCase();
}if(h){c.sendCommand(c.Command.InsertItem,c.ItemType.FieldAdapter,g,0,h);
}};
f.showMergeFieldDialog=function(fieldType){var g;
if(typeof fieldType==="undefined"){if(c.currentFieldData){c.showFieldDialog(c.currentFieldData.fieldAdapter,c.currentFieldData.mergeFieldType);
}return;
}if(!isInteger(fieldType)){throw new TypeError('Parameter "fieldType" must be one of the values defined in TXTextControl.FieldType.');
}switch(fieldType){case f.FieldType.MergeField:var h=new c.MergeField();
g=new c.MergeFieldDialog(h.toUpperCamelCase());
break;
case f.FieldType.IfField:g=new c.IfFieldDialog();
break;
case f.FieldType.IncludeTextField:g=new c.IncludeTextFieldDialog();
break;
case f.FieldType.DateField:g=new c.DateFieldDialog();
break;
case f.FieldType.NextField:c.sendCommand(c.Command.InsertItem,c.ItemType.FieldAdapter,c.FieldType.NextField);
break;
case f.FieldType.NextIfField:g=new c.NextIfFieldDialog();
break;
default:console.error("Unknown merge field type.");
break;
}if(g){g.showModal();
}};
f.removeTextField=function(textField,keepText){keepText=!!keepText;
if(!textField||((textField.constructor!==c.ApplicationField)&&(textField.constructor!==c.TextField))){throw new TypeError(c.ErrorText.TextFieldParamTypeError);
}c.sendCommand(c.Command.ClientTextField,c.TextFieldCommand.Remove,0,0,{textField:textField._field,keepText:keepText});
};
f.getSubTextParts=function(callback,atInputPosition){if(!callback){throw new Error(c.ErrorText.TooFewParameters);
}if(typeof callback!=="function"){throw new TypeError(c.ErrorText.CallBackIsNoFunction);
}c.documentTaskCallbacks.getSubTextParts.push(callback);
var g=atInputPosition?c.SubTextPartCommand.GetItem:c.SubTextPartCommand.GetAll;
c.sendCommand(c.Command.ClientSubTextPart,g);
};
f.focus=function(){if(c.textViewer){c.textViewer.focus();
}};
f.resetContents=function(){c.sendCommand(c.Command.ResetContents);
};
f.removeFromDom=function(){try{c.sendCommand(c.Command.Close);
c.webSocketDisconnect();
c.unsubscribeDocumentAndWindowEvents();
var h=document.getElementById("txTemplateDesignerContainer");
h.parentElement.removeChild(h);
TXTextControl=undefined;
}catch(g){}};
f.loadXMLDatabase=function(xmlData){if(!xmlData){throw new Error(c.ErrorText.TooFewParameters);
}if(typeof xmlData!=="string"){throw new TypeError(c.ErrorText.ParamNotAString);
}c.sendCommand(c.Command.OpenFile,c.FileType.DataBase,c.DataBaseType.XML,1,xmlData);
};
f.getFileDirectory=function(fileType,callback){if(!callback){throw new Error(c.ErrorText.TooFewParameters);
}if(typeof fileType!=="number"){throw new TypeError(c.ErrorText.FileTypeIsNotNumeric);
}if(typeof callback!=="function"){throw new TypeError(c.ErrorText.CallBackIsNoFunction);
}switch(fileType){case c.FileType.Document:c.controlTaskCallbacks.getFileDir.document.push(callback);
break;
case c.FileType.Image:c.controlTaskCallbacks.getFileDir.image.push(callback);
break;
case c.FileType.DataBase:c.controlTaskCallbacks.getFileDir.db.push(callback);
break;
}c.sendCommand(c.Command.GetFileDirectory,fileType);
};
f.setFileDirectory=function(fileType,directory){if(!directory){throw new Error(c.ErrorText.TooFewParameters);
}if(typeof fileType!=="number"){throw new TypeError(c.ErrorText.FileTypeIsNotNumeric);
}if(typeof directory!=="string"){throw new TypeError(c.ErrorText.ParamNotAString);
}c.sendCommand(c.Command.SetFileDirectory,fileType,0,0,directory);
};
f.getCultures=function(){return c.getCultures();
};
function d(g){return/^#[0-9a-f]{3}(?:[0-9a-f]{3})?$/i.test(g);
}function e(g){if(!d(g)){throw new Error('"'+g+'"'+c.ErrorText.InvalidHexColorString);
}var h={R:127,G:127,B:127};
if(g.length==4){h.R=parseInt(g.charAt(1),16)*17;
h.G=parseInt(g.charAt(2),16)*17;
h.B=parseInt(g.charAt(3),16)*17;
}else{if(g.length==7){h.R=parseInt(g.substr(1,2),16);
h.G=parseInt(g.substr(3,2),16);
h.B=parseInt(g.substr(5,2),16);
}}return h;
}f.setBackColor=function(hexColor){if(typeof hexColor!=="string"){throw new TypeError(c.ErrorText.ParamNotAString);
}var g=e(hexColor);
c.sendCommand(c.Command.BackColor,0,0,0,g);
};
f.getBackColor=function(callback){if(typeof callback!=="function"){throw new TypeError(c.ErrorText.CallBackIsNoFunction);
}c.controlTaskCallbacks.getBackColor.push(callback);
c.sendCommand(c.Command.BackColor);
};
f.setStatusBarColor=function(hexColor){if(typeof hexColor!=="string"){throw new TypeError(c.ErrorText.ParamNotAString);
}var g=e(hexColor);
c.sendCommand(c.Command.StatusBarColor,0,0,0,g);
};
f.getStatusBarColor=function(callback){if(typeof callback!=="function"){throw new TypeError(c.ErrorText.CallBackIsNoFunction);
}c.controlTaskCallbacks.getStatusBarColor.push(callback);
c.sendCommand(c.Command.StatusBarColor);
};
f.setFormattingPrinter=function(printerName){if(typeof printerName!=="string"){throw new TypeError(c.ErrorText.ParamNotAString);
}c.sendCommand(c.Command.ClientSetFormattingPrinter,0,0,0,printerName);
};
f.getFormattingPrinter=function(callback){if(typeof callback!=="function"){throw new TypeError(c.ErrorText.CallBackIsNoFunction);
}c.controlTaskCallbacks.getFormattingPrinter.push(callback);
c.sendCommand(c.Command.ClientGetFormattingPrinter);
};
f.getInstalledPrinters=function(callback){if(typeof callback!=="function"){throw new TypeError(c.ErrorText.CallBackIsNoFunction);
}c.controlTaskCallbacks.getInstalledPrinters.push(callback);
c.sendCommand(c.Command.ClientGetInstalledPrinters);
};
f.showVerticalRuler=c.showVerticalRuler;
f.showHorizontalRuler=c.showHorizontalRuler;
f.showStatusBar=c.showStatusBar;
f.showRibbonBar=c.showRibbonBar;
f.printDocument=c.print;
Object.defineProperty(f,"selection",{get:function(){return new c.Selection();
},set:function(bounds){var g=new c.Selection();
g.setBounds(bounds);
},enumerable:true});
Object.defineProperty(f,"isLoadingDialogEnabled",{get:function(){return b;
},set:function(enabled){if(typeof enabled!=="boolean"){return;
}b=enabled;
c.sendCommand(c.Command.EnableLoadWaitDialog,enabled?1:0);
},enumerable:true});
Object.defineProperty(f,"editMode",{get:function(){return c.editModeCur;
},set:function(editMode){if(typeof editMode!=="number"){return;
}c.sendCommand(c.Command.EditMode,editMode);
},enumerable:true});
Object.defineProperty(f,"controlChars",{get:function(){return c.controlChars;
},set:function(controlChars){if(typeof controlChars!=="boolean"){throw new TypeError(c.ErrorText.ParamNotBoolean);
}c.sendCommand(c.Command.DisplayVisualElement,c.VisualElement.ControlChars,controlChars?1:0);
},enumerable:true});
Object.defineProperty(f,"tableGridLines",{get:function(){return c.tableGridLines;
},set:function(tableGridLines){if(typeof tableGridLines!=="boolean"){throw new TypeError(c.ErrorText.ParamNotBoolean);
}c.sendCommand(c.Command.DisplayVisualElement,c.VisualElement.TableGridLines,tableGridLines?1:0);
},enumerable:true});
Object.defineProperty(f,"documentTargetMarkers",{get:function(){return c.documentTargetMarkers;
},set:function(documentTargetMarkers){if(typeof documentTargetMarkers!=="boolean"){throw new TypeError(c.ErrorText.ParamNotBoolean);
}c.sendCommand(c.Command.DisplayVisualElement,c.VisualElement.BookmarkMarkers,documentTargetMarkers?1:0);
},enumerable:true});
Object.defineProperty(f,"textFrameMarkerLines",{get:function(){return c.textFrameMarkerLines;
},set:function(textFrameMarkerLines){if(typeof textFrameMarkerLines!=="boolean"){throw new TypeError(c.ErrorText.ParamNotBoolean);
}c.sendCommand(c.Command.DisplayVisualElement,c.VisualElement.TextFrameMarkerLines,textFrameMarkerLines?1:0);
},enumerable:true});
Object.defineProperty(f,"contextMenusEnabled",{get:function(){return c.contextMenusEnabled;
},set:function(contextMenusEnabled){if(typeof contextMenusEnabled!=="boolean"){throw new TypeError(c.ErrorText.ParamNotBoolean);
}c.sendCommand(c.Command.ContextMenusEnabled,contextMenusEnabled?1:0);
},enumerable:true});
Object.defineProperty(f,"saveDocumentQuestionDialogEnabled",{get:function(){return c.saveDocumentQuestionEnabled;
},set:function(isEnabled){if(typeof isEnabled!=="boolean"){throw new TypeError(c.ErrorText.ParamNotBoolean);
}c.saveDocumentQuestionEnabled=isEnabled;
},enumerable:true});
Object.defineProperty(f,"textFieldsEditable",{get:function(){return c.textFieldsEditable;
},set:function(textFieldsEditable){if(typeof textFieldsEditable!=="boolean"){throw new TypeError(c.ErrorText.ParamNotBoolean);
}c.sendCommand(c.Command.SetTextFieldsEditable,textFieldsEditable?1:0);
},enumerable:true});
Object.defineProperty(f,"ribbon",{get:function(){return new c.Ribbon();
},enumerable:true});
Object.defineProperty(f,"isSpellCheckingEnabled",{get:function(){return c.proofingSettings?c.proofingSettings.isSpellCheckingEnabled:false;
},set:function(enabled){c.sendCommand(c.Command.EnableSpellChecking,enabled?1:0);
},enumerable:true});
Object.defineProperty(f,"isHyphenationEnabled",{get:function(){return c.proofingSettings?c.proofingSettings.isHyphenationEnabled:false;
},set:function(enabled){c.sendCommand(c.Command.EnableHyphenation,enabled?1:0);
},enumerable:true});
Object.defineProperty(f,"isLanguageDetectionEnabled",{get:function(){return c.proofingSettings?c.proofingSettings.isLangDetectEnabled:false;
},set:function(enabled){c.sendCommand(c.Command.EnableLangDetect,enabled?1:0);
},enumerable:true});
Object.defineProperty(f,"clipboardMode",{get:function(){return c.clipboardMode;
},set:function(clipboardMode){c.sendCommand(c.Command.ClipboardMode,clipboardMode);
},enumerable:true});
Object.defineProperty(f,"zoomFactor",{get:function(){return c.zoom;
},set:function(zoomFactor){if(zoomFactor===undefined){throw new Error('Parameter "zoomFactor" is undefined.');
}if((typeof zoomFactor!=="number")||((zoomFactor<10)&&(zoomFactor>-1))||(zoomFactor<-3)){throw new TypeError("Zoom factor must be a positive number >= 10 or one of the special zoom factor values defined in TXTextControl.SpecialZoomFactor.");
}zoomFactor=Math.round(zoomFactor);
c.sendCommand(c.Command.Zoom,zoomFactor);
},enumerable:true});
c.Point=(function(){function g(x,y){if((typeof x!=="number")||(typeof y!=="number")){throw new TypeError("Parameters have to be numerical values.");
}this.x=x;
this.y=y;
}return g;
})();
f.enableCommands=function(silent){if(c.secretAPIEnabled){return;
}f.sendCommand=c.sendCommand;
f.Command=c.Command;
f.VisualElement=c.VisualElement;
f.ItemType=c.ItemType;
f.DialogCategory=c.DialogCategory;
f.HTMLDialogType=c.HTMLDialogType;
f.TXDialogType=c.TXDialogType;
f.InputFormatProperty=c.InputFormatProperty;
f.BreakType=c.BreakType;
f.BarcodeType=c.BarcodeType;
f.insertMergeField=c.insertMergeField;
f.insertMergeBlock=c.insertMergeBlock;
f.FrameInsertionMode=c.FrameInsertionMode;
f.FrameProperty=c.FrameProperty;
f.ZOrder=c.ZOrder;
f.VerticalAlignment=c.VerticalAlignment;
f.SectionFormatDialogTab=c.SectionFormatDialogTab;
f.TableCommand=c.TableCommand;
f.TableElement=c.TableElement;
f.MailMergeNavButton=c.MailMergeNavButton;
f.ComponentType=c.ComponentType;
f.ActivationState=c.ActivationState;
f.FieldDisplayMode=c.FieldDisplayMode;
f.SpellCheckDialogCommand=c.SpellCheckDialogCommand;
f.SelectionCommand=c.SelectionCommand;
f.SectionFormatProperty=c.SectionFormatProperty;
f.TextPartCommand=c.TextPartCommand;
f.DrawingControlProperty=c.DrawingControlProperty;
f.BarcodeControlProperty=c.BarcodeControlProperty;
f.TextFrameProperty=c.TextFrameProperty;
f.showCenteredMessage=c.showMsgDiv;
f.ChartTemplateType=c.ChartTemplateType;
if(!silent){console.warn('Undocumented and unsupported TextControl API activated. Use at your own risk. Call this function with the parameter "true" if you don\'t want to see this message.');
}c.secretAPIEnabled=true;
};
return f;
}(TXTextControl||{},j$1_10_2));
